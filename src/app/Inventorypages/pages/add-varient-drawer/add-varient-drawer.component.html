<div>
  <form nz-form #websitebannerPage="ngForm">
    <nz-tabset [(nzSelectedIndex)]="activeTabIndex">
      <nz-tab *ngFor="let tab of tabs; let i = index" [nzTitle]="application" [nzDisabled]="tab.disabled">
        <ng-template #application>
          {{ tab.name }}
        </ng-template>
        <div *ngIf="tab.name == 'Add Variant'">
          <form nz-form #websitebannerPage1="ngForm" *ngIf="decreptedroleId != 23">
            <nz-spin [nzSpinning]="isSpinning">
              <div nz-row>
                <div nz-col nzSpan="19" class="my-box">
                  <div nz-row>
                    <div nz-col nzSpan="11">
                      <nz-form-item>
                        <nz-form-label nzRequired nzNoColon>Variant Name</nz-form-label>
                        <nz-form-control nzErrorTip="Please Enter Variant Name">
                          <input nz-input placeholder="Enter Variant Name" name="name" required [(ngModel)]="data.NAME"
                            (keypress)="validateInput($event)" #name="ngModel" maxlength="64" autocomplete="off"
                            (focus)="isFocused = 'NAME'" (blur)="isFocused = ''" />
                          <h6 class="character-counter" *ngIf="
                              isFocused === 'NAME' ||
                              (data.NAME && isFocused === 'NAME')
                            ">
                            {{ data?.NAME?.length }}/64
                          </h6>
                        </nz-form-control>
                      </nz-form-item>
                    </div>
                    <div nz-col nzSpan="11">
                      <nz-form-item>
                        <nz-form-label nzRequired nzNoColon>Values</nz-form-label>
                        <nz-form-control nzErrorTip="Please Enter Values">
                          <nz-select nzMode="tags" nzPlaceHolder="Enter Values" name="tag1"
                            [(ngModel)]="data.VARIENT_VALUES" (keypress)="validateVariantValues($event)"
                            (ngModelChange)="handleVariantChange()" required [nzMaxTagCount]="4">
                            <nz-option *ngFor="let option of inputValuess1" [nzLabel]="option"
                              [nzValue]="option"></nz-option>
                          </nz-select>
                        </nz-form-control>
                      </nz-form-item>
                    </div>
                    <div nz-col nzSpan="2" class="button-col">
                      <button type="button" class="ant-btn ant-btn-primary" *ngIf="!data.ID && !isnext" nz-button
                        [nzLoading]="isSpinning" (click)="addvarient(false, websitebannerPage1)">
                        <span>Add</span>
                      </button>
                      <button type="button" class="ant-btn ant-btn-primary" *ngIf="!data.ID && isnext" nz-button
                        [nzLoading]="isSpinning" nz-popconfirm [nzPopconfirmTitle]="popConfirmTemplate"
                        nzPopconfirmPlacement="top" (nzOnConfirm)="addvarient(false, websitebannerPage1)"
                        (nzOnCancel)="cancel()">
                        <span>Add</span>
                      </button>
                      <ng-template #popConfirmTemplate>
                        Are you sure you want to add a new variant?
                        <br />
                        New variant combinations may be created <br />
                        for the newly added variant.
                      </ng-template>
                      <button type="button" class="ant-btn ant-btn-primary" nz-button [nzLoading]="isSpinning"
                        *ngIf="data.ID" (click)="addvarient(false, websitebannerPage1)">
                        <span>Update</span>
                      </button>
                      <nz-popconfirm *ngIf="isnext" nzTitle="Are you sure you want to proceed with the action?"
                        (nzOnConfirm)="addvarient(false, websitebannerPage1)">
                        <ng-template #confirmTemplate>
                          <span>Are you sure you want to add or update this
                            variant?
                          </span>
                        </ng-template>
                      </nz-popconfirm>
                    </div>
                  </div>
                </div>
                <div nz-col nzSpan="5" class="search-col">
                  <form nz-form [nzLayout]="'inline'">
                    <nz-form-item>
                      <nz-input-group nzSearch [nzAddOnAfter]="suffixIconButton">
                        <input class="search-input" type="text" name="search" autocomplete="off" (keyup)="keyup($event)"
                          (keydown.enter)="onEnterKey($event)" [(ngModel)]="searchText" nz-input
                          placeholder="Min 3 chars required." />
                      </nz-input-group>
                      <ng-template #suffixIconButton>
                        <button nz-button nzType="primary" (click)="search(true)" nzSearch
                          class="search-button">
                          <i nz-icon nzType="search"></i>
                        </button>
                      </ng-template>
                    </nz-form-item>
                  </form>
                </div>
              </div>
            </nz-spin>
          </form>
          <div nz-row class="table-row">
            <div nz-col nzSpan="24">
              <nz-table class="my-scroll no-wrap1 variant-table" [nzData]="AddVarientData" #table nzBordered nzShowSizeChanger
                ngSkipHydration [nzPageSize]="10" [nzShowPagination]="true" [nzFrontPagination]="false"
                [nzLoading]="loadingRecordss" [nzTotal]="totalRecords" [(nzPageIndex)]="pageIndex"
                [(nzPageSize)]="pageSize" (nzQueryParams)="sort($event)" [nzSize]="'small'" nzShowSizeChanger
                [nzScroll]="{ y: '50vh' }">
                <thead nzSingleSort>
                  <tr>
                    <th nzWidth="40px" class="action-header" *ngIf="decreptedroleId != 23">
                      Action
                    </th>
                    <th nzShowSort nzColumnKey="{{ 'NAME' }}" nzWidth="150px" class="variant-header"
                      [nzSortFn]="true">
                      Variant Name
                    </th>
                    <th nzShowSort nzColumnKey="{{ 'VARIENT_VALUES' }}" nzWidth="300px" class="values-header"
                      [nzSortFn]="true">
                      Values
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let data of table.data">
                    <td align="center" nzLeft *ngIf="decreptedroleId != 23" class="action-cell">
                      <nz-tag nzColor="#2db7f5" (click)="edit(data)" class="edit-tag">
                        <span nz-icon nzType="edit" nzTheme="outline" class="edit-icon">
                        </span>&nbsp;&nbsp;Edit</nz-tag>
                    </td>
                    <td align="left" class="variant-name-cell">
                      <span *ngIf="data['NAME'] != null">
                        <span *ngIf="data['NAME'].length >= 50" nz-popover [nzPopoverContent]="data['NAME']"
                          nzPopoverPlacement="topLeft">
                          {{
                          data["NAME"] == null
                          ? "-"
                          : (data["NAME"] | slice : 0 : 50)
                          }}{{ data["NAME"].length > 50 ? "..." : "" }}
                        </span>
                        <span *ngIf="data['NAME'].length < 50">
                          {{
                          data["NAME"] == null
                          ? "-"
                          : (data["NAME"] | slice : 0 : 50)
                          }}
                          {{ data["NAME"].length > 50 ? "..." : "" }}
                        </span>
                      </span>
                      <span *ngIf="data['NAME'] == null">-</span>
                    </td>
                    <td align="left" class="variant-values-cell">
                      <span *ngIf="data['VARIENT_VALUES'] != null">
                        <span *ngIf="data['VARIENT_VALUES'].length >= 120" nz-popover
                          [nzPopoverContent]="data['VARIENT_VALUES']" nzPopoverPlacement="topLeft">
                          {{
                          data["VARIENT_VALUES"] == null
                          ? "-"
                          : (data["VARIENT_VALUES"] | slice : 0 : 120)
                          }}{{
                          data["VARIENT_VALUES"].length > 120 ? "..." : ""
                          }}
                        </span>
                        <span *ngIf="data['VARIENT_VALUES'].length < 120">
                          {{
                          data["VARIENT_VALUES"] == null
                          ? "-"
                          : (data["VARIENT_VALUES"] | slice : 0 : 120)
                          }}
                          {{ data["VARIENT_VALUES"].length > 120 ? "..." : "" }}
                        </span>
                      </span>
                      <span *ngIf="data['VARIENT_VALUES'] == null">-</span>
                    </td>
                  </tr>
                </tbody>
              </nz-table>
            </div>
          </div>
          <div class="footer">
            <button type="button" nz-button (click)="close()" class="ant-btn cancel-button">
              <span>Cancel</span>
            </button>
            <button type="button" class="ant-btn ant-btn-primary next-button" nz-button [nzLoading]="isSpinning" (click)="next()"
              nz-popconfirm [nzOkText]="'Yes'"
              nzPopconfirmTitle="Are you sure save or update variant combinations details"
              [nzCondition]="decreptedroleId != 23 ? switchValue : true" (nzOnConfirm)="saveNextFinal()"
              (nzOnCancel)="cancelNextFinal()">
              <span>Next &nbsp;
                <span nz-icon nzType="arrow-right" nzTheme="outline"></span>
              </span>
            </button>
          </div>
        </div>
        <div *ngIf="tab.name == 'Add Variant Details'">
          <form nz-form #websitebannerPage1="ngForm">
            <nz-spin [nzSpinning]="isSpinning">
              <div nz-row>
                <div nz-col nzSpan="24">
                  <nz-table #tableeeeeeee [nzFrontPagination]="false" [nzData]="dataList" [nzLoading]="loadingRecords11"
                    [nzSize]="'small'" [nzScroll]="{ y: '60vh' }" nzShowSizeChanger="false" class="my-scroll no-wrap1 variant-details-table"
                    nzBordered>
                    <thead>
                      <tr>
                        <th *ngIf="decreptedroleId != 23" nzWidth="100px" nzLeft
                          class="map-units-header">
                          Map Units
                        </th>
                        <th nzLeft nzWidth="150px" class="add-images-header">
                          Add Image(s)
                        </th>
                        <th nzLeft nzWidth="200px" class="name-header" nzColumnKey="ITEM_NAME"
                          nzCustomFilter>
                          Name
                        </th>
                        <th nzWidth="200px" class="base-unit-header" nzColumnKey="CATEGORY_NAME"
                          nzCustomFilter>
                          Base Unit
                          <nz-select nzShowSearch nzSize="small" class="base-unit-select" nzAllowClear
                            (ngModelChange)="onGlobalUnitChange($event)" nzPlaceHolder="Select Base Unit "
                            name="UnitNames" [(ngModel)]="BASE_UNIT_ID" required>
                            <nz-option *ngFor="let data of UnitList" [nzValue]="data.ID" [nzLabel]="data.NAME">
                            </nz-option>
                          </nz-select>
                        </th>
                        <th nzWidth="150px" class="quantity-header" nzColumnKey="BASE_QUANTITY"
                          nzCustomFilter [class.disabled-row]="data.ID">
                          Quantity Per Unit
                          <input class="quantity-input" nz-input name="BASE_QUANTITYs" (ngModelChange)="
                              onGlobalBASE_QUANTITYChange($event)
                            " maxlength="8" nzSize="small" (keypress)="commonFunction.onlynum($event)"
                            [(ngModel)]="BASE_QUANTITY" placeholder="Enter Quantity Per Unit" autocomplete="off"
                            type="text" required (blur)="setDefaultBaseQuantity(i)" />
                        </th>
                        <th nzWidth="150px" class="base-price-header" nzColumnKey="BASE_PRICE"
                          nzCustomFilter>
                          Base Price(₹)
                          <input class="base-price-input" nz-input name="BASE_PRICE"
                            (keypress)="commonFunction.forCostFunction($event)"
                            (paste)="commonFunction.handlePaste($event)"
                            (ngModelChange)="onGlobalBASE_PRICEChange($event)" maxlength="32" nzSize="small"
                            [(ngModel)]="BASE_PRICE" placeholder="Enter Base Price" autocomplete="off" type="text"
                            required />
                        </th>
                        <th nzWidth="180px" class="tax-preference-header" nzColumnKey="TAX_PREFERENCE"
                          nzCustomFilter>
                          Tax Preference
                          <nz-select nzShowSearch class="tax-preference-select" nzAllowClear
                            nzPlaceHolder="Select Tax Preference" name="TaxPreferences"
                            (ngModelChange)="onGlobalTaxableChange($event)" nzSize="small" [(ngModel)]="TAX_PREFERENCE"
                            required>
                            <nz-option [nzValue]="'T'" [nzLabel]="'Taxable'"></nz-option>
                            <nz-option [nzValue]="'NT'" [nzLabel]="'Non Taxable'"></nz-option>
                          </nz-select>
                        </th>
                        <th nzWidth="180px" class="tax-slab-header" nzColumnKey="TAX_ID"
                          nzCustomFilter>
                          Tax Slab
                          <nz-select class="tax-slab-select" nzShowSearch [disabled]="TAX_PREFERENCE != 'T'" nzAllowClear
                            nzPlaceHolder="Select Tax Slab" name="TAX_IDs" nzSize="small" [(ngModel)]="TAX_ID" required
                            (ngModelChange)="onGlobalTaxChange($event)">
                            <nz-option *ngFor="let data of taxData" [nzValue]="data.ID" [nzLabel]="data.NAME">
                            </nz-option>
                          </nz-select>
                        </th>
                        <th nzWidth="150px" class="selling-price-header" nzColumnKey="PURCHASE_PRICE"
                          nzCustomFilter>
                          Selling Price(₹)
                          <input class="selling-price-input" nz-input name="PURCHASE_PRICEs"
                            (keypress)="commonFunction.forCostFunction($event)"
                            (paste)="commonFunction.handlePaste($event)" (ngModelChange)="
                              onGlobalPURCHASE_PRICEChange($event)
                            " maxlength="32" nzSize="small" [(ngModel)]="PURCHASE_PRICE"
                            placeholder="Enter Selling Price" autocomplete="off" type="text" required />
                        </th>
                        <th nzWidth="150px" class="discount-allowed-header" nzColumnKey="DISCOUNT_ALLOWED"
                          nzCustomFilter>
                          Discount Allowed ?
                          <br />
                          <nz-switch nzSize="small" name="IS_DISCOUNT_ALLOWED_ALL" nzCheckedChildren="Yes"
                            nzUnCheckedChildren="No" [(ngModel)]="IS_DISCOUNT_ALLOWED_ALL" (ngModelChange)="
                              onGlobaldiscountAllowdedChange($event)
                            ">
                          </nz-switch>
                        </th>
                        <th nzWidth="150px" class="discounted-price-header" nzColumnKey="DISCOUNTED_PRICE"
                          nzCustomFilter>
                          Discounted Price(₹)
                          <input class="discounted-price-input" nz-input name="DISCOUNT_PRICE_ALL" nzAllowClear="false"
                            maxlength="8" (keypress)="commonFunction.forCostFunction($event)"
                            (paste)="commonFunction.handlePaste($event)" [(ngModel)]="DISCOUNT_PRICE_ALL"
                            (ngModelChange)="
                              onGlobalDiscountPriceChange($event)
                            " placeholder="Discounted Price" autocomplete="off" type="text" nzSize="small" [disabled]="
                              IS_DISCOUNT_ALLOWED_ALL ? 'false' : 'true'
                            " />
                        </th>
                        <th nzWidth="150px" class="average-level-header" nzColumnKey="NAME"
                          nzCustomFilter>
                          Average Level
                          <input class="average-level-input" nz-input name="AVG_LEVELs"
                            (ngModelChange)="onGlobalAVG_LEVELChange($event)" maxlength="8"
                            (keypress)="commonFunction.onlynumdot($event)" nzSize="small" [(ngModel)]="AVG_LEVEL"
                            placeholder="Enter Average Level" autocomplete="off" type="text" required />
                        </th>
                        <th nzWidth="170px" class="reorder-level-header" nzColumnKey="DATE_OF_ENTRY"
                          nzCustomFilter>
                          Re-Order Level
                          <input class="reorder-level-input" nz-input name="REORDER_STOCK_LEVELs" (ngModelChange)="
                              onGlobalREORDER_STOCK_LEVELChange($event)
                            " maxlength="8" (keypress)="commonFunction.onlynumdot($event)" nzSize="small"
                            [(ngModel)]="REORDER_STOCK_LEVEL" placeholder="Enter Re-Order Level" autocomplete="off"
                            type="text" required />
                        </th>
                        <th nzWidth="150px" class="alert-level-header" nzColumnKey="REMARKS"
                          nzCustomFilter>
                          Alert Level
                          <input class="alert-level-input" nz-input name="ALERT_STOCK_LEVELs" (ngModelChange)="
                              onGlobalALERT_STOCK_LEVELChange($event)
                            " (keypress)="commonFunction.onlynumdot($event)" maxlength="8" nzSize="small"
                            [(ngModel)]="ALERT_STOCK_LEVEL" placeholder="Enter Alert Level" autocomplete="off"
                            type="text" required />
                        </th>
                        <th nzWidth="150px" class="sku-code-header" nzColumnKey="SKU_CODE"
                          nzCustomFilter>
                          SKU Code
                          <input class="sku-code-input" nz-input name="SKU_CODEs"
                            (ngModelChange)="onGlobalSKUChange($event)" maxlength="32" nzSize="small"
                            [(ngModel)]="SKU_CODE" placeholder="Enter SKU Code" autocomplete="off" type="text"
                            required />
                        </th>
                        <th nzWidth="270px" class="inventory-tracking-header"
                          nzColumnKey="INVENTORY_TRACKING_TYPE" nzCustomFilter>
                          Inventory Tracking Type
                          <nz-select nzShowSearch class="inventory-tracking-select" nzAllowClear
                            nzPlaceHolder="Select Inventory Tracking Type" name="INVENTORY_TRACKING_TYPEs"
                            (ngModelChange)="onGlobaltrackingtypeChange($event)" nzSize="small"
                            [(ngModel)]="INVENTORY_TRACKING_TYPE" required>
                            <nz-option nzValue="N" nzLabel="None"></nz-option>
                            <nz-option [nzValue]="'S'" [nzLabel]="'Serial No. Wise'"></nz-option>
                            <nz-option [nzValue]="'B'" [nzLabel]="'Batch Wise'"></nz-option>
                          </nz-select>
                        </th>
                        <th nzWidth="150px" class="warranty-allowed-header" nzColumnKey="WARRANTY_ALLOWED"
                          nzCustomFilter>
                          Warranty Allowed ? <br />
                          <nz-switch [disabled]="
                              INVENTORY_TRACKING_TYPE != 'B' &&
                              INVENTORY_TRACKING_TYPE != 'S'
                            " nzSize="small" name="WARRANTY_ALLOWED_ALL" nzCheckedChildren="Yes"
                            nzUnCheckedChildren="No" [(ngModel)]="WARRANTY_ALLOWED_ALL" (ngModelChange)="
                              onGlobalWarrantyAllowdedChange($event)
                            " [disabled]="INVENTORY_TRACKING_TYPE != 'S'">
                          </nz-switch>
                        </th>
                        <th nzWidth="150px" class="warranty-period-header" nzColumnKey="WARRANTY_PERIOD"
                          nzCustomFilter>
                          Warranty Period(days)
                          <input class="warranty-period-input" nz-input name="AllWarrantyPeriods" (ngModelChange)="
                              onGlobalWarrantyPeriodChange($event)
                            " maxlength="8" nzSize="small" [(ngModel)]="WARRANTY_PERIOD_ALL"
                            (keypress)="commonFunction.omit($event)" placeholder="Enter Warranty Period"
                            autocomplete="off" type="text" [disabled]="
                              INVENTORY_TRACKING_TYPE != 'S' ||
                              !WARRANTY_ALLOWED_ALL
                            " required />
                        </th>
                        <th nzWidth="150px" class="warranty-card-header">
                          Warranty Card&nbsp;<span nz-icon nzType="info-circle" nzTheme="twotone" nz-tooltip
                            nzTooltipTitle=" Please select an image or pdf file (PNG, JPG, JPEG, pdf) with 1mb file size"></span>
                        </th>
                        <th nzWidth="150px" class="guarantee-allowed-header"
                          nzColumnKey="GUARANTEE_ALLOWED" nzCustomFilter>
                          Guarantee Allowed ?
                          <br />
                          <nz-switch [disabled]="INVENTORY_TRACKING_TYPE != 'S'" nzSize="small"
                            name="GUARANTEE_ALLOWED_ALL" nzCheckedChildren="Yes" nzUnCheckedChildren="No"
                            [(ngModel)]="GUARANTEE_ALLOWED_ALL" (ngModelChange)="
                              onGlobalGuarnteeAllowdedChange($event)
                            ">
                          </nz-switch>
                        </th>
                        <th nzWidth="150px" class="guarantee-period-header" nzColumnKey="GUARANTEE_PERIOD"
                          nzCustomFilter>
                          Guarantee Period(days)
                          <input class="guarantee-period-input" nz-input name="GUARANTEE_PERIOD_ALL" nzAllowClear="false"
                            maxlength="8" (keypress)="commonFunction.omit($event)" [(ngModel)]="GUARANTEE_PERIOD_ALL"
                            (ngModelChange)="
                              globalguaranteePeriodChange($event)
                            " placeholder="Guarantee Period" autocomplete="off" type="text" nzSize="small" [disabled]="
                              INVENTORY_TRACKING_TYPE != 'S' ||
                              !GUARANTEE_ALLOWED_ALL
                            " />
                        </th>
                        <th nzWidth="150px" class="expiry-allowed-header"
                          nzColumnKey="EXPIRY_DATE_ALLOWED" nzCustomFilter>
                          Expiry Allowed ?
                          <br />
                          <nz-switch [disabled]="
                              INVENTORY_TRACKING_TYPE !== 'B' &&
                              INVENTORY_TRACKING_TYPE !== 'S'
                            " nzSize="small" name="EXPIRY_DATE_ALLOWED" nzCheckedChildren="Yes"
                            nzUnCheckedChildren="No" [(ngModel)]="EXPIRY_DATE_ALLOWED" (ngModelChange)="
                              onGlobalExpiryAllowdedChange($event)
                            ">
                          </nz-switch>
                        </th>
                        <th nzWidth="150px" class="expected-delivery-header"
                          nzColumnKey="EXPECTED_DELIVERY_IN_DAYS" nzCustomFilter>
                          Expected Delivery Day(s)
                          <input class="expected-delivery-input" nz-input name="IS_ALL_EXPECTED" nzAllowClear="false"
                            maxlength="8" (keypress)="commonFunction.omit($event)" [(ngModel)]="IS_ALL_EXPECTED"
                            (ngModelChange)="onGlobalExpectedChange($event)" placeholder="Expected Days"
                            autocomplete="off" type="text" nzSize="small" />
                        </th>
                        <th nzWidth="150px" class="expected-charges-header"
                          nzColumnKey="EXPECTED_DELIVERY_CHARGES" nzCustomFilter>
                          Expected Delivery Charges(₹)
                          <input class="expected-charges-input" nz-input name="EXPECTED_DELIVERY_CHARGES" nzAllowClear="false"
                            maxlength="8" (keypress)="commonFunction.omit($event)"
                            [(ngModel)]="EXPECTED_DELIVERY_CHARGES" (ngModelChange)="
                              onGlobalExpectedChargeChange($event)
                            " placeholder="Expected Charges" autocomplete="off" type="text" nzSize="small" />
                        </th>
                        <th nzWidth="250px" class="inventory-image-header">
                          Add Inventory Details Image
                        </th>
                        <th nzWidth="150px" class="short-code-header">
                          Short Code
                        </th>
                        <th nzRight nzWidth="120px" class="status-header" nzColumnKey="STATUS"
                          nzCustomFilter>
                          Status
                          <br />
                          <nz-switch nzSize="small" name="STATUS" nzCheckedChildren="Yes" nzUnCheckedChildren="No"
                            [(ngModel)]="STATUS" (ngModelChange)="
                              onGlobalstatusAllowdedChange($event)
                            ">
                          </nz-switch>
                        </th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let data of tableeeeeeee.data; let i = index" class="variant-details-row">
                        <td nzLeft class="map-units-cell" *ngIf="decreptedroleId != 23">
                          <nz-tag nzColor="#2db7f5" *ngIf="data['ID']; else MapUnitblock" (click)="ItemMapping(data, i)"
                            nz-tooltip nzTooltipTitle="Unit Mapping" class="map-unit-tag">
                            <span nz-icon nzType="link" nzTheme="outline" class="link-icon">
                            </span>&nbsp;&nbsp;Map
                          </nz-tag>
                          <ng-template #MapUnitblock>-</ng-template>
                        </td>
                        <td nzLeft class="add-images-cell">
                          <nz-tag nzColor="#2db7f5" (click)="openItemImagesDrawer(data)" nzTooltipTitle="Add Image(s)"
                            *ngIf="data['ID']; else MapUnitblock" nz-tooltip class="add-images-tag">
                            <span nz-icon nzType="plus" nzTheme="outline" class="plus-icon">
                            </span>&nbsp;&nbsp;Image(s)
                          </nz-tag>
                          <ng-template #MapUnitblock>-</ng-template>
                        </td>
                        <td nzLeft align="left" [class.disabled-row]="data.IS_DISABLED" class="variant-name-details">
                          <span *ngIf="data['VARIANT_COMBINATION']">
                            {{
                            data["VARIANT_COMBINATION"].length > 18
                            ? (data["VARIANT_COMBINATION"]
                            | slice : 0 : 18) + "..."
                            : data["VARIANT_COMBINATION"]
                            }}
                          </span>
                          <span *ngIf="!data['VARIANT_COMBINATION']">-</span>
                        </td>
                        <td align="center" [class.disabled-row]="data.ID" class="unit-select-cell">
                          <nz-select nzShowSearch nzSize="small" class="unit-select" nzAllowClear
                            nzPlaceHolder="Select Base Unit " name="Unit Name{{ i }}" [(ngModel)]="data.BASE_UNIT_ID"
                            required>
                            <nz-option *ngFor="let data of UnitList" [nzValue]="data.ID" [nzLabel]="data.NAME">
                            </nz-option>
                          </nz-select>
                        </td>
                        <td [class.disabled-row]="data.ID" class="quantity-input-cell">
                          <input class="quantity-input-field" nz-input name="BASE_QUANTITY{{ i }}"
                            maxlength="8" (keypress)="commonFunction.onlynum($event)" [(ngModel)]="data.BASE_QUANTITY"
                            placeholder="Quantity Per Unit" autocomplete="off" type="text" nzSize="small" required
                            (blur)="setDefaultBaseQuantity(i)" />
                        </td>
                        <td [class.disabled-row]="data.IS_DISABLED" class="base-price-cell">
                          <input class="base-price-input-field" nz-input name="BASE_PRICE{{ i }}" maxlength="8"
                            (keypress)="commonFunction.forCostFunction($event)"
                            (paste)="commonFunction.handlePaste($event)" [(ngModel)]="data.BASE_PRICE"
                            placeholder="Base Price" autocomplete="off" (ngModelChange)="onBasePriceChange($event, i)"
                            type="text" nzSize="small" required />
                        </td>
                        <td [class.disabled-row]="data.IS_DISABLED" class="tax-preference-cell">
                          <nz-select nzShowSearch class="tax-preference-select-field" nzAllowClear nzPlaceHolder="Select Tax Preference"
                            name="TaxPreference{{ i }}" (ngModelChange)="onTaxPreferenceChange($event, i)"
                            nzSize="small" [(ngModel)]="data.TAX_PREFERENCE" required>
                            <nz-option [nzValue]="'T'" [nzLabel]="'Taxable'"></nz-option>
                            <nz-option [nzValue]="'NT'" [nzLabel]="'Non Taxable'"></nz-option>
                          </nz-select>
                        </td>
                        <td [class.disabled-row]="data.IS_DISABLED" class="tax-slab-cell">
                          <nz-select class="tax-slab-select-field" nzShowSearch [disabled]="data.TAX_PREFERENCE != 'T'"
                            nzAllowClear nzPlaceHolder="Select Tax" name="TAX_ID{{ i }}" nzSize="small"
                            [(ngModel)]="data.TAX_ID" (ngModelChange)="onTaxChange($event, i)" required>
                            <nz-option *ngFor="let data of taxData" [nzValue]="data.ID" [nzLabel]="data.NAME">
                            </nz-option>
                          </nz-select>
                        </td>
                        <td [class.disabled-row]="data.IS_DISABLED" class="selling-price-cell">
                          <input class="selling-price-input-field" nz-input name="SELLING_PRICE{{ i }}"
                            maxlength="8" (keypress)="commonFunction.forCostFunction($event)"
                            (paste)="commonFunction.handlePaste($event)" [(ngModel)]="data.SELLING_PRICE"
                            placeholder="Selling Price" [disabled]="data.TAX_PREFERENCE == 'T'" autocomplete="off"
                            (ngModelChange)="onTaxChange($event, i)" type="text" nzSize="small" required />
                        </td>
                        <td align="center" [class.disabled-row]="data.IS_DISABLED" class="discount-allowed-cell">
                          <nz-switch nzSize="small" name="DISCOUNT_ALLOWED{{ i }}" nzCheckedChildren="Yes"
                            nzUnCheckedChildren="No" [(ngModel)]="data.DISCOUNT_ALLOWED"
                            (ngModelChange)="onChangeDiscountAllowed($event, i)">
                          </nz-switch>
                        </td>
                        <td align="center" [class.disabled-row]="data.IS_DISABLED" class="discounted-price-cell">
                          <input class="discounted-price-input-field" nz-input name="DISCOUNTED_PRICE{{ i }}" nzAllowClear="false"
                            maxlength="8" (keypress)="commonFunction.forCostFunction($event)"
                            (paste)="commonFunction.handlePaste($event)" [(ngModel)]="data.DISCOUNTED_PRICE"
                            placeholder="Discount Price" autocomplete="off" type="text" [disabled]="
                              data.DISCOUNT_ALLOWED ? 'false' : 'true'
                            " />
                        </td>
                        <td [class.disabled-row]="data.IS_DISABLED" class="average-level-cell">
                          <input class="average-level-input-field" nz-input name="AVG_LEVEL{{ i }}" maxlength="8"
                            (keypress)="commonFunction.onlynumdot($event)" [(ngModel)]="data.AVG_LEVEL"
                            placeholder="Average Level" autocomplete="off" type="text" required nzSize="small" />
                        </td>
                        <td [class.disabled-row]="data.IS_DISABLED" class="reorder-level-cell">
                          <input nzSize="small" class="reorder-level-input-field" nz-input name="REORDER_STOCK_LEVEL{{ i }}"
                            maxlength="8" (keypress)="commonFunction.onlynumdot($event)"
                            [(ngModel)]="data.REORDER_STOCK_LEVEL" placeholder="Re-Order Stock Level" autocomplete="off"
                            type="text" required />
                        </td>
                        <td [class.disabled-row]="data.IS_DISABLED" class="alert-level-cell">
                          <input class="alert-level-input-field" nz-input name="ALERT_STOCK_LEVEL{{ i }}" maxlength="8"
                            nzSize="small" (keypress)="commonFunction.onlynumdot($event)"
                            [(ngModel)]="data.ALERT_STOCK_LEVEL" placeholder="Alert Stock Level" autocomplete="off"
                            type="text" required />
                        </td>
                        <td [class.disabled-row]="data.IS_DISABLED" class="sku-code-cell">
                          <input class="sku-code-input-field" nz-input name="SKU_CODE{{ i }}" maxlength="32" nzSize="small"
                            [(ngModel)]="data.SKU_CODE" placeholder="Enter SKU Code" autocomplete="off" type="text"
                            required />
                        </td>
                        <td [class.disabled-row]="data.IS_DISABLED" class="inventory-tracking-cell">
                          <nz-select nzAllowClear="false" nzSize="small" class="inventory-tracking-select-field"
                            [(ngModel)]="data.INVENTORY_TRACKING_TYPE"
                            (ngModelChange)="changeTrackingType($event, data)" name="trackingtype{{ i }}"
                            nzPlaceHolder="Select Inventory Tracking Type">
                            <nz-option nzValue="N" nzLabel="None"></nz-option>
                            <nz-option nzValue="S" nzLabel="Serial No. Wise"></nz-option>
                            <nz-option nzValue="B" nzLabel="Batch Wise"></nz-option>
                          </nz-select>
                        </td>
                        <td align="center" [class.disabled-row]="data.IS_DISABLED" class="warranty-allowed-cell">
                          <nz-switch nzSize="small" name="WARRANTY_ALLOWED{{ i }}" nzCheckedChildren="Yes"
                            nzUnCheckedChildren="No" [disabled]="data.INVENTORY_TRACKING_TYPE != 'S'"
                            [(ngModel)]="data.WARRANTY_ALLOWED" (ngModelChange)="warrantyAllowChange($event, i)">
                          </nz-switch>
                        </td>
                        <td align="center" [class.disabled-row]="data.IS_DISABLED" class="warranty-period-cell">
                          <input class="warranty-period-input-field" nz-input name="WARRANTY_PERIOD{{ i }}" nzAllowClear="false"
                            maxlength="8" (keypress)="commonFunction.omit($event)" [(ngModel)]="data.WARRANTY_PERIOD"
                            placeholder="Warranty Period" autocomplete="off" type="text" [disabled]="
                              data.INVENTORY_TRACKING_TYPE != 'S' ||
                              !data.WARRANTY_ALLOWED
                            " />
                        </td>
                        <td align="center" [class.disabled-row]="data.IS_DISABLED" class="warranty-card-cell">
                          <button *ngIf="
                              !dataList[i]['fileURL'] &&
                              data.WARRANTY_ALLOWED &&
                              (!data.WARRANTY_CARD ||
                                data.WARRANTY_CARD.trim() === '')
                            " nz-button class="upload-button"
                            (click)="image1.click()">
                            Upload
                            <input #image1 name="image1" type="file" accept=".png, .jpg, .jpeg, .pdf, .doc, .docx"
                              (change)="onFileSelected($event, i)" class="file-input" />
                          </button>
                          <nz-spin [nzSpinning]="dataList[i]['loading']">
                            <div class="file-name-display" #NAME [attr.title]="isTextOverflowing(NAME)? data.WARRANTY_CARD: null">
                              {{ data.WARRANTY_CARD }}
                            </div>
                            <div class="file-actions">
                              <a *ngIf="
                                  data.WARRANTY_CARD &&
                                  data.WARRANTY_CARD.trim() !== '' &&
                                  data.WARRANTY_ALLOWED
                                " class="view-file-link" [href]="
                                  retriveimgUrl +
                                  'WarrantyCard/' +
                                  data.WARRANTY_CARD
                                " target="_blank" nz-tooltip nzTooltipTitle="Click Here To View Uploaded file">
                                <span nz-icon nzType="eye" nzTheme="outline"></span>
                              </a>
                              <span *ngIf="
                                  ((data.WARRANTY_CARD &&
                                    data.WARRANTY_CARD.trim() !== '') ||
                                    dataList[i]['fileURL']) &&
                                  data.WARRANTY_ALLOWED
                                " nz-popconfirm nzPopconfirmTitle="Are you sure you want to delete?"
                                nzPopconfirmPlacement="top" (nzOnConfirm)="image1DeleteConfirm(data, i)"
                                (nzOnCancel)="deleteCancel()" class="delete-file-button">
                                <span nz-icon nzType="delete" nzTheme="twotone" [nzTwotoneColor]="'#FF0000'" nz-tooltip
                                  nzTooltipTitle="Delete"></span>
                              </span>
                            </div>
                          </nz-spin>
                        </td>
                        <td align="center" [class.disabled-row]="data.IS_DISABLED" class="guarantee-allowed-cell">
                          <nz-switch [disabled]="data.INVENTORY_TRACKING_TYPE != 'S'" nzSize="small"
                            name="GUARANTEE_ALLOWED{{ i }}" nzCheckedChildren="Yes" nzUnCheckedChildren="No"
                            [(ngModel)]="data.GUARANTEE_ALLOWED" (ngModelChange)="guaranteeAllowChange($event, i)">
                          </nz-switch>
                        </td>
                        <td align="center" [class.disabled-row]="data.IS_DISABLED" class="guarantee-period-cell">
                          <input class="guarantee-period-input-field" nz-input name="GUARANTEE_PERIOD{{ i }}" nzAllowClear="false"
                            maxlength="8" (keypress)="commonFunction.omit($event)" [(ngModel)]="data.GUARANTEE_PERIOD"
                            placeholder="Guarantee Period" autocomplete="off" type="text" [disabled]="
                              data.INVENTORY_TRACKING_TYPE != 'S' ||
                              !data.GUARANTEE_ALLOWED
                            " />
                        </td>
                        <td align="center" [class.disabled-row]="data.IS_DISABLED" class="expiry-allowed-cell">
                          <nz-switch nzSize="small" [disabled]="
                              data.INVENTORY_TRACKING_TYPE !== 'B' &&
                              data.INVENTORY_TRACKING_TYPE !== 'S'
                            " name="EXPIRY_DATE_ALLOWED{{ i }}" nzCheckedChildren="Yes" nzUnCheckedChildren="No"
                            [(ngModel)]="data.EXPIRY_DATE_ALLOWED">
                          </nz-switch>
                        </td>
                        <td align="center" [class.disabled-row]="data.IS_DISABLED" class="expected-delivery-cell">
                          <input class="expected-delivery-input-field" nz-input name="EXPECTED_DELIVERY_IN_DAYS{{ i }}"
                            nzAllowClear="false" maxlength="8" (keypress)="commonFunction.omit($event)"
                            [(ngModel)]="data.EXPECTED_DELIVERY_IN_DAYS" placeholder="Expected Delivery Day(s)"
                            autocomplete="off" type="text" />
                        </td>
                        <td align="center" [class.disabled-row]="data.IS_DISABLED" class="expected-charges-cell">
                          <input class="expected-charges-input-field" nz-input name="EXPECTED_DELIVERY_CHARGES{{ i }}"
                            nzAllowClear="false" maxlength="8" (keypress)="commonFunction.omit($event)"
                            [(ngModel)]="data.EXPECTED_DELIVERY_CHARGES" placeholder="Expected Delivery Charges"
                            autocomplete="off" type="text" />
                        </td>
                        <td align="center" class="inventory-image-cell">
                          <button *ngIf="
                              !dataList[i]['fileURL1'] &&
                              (!data.INVENTORY_DETAILS_IMAGE ||
                                data.INVENTORY_DETAILS_IMAGE.trim() === '')
                            " nz-button class="upload-button"
                            (click)="image2.click()">
                            Upload
                            <input #image2 name="image2" type="file" accept=".png, .jpg, .jpeg"
                              (change)="onFileSelected1($event, i)" class="file-input" />
                          </button>
                          <nz-spin [nzSpinning]="dataList[i]['loading']">
                            <div class="file-name-display" #NAME1 [attr.title]="isTextOverflowing(NAME1)? data.INVENTORY_DETAILS_IMAGE: null">
                              {{ data.INVENTORY_DETAILS_IMAGE }}
                            </div>
                            <div class="file-actions">
                              <a *ngIf="
                                  data.INVENTORY_DETAILS_IMAGE &&
                                  data.INVENTORY_DETAILS_IMAGE.trim() !== ''
                                " class="view-file-link" [href]="
                                  retriveimgUrl +
                                  'InventoryDetailsImage/' +
                                  data.INVENTORY_DETAILS_IMAGE
                                " target="_blank" nz-tooltip nzTooltipTitle="Click Here To View Uploaded Image">
                                <span nz-icon nzType="eye" nzTheme="outline"></span>
                              </a>
                              <span *ngIf="
                                  (data.INVENTORY_DETAILS_IMAGE &&
                                    data.INVENTORY_DETAILS_IMAGE.trim() !==
                                      '') ||
                                  dataList[i]['fileURL1']
                                " nz-popconfirm nzPopconfirmTitle="Are you sure you want to delete?"
                                nzPopconfirmPlacement="top" (nzOnConfirm)="image1DeleteConfirm1(data, i)"
                                (nzOnCancel)="deleteCancel1()" class="delete-file-button">
                                <span nz-icon nzType="delete" nzTheme="twotone" [nzTwotoneColor]="'#FF0000'" nz-tooltip
                                  nzTooltipTitle="Delete"></span>
                              </span>
                            </div>
                          </nz-spin>
                        </td>
                        <td align="center" [class.disabled-row]="data.IS_DISABLED" class="short-code-cell">
                          <input class="short-code-input-field" nz-input name="SHORT_CODE{{ i }}" nzAllowClear="false"
                            maxlength="8" (keypress)="commonFunction.allowOnly($event)" [(ngModel)]="data.SHORT_CODE"
                            placeholder="Short Code" autocomplete="off" type="text" />
                        </td>
                        <td nzRight align="center" [class.disabled-row]="data.IS_DISABLED" class="status-cell">
                          <nz-switch nzSize="small" name="STATUS{{ i }}" nzCheckedChildren="Yes"
                            nzUnCheckedChildren="No" [(ngModel)]="data.STATUS">
                          </nz-switch>
                        </td>
                      </tr>
                    </tbody>
                  </nz-table>
                </div>
              </div>
            </nz-spin>
          </form>
          <div class="footer">
            <button type="button" class="ant-btn ant-btn-primary previous-button" nz-button (click)="back()">
              <span><span nz-icon nzType="arrow-left" nzTheme="outline"></span>&nbsp;Previous</span>
            </button>
            <button type="button" nz-button (click)="close()" class="ant-btn cancel-details-button">
              <span>Cancel</span>
            </button>
            <button type="button" [nzLoading]="isSpinning" class="ant-btn ant-btn-primary save-close-button" nz-button [nzOkText]="'Yes'"
              (click)="Savealldata()" nz-popconfirm nzPopconfirmTitle="Are you sure save or update Variant Details?"
              [nzCondition]="switchValue" (nzOnConfirm)="saveFinal()" (nzOnCancel)="cancelFinal()">
              Save & Close
            </button>
          </div>
        </div>
      </nz-tab>
    </nz-tabset>
  </form>
</div>
<div *ngIf="ItemMappingDrawerVisible">
  <nz-drawer [nzBodyStyle]="{
      height: 'calc(100% - 55px)',
      overflow: 'auto',
      'padding-bottom': '53px',
      'padding-top': '10px',
      'padding-left': '15px',
      'padding-right': '15px'
    }" [nzClosable]="true" [nzMask]="true" [nzMaskClosable]="false" [nzWidth]="900"
    [nzVisible]="ItemMappingDrawerVisible" [nzTitle]="ItemMappingDrawerTitle" (nzOnClose)="ItemMappingDrawerClose()"
    (nzKeyboard)="(true)">
    <ng-container *nzDrawerContent>
      <app-item-mapping [drawerClose]="ItemMappingCloseCallback" [drawerVisible]="ItemMappingDrawerVisible"
        [data]="drawerData" [UnitName]="Unitname" [UnitId]="Unitid" [itemcategoryis]="itemcategoryis" [itemId]="ItemId">
      </app-item-mapping>
    </ng-container>
  </nz-drawer>
</div>
<div *ngIf="itemImagesDrawerVisible">
  <nz-drawer [nzBodyStyle]="{
      height: 'calc(100% - 55px)',
      overflow: 'auto',
      'padding-bottom': '53px'
    }" [nzClosable]="true" [nzMask]="true" [nzMaskClosable]="false" [nzWidth]="900"
    [nzVisible]="itemImagesDrawerVisible" [nzTitle]="itemImagesDrawerTitle" (nzOnClose)="itemImagesDrawerClose()"
    (nzKeyboard)="(true)">
    <ng-container *nzDrawerContent>
      <app-add-inventory-images [drawerClose]="itemImagesDrawerCloseCallback" [drawerVisible]="itemImagesDrawerVisible"
        [data]="addImageDrawerData">
      </app-add-inventory-images>
    </ng-container>
  </nz-drawer>
</div>