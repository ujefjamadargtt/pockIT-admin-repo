<div nz-row>
  <div nz-col nzSpan="4"></div>
  <div nz-col nzSpan="16">
    <div nz-row class="select-container justify-end">
      <div nz-col nzSpan="14">
        <div class="formname" *ngIf="TYPE==''">
          Chats History
        </div>
      </div>
      <div nz-col nzSpan="10">
        <nz-form-item class="job-select-item" [ngStyle]="{ display: TYPE == 'JOB' ? 'none' : 'block' }">
          <nz-form-control nzHasFeedback nzErrorTip="Select Job">
            <nz-select nzShowSearch nzAllowClear class="full-width" nzPlaceHolder="Select Job" [(ngModel)]="JOB"
              [nzOptionHeightPx]="80" name="customerName" (ngModelChange)="onTechnicianChange($event)">
              <nz-option nzCustomContent *ngFor="let customer of dataListOrder" [nzValue]="customer.ID"
                [nzLabel]="customer.JOB_CARD_NO + ' ' + customer.SERVICE_NAME">
                <div nz-row>
                  <div nz-col nzSpan="12" class="job-service-name">
                    Service Name : {{ customer.SERVICE_NAME }}
                  </div>
                  <div nz-col nzSpan="24" class="job-number">
                    Job No.: {{ customer.JOB_CARD_NO }}
                  </div>
                </div>
              </nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>
      </div>
    </div>
    <nz-spin [nzSpinning]="loaddata">
      <div class="chat-container" *ngIf="chantcount > 0; else elseblock">
        <div class="message-box chat-bg" *ngIf="TYPE == 'TECHNICIAN'; else elsetechBlock">
          <div *ngFor="let data of chatDetailsdata">
            <div class="message customer-message" *ngIf="data.BY_CUSTOMER">
              <span class="customer-name" *ngIf="chatDetailsdata!=undefined">{{data.CUSTOMER_NAME}}</span>
              <div>
                <div class="box33 sb13" *ngIf="chatDetailsdata!=undefined">
                  {{ data.MESSAGE }}
                  <div *ngIf="
                    data['ATTACHMENT_URL'] != null &&
                    data['ATTACHMENT_URL'] != '' &&
                    data['ATTACHMENT_URL'] != undefined
                  ">
                    <img *ngIf="data['MEDIA_TYPE']=='I' else elsevblock2;" nz-image width="100%" height="50px"
                      nzSrc="{{ urllll }}OrderChat/{{data['ATTACHMENT_URL']}}" alt="" />
                    <ng-template #elsevblock2>
                      <video width="100%" height="100px" controls>
                        <source src="{{ urllll }}OrderChat/{{
                            data['ATTACHMENT_URL']
                          }}" />
                      </video>
                    </ng-template>
                  </div>
                </div>
                <div class="timestamp" *ngIf="chatDetailsdata!=undefined">{{data.SEND_DATE | date: 'dd/MM/yy HH:mm a'}}
                </div>
              </div>
            </div>
            <div class="message technician-message" *ngIf="!data.BY_CUSTOMER">
              <span class="technician-name" *ngIf="chatDetailsdata!=undefined">{{ data.TECHNICIAN_NAME }}</span>
              <div class="box3 sb14" *ngIf="chatDetailsdata!=undefined">
                {{ data.MESSAGE }}
                <div *ngIf="
                    data['ATTACHMENT_URL'] != null &&
                    data['ATTACHMENT_URL'] != '' &&
                    data['ATTACHMENT_URL'] != undefined
                  ">
                  <img *ngIf="data['MEDIA_TYPE']=='I' else elsevblock1;" nz-image width="100%" height="50px"
                    nzSrc="{{ urllll }}OrderChat/{{data['ATTACHMENT_URL']}}" alt="" />
                  <ng-template #elsevblock1>
                    <video width="100%" height="100px" controls>
                      <source src="{{ urllll }}OrderChat/{{
                            data['ATTACHMENT_URL']
                          }}" />
                    </video>
                  </ng-template>
                </div>
              </div>
              <span class="timestamp" *ngIf="chatDetailsdata!=undefined">{{data.SEND_DATE | date: 'dd/MM/yy HH:mm
                a'}}</span>
            </div>
          </div>
        </div>
        <ng-template #elsetechBlock>
          <div class="message-box chat-bg">
            <div *ngFor="let data of chatDetailsdata">
              <div class="message customer-message" *ngIf="!data.BY_CUSTOMER">
                <span class="customer-name" *ngIf="chatDetailsdata!=undefined">{{data.TECHNICIAN_NAME}}</span>
                <div>
                  <div class="box33 sb13" *ngIf="chatDetailsdata!=undefined">
                    {{ data.MESSAGE }}
                    <div *ngIf="
                    data['ATTACHMENT_URL'] != null &&
                    data['ATTACHMENT_URL'] != '' &&
                    data['ATTACHMENT_URL'] != undefined
                  ">
                      <img *ngIf="data['MEDIA_TYPE']=='I' else elsevblock;" nz-image width="100%" height="50px"
                        nzSrc="{{ urllll }}OrderChat/{{data['ATTACHMENT_URL']}}" alt="" />
                      <ng-template #elsevblock>
                        <video width="100%" height="100px" controls>
                          <source src="{{ urllll }}OrderChat/{{
                            data['ATTACHMENT_URL']
                          }}" />
                        </video>
                      </ng-template>
                    </div>
                  </div>
                  <div class="timestamp" *ngIf="chatDetailsdata!=undefined">{{data.SEND_DATE | date: 'dd/MM/yy HH:mm
                    a'}}
                  </div>
                </div>
              </div>
              <div class="message technician-message" *ngIf="data.BY_CUSTOMER">
                <span class="technician-name" *ngIf="chatDetailsdata!=undefined">{{ data.CUSTOMER_NAME }}</span>
                <div class="box3 sb14" *ngIf="chatDetailsdata!=undefined">
                  <div [innerHTML]="transform(data['MESSAGE'])"></div>
                  <div *ngIf="
                    data['ATTACHMENT_URL'] != null &&
                    data['ATTACHMENT_URL'] != '' &&
                    data['ATTACHMENT_URL'] != undefined
                  ">
                    <img *ngIf="data['MEDIA_TYPE']=='I' else elsevblocsk;" nz-image width="100%" height="50px"
                      nzSrc="{{ urllll }}OrderChat/{{ data['ATTACHMENT_URL'] }}" alt="" />
                    <ng-template #elsevblocsk>
                      <video width="100%" height="100px" controls>
                        <source src="{{ urllll }}OrderChat/{{
                            data['ATTACHMENT_URL']
                          }}" />
                      </video>
                    </ng-template>
                  </div>
                </div>
                <span class="timestamp" *ngIf="chatDetailsdata!=undefined">{{data.SEND_DATE | date: 'dd/MM/yy HH:mm
                  a'}}</span>
              </div>
            </div>
          </div>
        </ng-template>
      </div>
      <ng-template #elseblock>
        <div nz-row class="empty-wrapper">
          <div nz-col nzSpan="24" class="empty-center">
            <nz-empty nzNotFoundImage="https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg"
              [nzNotFoundContent]="contentTpl43" [nzNotFoundFooter]="footerTpl43" class="empty-margin-top">
              <ng-template #contentTpl43>
                <span> Data Not Found</span>
              </ng-template>
              <ng-template #footerTpl43>
              </ng-template>
            </nz-empty>
          </div>
        </div>
      </ng-template>
    </nz-spin>
  </div>
  <div nz-col nzSpan="4"></div>
</div>