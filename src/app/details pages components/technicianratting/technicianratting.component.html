<div nz-row>
  <div nz-col nzSpan="3"></div>
  <div nz-col nzSpan="18">
    <div nz-row>
      <div nz-col nzSpan="12">
        <div class="formname" *ngIf="TYPE === ''">
          <span (click)="back()" nz-icon nzType="arrow-left" nzTheme="outline"
            style="font-weight: bold; cursor: pointer"></span>&nbsp;&nbsp;Technician Ratings for Customers
        </div>
        <!-- <div class="formname" *ngIf="TYPE == ''">Technician Ratings for Customers</div> -->
      </div>

      <div nz-col nzSpan="12">
        <div style="display: flex; justify-content: flex-end; align-items: center">
          <button nz-button style="margin-right: 10px" nzTooltipTitle="Filter" [nzType]="isFilterApplied"
            nzTooltipPlacement="top" nz-tooltip (click)="showFilter()">
            <i nz-icon nzType="filter"></i>
          </button>
        </div>
      </div>
    </div>

    <div nz-row>
      <div nz-col nzSpan="24">
        <div class="filter {{ filterClass }}">
          <div class="filter-box">
            <form nz-form>
              <div nz-row>
                <div nz-col nzSpan="8" *ngIf="TYPE != 'CUSTOMER' && TYPE != 'JOB' && TYPE != 'VENDOR'">
                  <nz-form-item style="margin-right: 10px !important">
                    <nz-form-label nzNoColon>Customers</nz-form-label>
                    <nz-select nzShowSearch nzAllowClear nzMode="multiple" nzPlaceHolder="Select Customers"
                      [nzShowArrow]="true" style="width: 100%; font-weight: 100 !important" [nzMaxTagCount]="2"
                      name="Customerss" [(ngModel)]="Customers">
                      <nz-option *ngFor="let list of CustomersData" [nzValue]="list.ID"
                        [nzLabel]="list.NAME"></nz-option>
                    </nz-select>
                  </nz-form-item>
                </div>
                <div nz-col nzSpan="8" *ngIf="TYPE != 'TECHNICIAN'">
                  <nz-form-item style="margin-right: 10px !important">
                    <nz-form-label nzNoColon>Technician</nz-form-label>
                    <nz-select nzShowSearch nzAllowClear nzMode="multiple" nzPlaceHolder="Select Technician"
                      [nzShowArrow]="true" style="width: 100%; font-weight: 100 !important" [nzMaxTagCount]="2"
                      name="Technicians" [(ngModel)]="Technician">
                      <nz-option *ngFor="let list of TechData" [nzValue]="list.ID" [nzLabel]="list.NAME"></nz-option>
                    </nz-select>
                  </nz-form-item>
                </div>
                <div nz-col nzSpan="8" style="
                    display: flex;
                    gap: 10px;
                    padding-top: 0px;
                    align-self: center;
                  ">
                  <button nz-button [nzLoading]="isSpinning" nzType="primary" class="flexicons" (click)="applyFilter()">
                    <i nz-icon nzType="filter"></i>Apply Filter
                  </button>
                  <button nz-button nzType="primary" class="flexicons" (click)="clearFilter()">
                    <i nz-icon nzType="delete"></i>Clear filter
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
    <nz-divider></nz-divider>

    <div nz-row *ngIf="technicianData.length > 0">
      <div nz-col nzSpan="12">
        <nz-rate [(ngModel)]="averageTechnicianRating" nzDisabled></nz-rate>
        <span class="ant-rate-text">{{ averageTechnicianRating }} Out Of 5</span>
        <span class="ant-rate-text">({{ globalTechnicianRating }} global ratings)</span>
      </div>

      <!-- <div *ngFor="let progTech of progressTechList">
          <div nz-row>
            <div nz-col nzSpan="4">{{ progTech.rating }} Star</div>
            <div nz-col nzSpan="20">
              <nz-progress
                [nzPercent]="progTech.progress_percentage"
                [nzStrokeColor]="'Yellow'"
                [nzShowInfo]="false"
              >
              </nz-progress>
              <ng-container
                *ngIf="
                  progTech.progress_percentage === 100;
                  else showPercentage
                "
              >
                <span class="custom-text">100%</span>
              </ng-container>
              <ng-template #showPercentage>
                <span class="custom-text">
                  {{ progTech.progress_percentage }}%
                </span>
              </ng-template>
            </div>
          </div>
        </div> -->

      <div nz-col nzSpan="12" style="align-items: end">
        <div *ngFor="let progTech of progressTechList">
          <div nz-row>
            <div nz-col nzSpan="4">{{ progTech.rating }} Star</div>

            <div nz-col nzSpan="20">
              <nz-progress [nzPercent]="progTech.progress_percentage" [nzStrokeColor]="'Yellow'" [nzStatus]="
                  progTech.progress_percentage === 100 ? 'normal' : 'active'
                ">
                <!-- Custom Text for 100% -->
                <ng-template #text>
                  {{
                  progTech.progress_percentage === 100
                  ? "100%"
                  : progTech.progress_percentage + "%"
                  }}
                </ng-template>
              </nz-progress>
            </div>
          </div>
        </div>
      </div>

      <nz-divider nzText="Comments" nzOrientation="center"></nz-divider>

      <div nz-col nzSpan="24" style="
          margin-top: 5px;
          padding: 5px;
          max-height: 40vh;
          overflow: auto;
          padding-right: 10px;
        ">
        <div *ngFor="let data of technicianData; let i=index;">
          <nz-comment nzAuthor="{{ data['TECHNICIAN_NAME'] }}">
            <nz-avatar nz-comment-avatar nzIcon="user" nzSrc="assets/img/blueEmpImage.png"></nz-avatar>

            <nz-comment-content>
              <span *ngIf="technicianData != null && data.CUSTOMER_NAME"
                style="font-weight: 600;font-size: 12px !important;">To Customer : {{ data.CUSTOMER_NAME }}</span><br />
              <span>
                {{ data["COMMENTS"] }}
              </span>
              <div style="margin-top: 0px">
                <nz-rate [ngModel]="roundRating(data.RATING)" nzAllowHalf="true" name="ratess{{ i }}"
                  nzDisabled></nz-rate>
              </div>
            </nz-comment-content>
          </nz-comment>
        </div>
      </div>

      <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24" *ngIf="technicianData.length == 0"
        style="font-weight: 600; margin-top: 10%">
        <nz-empty nzNotFoundImage="https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg"
          [nzNotFoundContent]="contentTpl" [nzNotFoundFooter]="footerTpl">
          <ng-template #contentTpl>
            <span> Data Not Found</span>
          </ng-template>
          <ng-template #footerTpl> </ng-template>
        </nz-empty>
      </div>

      <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24" *ngIf="totalRecords > 10">
        <div style="text-align: center" *ngIf="totalRecords > technicianData.length">
          <button nz-button nzType="primary" (click)="loadMoreTechnician()">
            Load More
          </button>
        </div>
      </div>
    </div>
    <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24" *ngIf="technicianData.length == 0"
      style="font-weight: 600; margin-top: 10%">
      <nz-empty nzNotFoundImage="https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg"
        [nzNotFoundContent]="contentTpl" [nzNotFoundFooter]="footerTpl">
        <ng-template #contentTpl>
          <span> Data Not Found</span>
        </ng-template>
        <ng-template #footerTpl> </ng-template>
      </nz-empty>
    </div>
  </div>
  <div nz-col nzSpan="3"></div>
</div>