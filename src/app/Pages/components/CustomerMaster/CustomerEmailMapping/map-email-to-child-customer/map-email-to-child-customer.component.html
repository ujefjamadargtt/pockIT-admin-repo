<div class="territory-container">
    <form nz-form #TerritoryMappingForm="ngForm">
        <nz-spin [nzSpinning]="isSpinning">
            <div nz-row>
                <div nz-col nzSpan="15">
                    <nz-form-item class="form-item-full">
                        <nz-form-label nzNoColon nzRequired>Email ID</nz-form-label>
                        <nz-form-control nzErrorTip="Enter Email ID">
                            <input nz-input name="email" placeholder="Enter Email ID"
                                [pattern]="commonFunction.emailpattern" [(ngModel)]="addData.EMAIL_ID" required
                                maxlength="64" #email="ngModel" class="full-width-input" />
                        </nz-form-control>
                    </nz-form-item>
                </div>
                <div nz-col nzSpan="6">
                    <nz-form-item class="form-item-full">
                        <nz-form-label nzNoColon nzRequired>Minimum Part Amount</nz-form-label>
                        <nz-form-control nzErrorTip="Enter Amount">
                            <nz-input-group [nzAddOnBefore]="'₹'">
                                <input nz-input type="text" name="PRICE_RANGE" placeholder="Enter Amount" required
                                    [(ngModel)]="addData.PRICE_RANGE" #nameField="ngModel" autocomplete="off"
                                    (keypress)="commonFunction.onlynumdot($event)" maxlength="8"
                                    class="full-width-input" />
                            </nz-input-group>
                        </nz-form-control>
                    </nz-form-item>
                </div>
                <div nz-col nzSpan="3">
                    <nz-form-item class="form-item-full">
                        <nz-form-control>
                            <nz-form-label nzNoColon></nz-form-label>
                            <button nz-button nzType="primary" class="btn-add" [nzLoading]="btnLoading"
                                (click)="isEditMode ? updateData(TerritoryMappingForm) : add(TerritoryMappingForm)">
                                {{ isEditMode ? 'Update' : '+ Add' }}
                            </button>
                        </nz-form-control>
                    </nz-form-item>
                </div>
            </div>
            <hr />
            <div nz-row>
                <div nz-col nzSpan="12"></div>
                <div nz-col nzSpan="12" class="search-container">
                    <nz-form-item>
                        <nz-input-group nzSearch [nzAddOnAfter]="suffixIconButton" class="search-input-group">
                            <input type="text" name="mapsearch" [(ngModel)]="searchmappeddata" autocomplete="off"
                                (keydown.enter)="handleEnterKey($event)" (keydown.backspace)="handleEnterKey($event)"
                                nz-input class="search-input" placeholder="Min 3 chars required." />
                        </nz-input-group>
                        <ng-template #suffixIconButton>
                            <button nz-button nzType="primary" class="btn-search"
                                (click)="SearchMappingdata(searchmappeddata)">
                                <i nz-icon nzType="search"></i>
                            </button>
                        </ng-template>
                    </nz-form-item>
                </div>
            </div>
        </nz-spin>
    </form>
</div>
<div nz-row>
    <div nz-col nzSpan="24">
        <nz-table class="my-scroll no-wrap1" #table [nzData]="dataList" [nzLoading]="loadingRecords" nzBordered
            [nzSize]="'small'" [nzFrontPagination]="false" (nzQueryParams)="sort($event)">
            <thead>
                <tr>
                    <th nzWidth="15px" class="table-header-center">Action</th>
                    <th nzWidth="15px" class="table-header-center" nzColumnKey="{{ 'IS_ACTIVE' }}" [nzSortFn]="true">
                        Is Mapped ?
                    </th>
                    <th nzWidth="140px" class="table-header-center" nzColumnKey="{{ 'EMAIL_ID' }}" [nzSortFn]="true">
                        Email ID
                    </th>
                    <th nzWidth="100px" class="table-header-center" nzColumnKey="{{ 'PRICE_RANGE' }}" [nzSortFn]="true">
                        Amount (₹)
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let data of table.data">
                    <td class="table-cell-center">
                        <nz-tag nzColor="#2db7f5" (click)="editRow(data)" class="tag-edit" nz-tooltip
                            nzTooltipTitle="Edit">
                            <span nz-icon nzType="edit" nzTheme="outline" class="icon-edit"></span>&nbsp;&nbsp;Edit
                        </nz-tag>
                    </td>
                    <td class="table-cell-center">
                        <nz-switch *ngIf="data['ID']" nzCheckedChildren="Yes" nzUnCheckedChildren="No"
                            (ngModelChange)="changestatus(data,$event)" name="IS_ACTIVE"
                            [(ngModel)]="data['IS_ACTIVE']"></nz-switch>
                    </td>
                    <td class="table-cell-left">
                        <span *ngIf="data['EMAIL_ID'] != null">
                            <span *ngIf="data['EMAIL_ID'].length >= 35" nz-popover [nzPopoverContent]="data['EMAIL_ID']"
                                nzPopoverPlacement="topLeft">
                                {{ data["EMAIL_ID"] | slice:0:35 }}{{ data["EMAIL_ID"].length > 35 ? "..." : "" }}
                            </span>
                            <span *ngIf="data['EMAIL_ID'].length < 35">
                                {{ data["EMAIL_ID"] | slice:0:35 }}{{ data["EMAIL_ID"].length > 35 ? "..." : "" }}
                            </span>
                        </span>
                        <span *ngIf="data['EMAIL_ID'] == null">-</span>
                    </td>
                    <td class="table-cell-right">{{ data["PRICE_RANGE"] | number }}</td>
                </tr>
            </tbody>
        </nz-table>
    </div>
</div>
<div class="footer">
    <button type="button" nz-button class="btn-cancel" (click)="close()">Cancel</button>
    <button type="button" nz-button class="btn-primary" [nzLoading]="isSpinning" (click)="save()">Map & Close</button>
</div>