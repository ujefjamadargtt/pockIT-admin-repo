<div nz-row nzType="flex">
  <div nz-col nzXs="24" nzSm="24" nzMd="20" nzLg="20" nzXl="8">
    <div class="formname">
      <span (click)="back()" nz-icon nzType="arrow-left" nzTheme="outline" class="formname-back-icon"></span>
      &nbsp;&nbsp;{{ formTitle }}
    </div>
  </div>

  <div nz-col nzXs="24" nzSm="24" nzMd="4" nzLg="6" nzXl="16" class="formname-right-container">
    <form nz-form [nzLayout]="'inline'">
      <nz-form-item class="formname-action-item" *ngIf="showadd()">
        <button nz-button nzType="primary" (click)="add()" nzJustify="end" [nzLoading]="loadingRecords">
          <i nz-icon nzType="plus"></i> New Email service Config
        </button>
      </nz-form-item>
    </form>
  </div>
</div>
<div nz-row class="nz-row-margin-top-10">
  <div nz-col nzSpan="24">
    <nz-table class="my-scroll no-wrap1 email-config-table" nzBordered #table nzShowSizeChanger
      [nzFrontPagination]="false" [nzData]="emailServiceConfigData" [nzTotal]="totalRecords" [(nzPageIndex)]="pageIndex"
      [(nzPageSize)]="pageSize" (nzPageIndexChange)="search()" [nzLoading]="loadingRecords"
      (nzQueryParams)="sort($event)" [nzSize]="'small'" [nzScroll]="{ x: '600px', y: '55vh' }">
      <thead>
        <tr>
          <th nzWidth="80px" nzAlign="center" nzLeft class="email-config-th-center">
            <b>Action</b>
          </th>
          <th nzLeft nzWidth="300px" nzShowSort align="center" nzColumnKey="{{ 'SERVICE_PROVIDER' }}" [nzSortFn]="true"
            nzCustomFilter>
            Service Provider
          </th>
          <th nzLeft nzWidth="250px" nzShowSort align="center" nzColumnKey="{{ 'SMTP_HOST' }}" [nzSortFn]="true"
            nzCustomFilter>
            SMTP Host
          </th>
          <th nzWidth="150px" nzShowSort align="center" nzColumnKey="{{ 'SMTP_PORT' }}" [nzSortFn]="true"
            nzCustomFilter>
            SMTP Port
          </th>
          <th nzWidth="300px" nzShowSort align="center" nzColumnKey="{{ 'USERNAME' }}" [nzSortFn]="true" nzCustomFilter>
            User Name
            <nz-filter-trigger [(nzVisible)]="UserVisible" [nzDropdownMenu]="User">
              <span nz-icon nzType="filter" nzTheme="fill" [ngStyle]="{
              color: isUserApplied ? '#092B9C' : 'inherit'
            }"></span>
            </nz-filter-trigger>
          </th>
          <th nzWidth="300px" nzShowSort align="center" nzColumnKey="{{ 'SENDER_EMAIL' }}" [nzSortFn]="true"
            nzCustomFilter>
            Sender Email
          </th>
          <th nzWidth="300px" nzShowSort align="center" nzColumnKey="{{ 'SENDER_NAME' }}" [nzSortFn]="true"
            nzCustomFilter>
            Sender Name
          </th>
          <th nzWidth="100px" nzShowSort nzColumnKey="{{ 'IS_ACTIVE' }}" [nzSortFn]="true">
            Status
          </th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let data of table.data">
          <td align="center" nzLeft>
            <nz-tag nzColor="#2db7f5" (click)="edit(data)" class="email-config-edit-tag">
              <span nz-icon nzType="edit" nzTheme="outline" class="email-config-edit-icon"></span>
              &nbsp;&nbsp;Edit
            </nz-tag>
          </td>

          <td nzLeft align="left" [nzTooltipTitle]="isTextOverflow ? data['SERVICE_PROVIDER'] : null"
            #tooltipRef1="nzTooltip" nz-tooltip>
            <div #textContainer1 class="truncate-text" (mouseenter)="checkOverflow(textContainer1, tooltipRef1)">
              {{ data["SERVICE_PROVIDER"] ? data["SERVICE_PROVIDER"] : "-" }}
            </div>
          </td>

          <td nzLeft align="left" [nzTooltipTitle]="isTextOverflow ? data['SMTP_HOST'] : null" #tooltipRef="nzTooltip"
            nz-tooltip>
            <div #textContainer class="truncate-text" (mouseenter)="checkOverflow(textContainer, tooltipRef)">
              {{ data["SMTP_HOST"] ? data["SMTP_HOST"] : "-" }}
            </div>
          </td>

          <td align="center" [nzTooltipTitle]="isTextOverflow ? data['SMTP_PORT'] : null" #tooltipRef2="nzTooltip"
            nz-tooltip>
            <div #textContainer2 class="truncate-text" (mouseenter)="checkOverflow(textContainer2, tooltipRef2)">
              {{ data["SMTP_PORT"] ? data["SMTP_PORT"] : "-" }}
            </div>
          </td>

          <td align="left" [nzTooltipTitle]="isTextOverflow ? data['USERNAME'] : null" #tooltipRef3="nzTooltip"
            nz-tooltip>
            <div #textContainer3 class="truncate-text" (mouseenter)="checkOverflow(textContainer3, tooltipRef3)">
              {{ data["USERNAME"] ? data["USERNAME"] : "-" }}
            </div>
          </td>

          <td align="left" [nzTooltipTitle]="isTextOverflow ? data['SENDER_EMAIL'] : null" #tooltipRef5="nzTooltip"
            nz-tooltip>
            <div #textContainer5 class="truncate-text" (mouseenter)="checkOverflow(textContainer5, tooltipRef5)">
              {{ data["SENDER_EMAIL"] ? data["SENDER_EMAIL"] : "-" }}
            </div>
          </td>

          <td align="left" [nzTooltipTitle]="isTextOverflow ? data['SENDER_NAME'] : null" #tooltipRef4="nzTooltip"
            nz-tooltip>
            <div #textContainer4 class="truncate-text" (mouseenter)="checkOverflow(textContainer4, tooltipRef4)">
              {{ data["SENDER_NAME"] ? data["SENDER_NAME"] : "-" }}
            </div>
          </td>

          <td align="center">
            <i nz-icon *ngIf="data['IS_ACTIVE']" [nzType]="'check-circle'" [nzTheme]="'twotone'"
              [nzTwotoneColor]="'#52c41a'"></i>
            <i nz-icon *ngIf="!data['IS_ACTIVE']" [nzType]="'close-circle'" [nzTheme]="'twotone'"
              [nzTwotoneColor]="'#f50'"></i>
          </td>
        </tr>
      </tbody>
    </nz-table>
    <nz-dropdown-menu #Provider="nzDropdownMenu">
      <div class="ant-table-filter-dropdown">
        <div class="search-box">
          <nz-input-group [nzSuffix]="inputClearTpl">
            <input type="text" nz-input [(ngModel)]="ProviderText" (keyup)="onKeyup($event, 'ProviderText')"
              placeholder="Search Service provider" />
          </nz-input-group>
          <ng-template #inputClearTpl>
            <span nz-icon class="ant-input-clear-icon" nzTheme="fill" nzType="close-circle" *ngIf="ProviderText"
              (click)="reset()"></span>
            <span nz-icon nzType="search" nzTheme="outline" *ngIf="ProviderText == ''"></span>
          </ng-template>
        </div>
      </div>
    </nz-dropdown-menu>
    <nz-dropdown-menu #host="nzDropdownMenu">
      <div class="ant-table-filter-dropdown">
        <div class="search-box">
          <nz-input-group [nzSuffix]="inputClearTpl">
            <input type="text" nz-input [(ngModel)]="hostText" (keyup)="onKeyup($event, 'hostText')"
              placeholder="Search SMTP Host" />
          </nz-input-group>
          <ng-template #inputClearTpl>
            <span nz-icon class="ant-input-clear-icon" nzTheme="fill" nzType="close-circle" *ngIf="hostText"
              (click)="reset()"></span>
            <span nz-icon nzType="search" nzTheme="outline" *ngIf="hostText == ''"></span>
          </ng-template>
        </div>
      </div>
    </nz-dropdown-menu>
    <nz-dropdown-menu #Port="nzDropdownMenu">
      <div class="ant-table-filter-dropdown">
        <div class="search-box">
          <nz-input-group [nzSuffix]="inputClearTpl">
            <input type="text" nz-input [(ngModel)]="PortText" (keyup)="onKeyup($event, 'PortText')"
              placeholder="Search SMTP Port" />
          </nz-input-group>
          <ng-template #inputClearTpl>
            <span nz-icon class="ant-input-clear-icon" nzTheme="fill" nzType="close-circle" *ngIf="PortText"
              (click)="reset()"></span>
            <span nz-icon nzType="search" nzTheme="outline" *ngIf="PortText == ''"></span>
          </ng-template>
        </div>
      </div>
    </nz-dropdown-menu>
    <nz-dropdown-menu #User="nzDropdownMenu">
      <div class="ant-table-filter-dropdown">
        <div class="search-box">
          <nz-input-group [nzSuffix]="inputClearTpl">
            <input type="text" nz-input [(ngModel)]="UserText" (keyup)="onKeyup($event, 'UserText')"
              placeholder="Search User Name" />
          </nz-input-group>
          <ng-template #inputClearTpl>
            <span nz-icon class="ant-input-clear-icon" nzTheme="fill" nzType="close-circle" *ngIf="UserText"
              (click)="reset()"></span>
            <span nz-icon nzType="search" nzTheme="outline" *ngIf="UserText == ''"></span>
          </ng-template>
        </div>
      </div>
    </nz-dropdown-menu>
    <nz-dropdown-menu #Email="nzDropdownMenu">
      <div class="ant-table-filter-dropdown">
        <div class="search-box">
          <nz-input-group [nzSuffix]="inputClearTpl">
            <input type="text" nz-input [(ngModel)]="EmailText" (keyup)="onKeyup($event, 'EmailText')"
              placeholder="Search Sender Email" />
          </nz-input-group>
          <ng-template #inputClearTpl>
            <span nz-icon class="ant-input-clear-icon" nzTheme="fill" nzType="close-circle" *ngIf="EmailText"
              (click)="reset()"></span>
            <span nz-icon nzType="search" nzTheme="outline" *ngIf="EmailText == ''"></span>
          </ng-template>
        </div>
      </div>
    </nz-dropdown-menu>
    <nz-dropdown-menu #Sender="nzDropdownMenu">
      <div class="ant-table-filter-dropdown">
        <div class="search-box">
          <nz-input-group [nzSuffix]="inputClearTpl">
            <input type="text" nz-input [(ngModel)]="SenderText" (keyup)="onKeyup($event, 'SenderText')"
              placeholder="Search Sender Name" />
          </nz-input-group>
          <ng-template #inputClearTpl>
            <span nz-icon class="ant-input-clear-icon" nzTheme="fill" nzType="close-circle" *ngIf="SenderText"
              (click)="reset()"></span>
            <span nz-icon nzType="search" nzTheme="outline" *ngIf="SenderText == ''"></span>
          </ng-template>
        </div>
      </div>
    </nz-dropdown-menu>
  </div>
</div>
<nz-drawer [nzBodyStyle]="{
    height: 'calc(100% - 55px)',
    overflow: 'auto',
    'padding-bottom': '53px'
  }" [nzClosable]="true" [nzMask]="true" [nzMaskClosable]="true" [nzWidth]="1000" [nzVisible]="drawerVisible"
  [nzTitle]="drawerTitle" (nzOnClose)="drawerClose()" (nzKeyboard)="(true)">
  <ng-container *nzDrawerContent>
    <app-email-service-config [drawerClose]="closeCallback" [drawerVisible]="drawerVisible" [data]="drawerData">
    </app-email-service-config>
  </ng-container>
</nz-drawer>