<div>
  <form nz-form #brandMasterPage="ngForm">
    <nz-spin [nzSpinning]="isSpinning">
      <div nz-row>
        <div nz-col nzSpan="24">
          <nz-form-item>
            <nz-form-label nzRequired nzNoColon>Brand Name</nz-form-label>
            <nz-form-control nzHasFeedback nzErrorTip="Enter Brand Name">
              <input nz-input placeholder="Enter Brand Name" minlength="1" maxlength="128" autocomplete="off"
                (keyup)="commonFunction.allowBusinessNameChars($event)" name="BRAND_NAME" [(ngModel)]="data.BRAND_NAME"
                required (focus)="isFocused = 'BRAND_NAME'" (blur)="isFocused = ''" />
            </nz-form-control>
            <h6 style="color: red; font-size: 10px" *ngIf="data.BRAND_NAME && isFocused === 'BRAND_NAME'">
              {{ data.BRAND_NAME.length || 0 }}/128
            </h6>
          </nz-form-item>
        </div>
      </div>

      <div nz-row>
        <div nz-col nzSpan="12">
          <nz-form-item>
            <nz-form-label nzRequired nzNoColon>Short Code</nz-form-label>
            <nz-form-control nzHasFeedback nzErrorTip="Enter Short Code">
              <input nz-input placeholder="Enter Short Code" name="SHORT_CODE" [(ngModel)]="data.SHORT_CODE"
                minlength="1" maxlength="8" autocomplete="off" required (focus)="isFocused = 'SHORT_CODE'"
                (blur)="isFocused = ''" />
            </nz-form-control>
            <h6 style="color: red; font-size: 10px" *ngIf="data.SHORT_CODE && isFocused === 'SHORT_CODE'">
              {{ data.SHORT_CODE.length || 0 }}/8
            </h6>
          </nz-form-item>
        </div>

        <div nz-col nzSpan="12">
          <nz-form-item>
            <nz-form-label nzNoColon nzRequired>Sequence No.</nz-form-label>
            <nz-form-control nzHasFeedback nzErrorTip="Please Enter Sequence No.">
              <input nz-input placeholder="Sequence No." name="SeqNo" required [(ngModel)]="data.SEQUENCE_NO" required
                (keypress)="commonFunction.onlynum($event)" maxlength="8" autocomplete="off" />
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>
      <div nz-row>
        <!-- <div nz-col nzSpan="12">
          <nz-form-item>
            <nz-form-label nzNoColon nzRequired>Brand Image&nbsp;<span nz-icon nzType="info-circle" nzTheme="twotone"
                nz-tooltip nzTooltipTitle=" Please select an image file (PNG, JPG, JPEG) with a image
              dimension 165*165 px."></span>
              <span *ngIf="(data.BRAND_IMAGE && data.BRAND_IMAGE != ' ') || fileURL" nz-popconfirm
                nzPopconfirmTitle="Are you sure you want to delete?" nzPopconfirmPlacement="top"
                (nzOnConfirm)="image1DeleteConfirm(data)" (nzOnCancel)="deleteCancel()"
                style="cursor: pointer; color: red; margin-left: 10px">
                <span nz-icon nzType="delete" nzTheme="twotone" [nzTwotoneColor]="'#FF0000'" nz-tooltip
                  nzTooltipTitle="Delete"></span>
              </span>
            </nz-form-label>
            <nz-form-control nzHasFeedback nzErrorTip="Select Brand Image">
           
              <button *ngIf="
                  !fileURL &&
                  (!data.BRAND_IMAGE || data.BRAND_IMAGE.trim() === '')
                " nz-button style="
                  height: 28px;
                  padding: 0px 7px;
                  font-size: 10px;
                  width: 100%;
                " (click)="image1.click()">
                Upload Brand Image
                <input #image1 name="image1" type="file" accept=".png, .jpg, .jpeg" (change)="onFileSelected($event)"
                  style="display: none" />
              </button>
              <div *ngIf="
                  data.BRAND_IMAGE &&
                  data.BRAND_IMAGE != null &&
                  data.BRAND_IMAGE != undefined &&
                  data.BRAND_IMAGE != ' ' &&
                  data.BRAND_IMAGE != '' &&
                  (fileURL == undefined || fileURL == null || fileURL == '')
                " style="margin-top: 10px">
                <img nz-image [nzSrc]="fullImageUrl" alt="Uploaded Image" style="
                    width: 128px;
                    height: auto;
                    border: 1px solid #ddd;
                    margin-bottom: 10px;
                  " />
              </div>
              <div *ngIf="
                  fileURL != undefined &&
                  fileURL != null &&
                  fileURL != '' &&
                  fileURL != ' '
                " class="ss" style="align-items: center">
                <img nz-image [nzSrc]="imagePreview" alt="Preview" style="
                    height: 128px;
                    width: 128px;
                    overflow: auto;
                    /* max-width: 128;
                  max-height: 128; */
                  " />
              </div>
            </nz-form-control>
          </nz-form-item>
        </div> -->
        <div nz-col nzSpan="12">
          <nz-form-item>
            <nz-form-label nzNoColon nzRequired>Brand Image&nbsp;<span nz-icon nzType="info-circle" nzTheme="twotone"
                nz-tooltip nzTooltipTitle=" Please select an image file (PNG, JPG, JPEG) with a image
              dimension 165*165 px."></span>
              <span *ngIf="(data.BRAND_IMAGE && data.BRAND_IMAGE != ' ') || fileURL" nz-popconfirm
                nzPopconfirmTitle="Are you sure you want to delete?" nzPopconfirmPlacement="top"
                (nzOnConfirm)="image1DeleteConfirm(data)" (nzOnCancel)="deleteCancel()"
                style="cursor: pointer; color: red; margin-left: 10px">
                <span nz-icon nzType="delete" nzTheme="twotone" [nzTwotoneColor]="'#FF0000'" nz-tooltip
                  nzTooltipTitle="Delete"></span>
              </span>
            </nz-form-label>
            <nz-form-control nzHasFeedback nzErrorTip="Select Brand Image">
              <!-- Upload Button -->
              <button *ngIf="
                  !fileURL &&
                  (!data.BRAND_IMAGE || data.BRAND_IMAGE.trim() === '')
                " nz-button style="
                  height: 28px;
                  padding: 0px 7px;
                  font-size: 10px;
                  width: 100%;
                " (click)="image1.click()">
                Upload Image
                <input #image1 name="image1" type="file" accept=".png, .jpg, .jpeg" (change)="onFileSelected($event)"
                  style="display: none" />
                <!-- (change)="fileChangeEvent($event)" -->
              </button>
              <!-- <input nz-input type="file" (change)="fileChangeEvent($event)" /> -->

              <!-- Display Temporary Preview (Before Upload) -->
              <!-- <div *ngIf="sanitizedFileURL" style="margin-bottom: 10px;">
                <span   (click)="openImageInNewWindow()" style="color: blue;">{{ fileURL?.name }}</span>
                &nbsp;
                <a (click)="deleteImage()" style="color: red; cursor: pointer;"
                nz-tooltip nzTooltipTitle="Delete Image">
                  <span nz-icon nzType="delete" nzTheme="outline"></span>
                </a>
              </div> -->
              <!-- Display Uploaded Image (After Upload) -->
              <div *ngIf="
                  data.BRAND_IMAGE &&
                  data.BRAND_IMAGE != null &&
                  data.BRAND_IMAGE != undefined &&
                  data.BRAND_IMAGE != ' ' &&
                  data.BRAND_IMAGE != '' &&
                  (fileURL == undefined || fileURL == null || fileURL == '')
                " style="margin-top: 10px">
                <img nz-image [nzSrc]="fullImageUrl" alt="Uploaded Image" style="
                    width: 128px;
                    height: auto;
                    border: 1px solid #ddd;
                    margin-bottom: 10px;
                  " />
              </div>

              <!-- {{imagePreview}} {{fileURL}} -->
              <div *ngIf="
                  fileURL != undefined &&
                  fileURL != null &&
                  fileURL != '' &&
                  fileURL != ' '
                " class="ss" style="align-items: center">
                <!-- <img nz-image [nzSrc]="imagePreview" alt="Preview" style="
                    height: 128px;
                    width: 128px;
                    overflow: auto;
                    /* max-width: 128;
                  max-height: 128; */
                  " /> -->
                <img *ngIf="imagePreview" [src]="imagePreview" alt="Preview"
                  style="height: 128px; width: 128px; border: 1px solid #ccc; object-fit: contain" />

              </div>
            </nz-form-control>
          </nz-form-item>
        </div>

        <div nz-col nzSpan="12">
          <nz-form-item>
            <nz-form-label nzNoColon>Is Popular?</nz-form-label>
            <nz-form-control>
              <nz-switch name="IS_POPULAR" nzCheckedChildren="Yes" nzUnCheckedChildren="No"
                [(ngModel)]="data.IS_POPULAR">
              </nz-switch>
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>
      <div nz-row>
        <div nz-col nzSpan="12">
          <nz-form-item>
            <nz-form-label nzRequired nzNoColon>Status</nz-form-label>
            <nz-form-control nzHasFeedback nzErrorTip="Select Status">
              <nz-switch name="STATUS" nzCheckedChildren="Active" nzUnCheckedChildren="Inactive"
                [(ngModel)]="data.STATUS">
              </nz-switch>
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>
    </nz-spin>
  </form>

  <div class="footer">
    <button type="button" nz-button class="ant-btn" style="margin-right: 8px" (click)="close(brandMasterPage)">
      <span>Cancel</span>
    </button>

    <button type="button" class="ant-btn ant-btn-primary" *ngIf="!data.ID" nz-button [nzLoading]="isSpinning"
      nz-dropdown [nzDropdownMenu]="menu" (click)="save(false, brandMasterPage)">
      <span>Save & Close</span>
    </button>

    <nz-dropdown-menu #menu="nzDropdownMenu">
      <ul nz-menu>
        <li nz-menu-item class="menuc" style="border-radius: 4px; color: white !important">
          <a (click)="save(true, brandMasterPage)" style="color: white !important">Save & New</a>
        </li>
      </ul>
    </nz-dropdown-menu>
    <!-- <button type="button" class="ant-btn ant-btn-primary" *ngIf="!data.ID" nz-button [nzLoading]="isSpinning"
      (click)="save(false, brandMasterPage)">
      <span>Save & Close</span>
    </button> -->

    <button type="button" class="ant-btn ant-btn-primary" *ngIf="data.ID" nz-button [nzLoading]="isSpinning"
      (click)="save(false, brandMasterPage)">
      <span>Update & Close</span>
    </button>
  </div>
  <nz-modal [nzWidth]="900" [(nzVisible)]="ImageModalVisible" nzMaskClosable="false" nzClosable="false"
    [nzContent]="content" [nzTitle]="'Image View'" (nzOnCancel)="ImageModalCancel()" [nzFooter]="ImageModalFooter">
    <ng-template #content>
      <nz-spin [nzSpinning]="isSpinning">
        <div *ngIf="imageshow != undefined && imageshow != null && imageshow != ''" class="ss"
          style="height: 400px; overflow: auto">
          <iframe [src]="imageshow" style="width: 832px; height: 396px" frameborder="0"></iframe>
        </div>
      </nz-spin>
    </ng-template>
    <ng-template #ImageModalFooter>
      <button nz-button nzType="default" (click)="ImageModalCancel()">
        Close
      </button>
    </ng-template>
  </nz-modal>
  <nz-modal [nzWidth]="900" [nzStyle]="{ 'margin-top': '-80px' }" [(nzVisible)]="CropImageModalVisible"
    nzMaskClosable="false" nzClosable="false" [nzContent]="content2" [nzTitle]="'Crop Image'"
    (nzOnCancel)="CropImageModalCancel()" [nzFooter]="CropImageModalFooter">
    <ng-template #content2>
      <nz-spin [nzSpinning]="isSpinningCrop">
        <div *ngIf="
            cropimageshow != undefined &&
            cropimageshow != null &&
            cropimageshow != ''
          " class="ss" style="height: 500px; overflow: scroll">
          <!-- <iframe
      [src]="cropimageshow"
      style="width: 832px; height: 396px"
      frameborder="0"
    ></iframe> -->
          <div *ngIf="croppedImage" style="text-align: center">
            <p>Cropped Image:</p>
            <img [src]="croppedImage" width="165" height="165" />
          </div>
          <nz-divider [ngStyle]="{ width: imageWidth - 900 + 'px' }" nzPlain nzVariant="solid"></nz-divider>
          <image-cropper [imageChangedEvent]="imageChangedEvent" [maintainAspectRatio]="false"
            [cropper]="cropperPosition" format="png" (imageCropped)="imageCropped($event)" [imageQuality]="100"
            (imageLoaded)="imageLoaded($event)" (cropperReady)="cropperReady($event)"
            (loadImageFailed)="loadImageFailed()"></image-cropper>
        </div>
      </nz-spin>
    </ng-template>
    <ng-template #CropImageModalFooter>
      <button nz-button nzType="default" (click)="CropImageModalCancel()">
        Close
      </button>
      <button nz-button nzType="primary" (click)="onFileSelected(imageChangedEvent)">
        Upload
      </button>
    </ng-template>
  </nz-modal>
</div>