<div>
  <form nz-form #TerritoryMappingForm="ngForm">
    <nz-spin [nzSpinning]="isSpinning">
      <div nz-row>
        <div nz-col nzSpan="10">
          <nz-form-item class="tm-form-item-inline">
            <nz-form-label nzNoColon nzRequired>Country</nz-form-label>
            <nz-form-control nzHasFeedback nzErrorTip="Select Country">
              <nz-select name="COUNTRY_ID" nzPlaceHolder="Select Country" nzShowSearch [(ngModel)]="addData.COUNTRY_ID"
                (ngModelChange)="getTeritoryByCountry($event)" nzAllowClear="true" required
                [nzLoading]="countryloading">
                <nz-option *ngFor="let data of countryData" [nzValue]="data.ID" [nzLabel]="data.NAME">
                </nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="11">
          <nz-form-item class="tm-form-item-inline">
            <nz-form-label nzNoColon nzRequired>Territory</nz-form-label>
            <nz-form-control nzHasFeedback nzErrorTip="Select Territory">
              <nz-select name="TERITORY_ID" nzPlaceHolder="Select Territory" nzShowSearch
                [(ngModel)]="addData.TERITORY_ID" nzAllowClear="true" required [nzLoading]="territoryloading"
                nzMode="multiple" [nzMaxTagCount]="2">
                <nz-option *ngFor="let data of territoryData" [nzValue]="data.ID" [nzLabel]="data.NAME">
                </nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="3">
          <nz-form-item class="tm-form-item-inline">
            <nz-form-control>
              <nz-form-label nzNoColon></nz-form-label>
              <button nz-button nzType="primary" (click)="add(TerritoryMappingForm)" [nzLoading]="btnLoading"
                class="tm-add-btn">
                + Add
              </button>
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>
      <hr />
      <div nz-row>
        <div nz-col nzSpan="12"></div>
        <div nz-col nzSpan="12" class="tm-search-container">
          <nz-form-item>
            <nz-input-group nzSearch [nzAddOnAfter]="suffixIconButton" class="tm-search-group">
              <input type="text" name="mapsearch" [(ngModel)]="searchmappeddata" autocomplete="off"
                (keydown.enter)="handleEnterKey($event)" (keydown.backspace)="handleEnterKey($event)" nz-input
                placeholder="Min 3 chars required." class="tm-search-input" />
            </nz-input-group>
            <ng-template #suffixIconButton>
              <button nz-button nzType="primary" id="button" (click)="SearchMappingdata(searchmappeddata)">
                <i nz-icon nzType="search"></i>
              </button>
            </ng-template>
          </nz-form-item>
        </div>
      </div>
    </nz-spin>
  </form>
</div>
<div nz-row>
  <div nz-col nzSpan="24">
    <nz-table class="my-scroll no-wrap1" #table [nzData]="dataList" [nzLoading]="loadingRecords" nzBordered
      [nzSize]="'small'" [nzFrontPagination]="false" (nzQueryParams)="sort($event)">
      <thead>
        <tr>
          <th nzWidth="15px" nzColumnKey="IS_ACTIVE" [nzSortFn]="true" class="tm-th-center-bold">
            Is Mapped ?
          </th>
          <th nzWidth="140px" align="center" nzColumnKey="COUNTRY_NAME" [nzSortFn]="true">
            Country
          </th>
          <th nzWidth="140px" align="center" nzColumnKey="TERRITORY_NAME" [nzSortFn]="true">
            Territory
          </th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let data of table.data">
          <td align="center" class="tm-preline-text">
            <nz-switch nzCheckedChildren="Yes" nzUnCheckedChildren="No" name="IS_ACTIVE" [(ngModel)]="data['IS_ACTIVE']"
              (ngModelChange)="changestatus(data,$event)" tabindex="-1">
            </nz-switch>
          </td>
          <td align="left" tabindex="-1">
            <span *ngIf="data['COUNTRY_NAME'] != null">
              <span *ngIf="data['COUNTRY_NAME'].length >= 35" nz-popover [nzPopoverContent]="data['COUNTRY_NAME']"
                nzPopoverPlacement="topLeft">
                {{
                data["COUNTRY_NAME"] == null
                ? "-"
                : (data["COUNTRY_NAME"] | slice : 0 : 35)
                }}{{ data["COUNTRY_NAME"].length > 35 ? "..." : "" }}
              </span>
              <span *ngIf="data['COUNTRY_NAME'].length < 35">
                {{
                data["COUNTRY_NAME"] == null
                ? "-"
                : (data["COUNTRY_NAME"] | slice : 0 : 35)
                }}
                {{ data["COUNTRY_NAME"].length > 35 ? "..." : "" }}
              </span>
            </span>
            <span *ngIf="data['COUNTRY_NAME'] == null">-</span>
          </td>
          <td align="left" tabindex="-1">
            <span *ngIf="data['TERRITORY_NAME'] != null">
              <span *ngIf="data['TERRITORY_NAME'].length >= 25" nz-popover [nzPopoverContent]="data['TERRITORY_NAME']"
                nzPopoverPlacement="topLeft">
                {{
                data["TERRITORY_NAME"] == null
                ? "-"
                : (data["TERRITORY_NAME"] | slice : 0 : 25)
                }}{{ data["TERRITORY_NAME"].length > 25 ? "..." : "" }}
              </span>
              <span *ngIf="data['TERRITORY_NAME'].length < 25">
                {{
                data["TERRITORY_NAME"] == null
                ? "-"
                : (data["TERRITORY_NAME"] | slice : 0 : 25)
                }}
                {{ data["TERRITORY_NAME"].length > 25 ? "..." : "" }}
              </span>
            </span>
            <span *ngIf="data['TERRITORY_NAME'] == null">-</span>
          </td>
        </tr>
      </tbody>
    </nz-table>
  </div>
</div>
<div class="footer">
  <button type="button" nz-button class="ant-btn tm-footer-cancel-btn" (click)="close()">
    <span>Cancel</span>
  </button>
  <button type="button" nz-button class="ant-btn ant-btn-primary" [nzLoading]="isSpinning" (click)="save()">
    <span>Map & Close</span>
  </button>
</div>