<div nz-row nzGutter="16">
  <div class="gutter-row" nz-col nzSpan="7" class="unique-overflow-auto ">
    <div nz-row class="backbbb">
      <div class="mainnam order-number-col" nz-col nzSpan="12">
        <span class="order-number-badge" [attr.title]="vieworderdata.orderData[0]['ORDER_NUMBER']">
          {{ vieworderdata.orderData[0]["ORDER_NUMBER"] }}
        </span>
      </div>
      <div class="mainnam order-align-end" nz-col nzSpan="12">
        <span class="order-datetime-badge" [attr.title]="
            vieworderdata.orderData[0]['ORDER_DATE_TIME']
              | date : 'dd/MM/yyyy HH:mm a'
          ">
          {{
          vieworderdata.orderData[0]["ORDER_DATE_TIME"]
          | date : "dd/MM/yyyy HH:mm a"
          }}
        </span>
        <span *ngIf="
            vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' &&
            (vieworderdata.orderData[0]['REFUND_STATUS'] == null ||
              vieworderdata.orderData[0]['REFUND_STATUS'] == 'R')
          " (click)="editOrder(vieworderdata.orderData[0])" nz-icon class="order-edit-icon" nzType="edit"
          nzTheme="outline">
        </span>
        <span *ngIf="
            vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' &&
            (vieworderdata.orderData[0]['REFUND_STATUS'] == null ||
              vieworderdata.orderData[0]['REFUND_STATUS'] == 'R')
          " (click)="editOrder(vieworderdata.orderData[0])" class="order-edit-text">
          Edit</span>
      </div>
      <div class="subnam order-subname-container" nz-col nzSpan="24">
        <span *ngIf="vieworderdata.orderData[0].CUSTOMER_TYPE == 'I'" nz-icon nzType="user" nzTheme="outline"
          class="order-customer-icon"></span>
        <svg *ngIf="vieworderdata.orderData[0].CUSTOMER_TYPE == 'B'" enable-background="new 0 0 48 48" height="17px"
          id="Layer_1" version="1.1" viewBox="0 0 48 48" width="17px" xml:space="preserve"
          xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <path clip-rule="evenodd"
            d="M6,47V20c0-2.209,1.791-4,4-4l0,0v-4c0-1.104,0.896-2,2-2h2V2c0-0.552,0.447-1,1-1  s1,0.448,1,1v8h2c1.104,0,2,0.896,2,2v4l0,0l0,0c2.209,0,4,1.791,4,4v8h7v-6h4v-3h6v3h1v25H6z M18,13c0-0.552-0.447-1-1-1h-4  c-0.553,0-1,0.448-1,1v3h6V13z M22,20c0-1.104-0.896-2-2-2H10c-1.104,0-2,0.896-2,2v25h14V20z M31,30h-7v15h7V30z M40,24h-7v21h7V24  z M36,27h1c0.553,0,1,0.447,1,1v1c0,0.553-0.447,1-1,1h-1c-0.553,0-1-0.447-1-1v-1C35,27.447,35.447,27,36,27z M36,33h1  c0.553,0,1,0.447,1,1v1c0,0.553-0.447,1-1,1h-1c-0.553,0-1-0.447-1-1v-1C35,33.447,35.447,33,36,33z M36,39h1c0.553,0,1,0.447,1,1v1  c0,0.553-0.447,1-1,1h-1c-0.553,0-1-0.447-1-1v-1C35,39.447,35.447,39,36,39z M27,33h1c0.553,0,1,0.447,1,1v1c0,0.553-0.447,1-1,1  h-1c-0.553,0-1-0.447-1-1v-1C26,33.447,26.447,33,27,33z M27,39h1c0.553,0,1,0.447,1,1v1c0,0.553-0.447,1-1,1h-1  c-0.553,0-1-0.447-1-1v-1C26,39.447,26.447,39,27,39z M18,42h-1c-0.553,0-1-0.447-1-1v-1c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1  v1C19,41.553,18.553,42,18,42z M18,36h-1c-0.553,0-1-0.447-1-1v-1c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1v1  C19,35.553,18.553,36,18,36z M18,30h-1c-0.553,0-1-0.447-1-1v-1c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1v1  C19,29.553,18.553,30,18,30z M18,24h-1c-0.553,0-1-0.447-1-1v-1c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1v1  C19,23.553,18.553,24,18,24z M13,42h-1c-0.553,0-1-0.447-1-1v-1c0-0.553,0.447-1,1-1h1c0.553,0,1,0.447,1,1v1  C14,41.553,13.553,42,13,42z M13,36h-1c-0.553,0-1-0.447-1-1v-1c0-0.553,0.447-1,1-1h1c0.553,0,1,0.447,1,1v1  C14,35.553,13.553,36,13,36z M13,30h-1c-0.553,0-1-0.447-1-1v-1c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1v1  C14,29.553,13.553,30,13,30z M13,24h-1c-0.553,0-1-0.447-1-1v-1c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1v1  C14,23.553,13.553,24,13,24z"
            fill-rule="evenodd" />
        </svg>
        <span (click)="view(vieworderdata.orderData[0])" [nzTooltipTitle]="
      isTextOverflow ? vieworderdata.orderData[0]['COMPANY_NAME'] : null
    " #tooltipRef11="nzTooltip" nz-tooltip *ngIf="
      vieworderdata.orderData[0].CUSTOMER_TYPE != 'I';
      else elsenameblockss
    " #textContainer11 class="truncate-text" (mouseenter)="checkOverflow(textContainer11, tooltipRef11)">
          {{ vieworderdata.orderData[0].COMPANY_NAME }}
        </span>
        <ng-template #elsenameblockss>
          <span (click)="view(vieworderdata.orderData[0])" #textContainer12 class="truncate-text" [nzTooltipTitle]="
        isTextOverflow
          ? vieworderdata.orderData[0]['CUSTOMER_NAME']
          : null
      " #tooltipRef2="nzTooltip" nz-tooltip (mouseenter)="checkOverflow(textContainer12, tooltipRef2)">
            {{ vieworderdata.orderData[0].CUSTOMER_NAME }}
          </span>
        </ng-template>
      </div>
      <div nz-col nzSpan="24">
        <div nz-row>
          <div nz-col nzSpan="1">
            <span nz-icon nzType="environment" nzTheme="fill"></span>
          </div>
          <div class="subnam subnamhover order-address-text" nz-col nzSpan="23" [attr.title]="
        vieworderdata.orderData[0]['ADDRESS_LINE_1'] +
        ', ' +
        vieworderdata.orderData[0]['ADDRESS_LINE_2'] +
        ' ' +
        vieworderdata.orderData[0]['COUNTRY_NAME'] +
        ', ' +
        vieworderdata.orderData[0]['STATE_NAME'] +
        ', ' +
        vieworderdata.orderData[0]['PINCODE']
      ">
            {{ vieworderdata.orderData[0]["ADDRESS_LINE_1"] }},
            {{ vieworderdata.orderData[0]["ADDRESS_LINE_2"] }}
            {{ vieworderdata.orderData[0]["COUNTRY_NAME"] }},
            {{ vieworderdata.orderData[0]["STATE_NAME"] }},
            {{ vieworderdata.orderData[0]["PINCODE"] }}
          </div>
        </div>
      </div>
      <div class="subnam order-contact-phone" nz-col nzSpan="8">
        <a nzTooltipTitle="Call To Customer" nz-tooltip class="order-call-link"
          href="tel:+{{ vieworderdata.orderData[0]['MOBILE_NO'] }}" target="_blank">
          <span nz-icon nzType="phone" nzTheme="fill" class="order-call-icon">
          </span>
        </a>
        {{ vieworderdata.orderData[0]["MOBILE_NO"] }}
      </div>
      <div class="subnam order-contact-email" nz-col nzSpan="16">
        <a class="order-email-link" href="mailto:{{ vieworderdata.orderData[0]['EMAIL'] }}" target="_blank">
          <span nz-icon nzType="mail" nzTheme="fill" class="order-email-icon" nzTooltipTitle="Mail To Customer"
            nz-tooltip>
          </span>
          {{ vieworderdata.orderData[0]["EMAIL"] }}
        </a>
      </div>
      <div class="subnam order-slot-info" nz-col nzSpan="12">
        <span nzTooltipTitle="Slot time" nz-tooltip class="order-slot-tooltip">
          <span nz-icon nzType="clock-circle" nzTheme="fill" class="order-slot-icon">
          </span>
        </span>
        <ng-container *ngIf="vieworderdata.orderData[0]['SLOTS'] as slot">
          <ng-container *ngIf="slot.includes('Slot 1')">
            Morning ({{ slot.split('(')[1] }}
          </ng-container>
          <ng-container *ngIf="slot.includes('Slot 2')">
            Afternoon ({{ slot.split('(')[1] }}
          </ng-container>
          <ng-container *ngIf="slot.includes('Slot 3')">
            Evening ({{ slot.split('(')[1] }}
          </ng-container>
        </ng-container>
      </div>
      <div class="subnam order-service-date-container" nz-col nzSpan="12">
        <span class="order-service-date-text">
          <span nz-icon nzType="calendar" nzTheme="fill" class="order-service-date-icon" nzTooltipTitle="Service Date"
            nz-tooltip>
          </span>
          {{
          vieworderdata.detailsData[0]['EXPECTED_DATE_TIME']
          | date : 'dd/MMM/yyyy hh:mm a'
          }}
        </span>
      </div>
    </div>
    <div nz-row class="backbbb order-contact-row">
      <div class="order-contact-actions">
        <div>
          <a nzTooltipTitle="Call To Customer" nzTooltipPlacement="top" nz-tooltip
            href="tel:+{{ vieworderdata.orderData[0]['MOBILE_NO'] }}" target="_blank">
            <button nz-button nzType="primary">
              <span nz-icon nzType="phone" nzTheme="fill"></span>Call
            </button>
          </a>
        </div>
        <div>
          <a nzTooltipTitle="Connect To Customer On WhatsApp" nz-tooltip nzTooltipPlacement="top"
            href="https://wa.me/{{ vieworderdata.orderData[0]['MOBILE_NO'] }}" target="_blank">
            <button nz-button nzType="primary">
              <span nz-icon nzType="whats-app" nzTheme="outline"></span>WhatsApp
            </button>
          </a>
        </div>
        <div>
          <a nzTooltipTitle="Mail To Customer" nzTooltipPlacement="top" nz-tooltip
            href="mailto:{{ vieworderdata.orderData[0]['EMAIL'] }}" target="_blank">
            <button nz-button nzType="primary">
              <span nz-icon nzType="mail" nzTheme="fill"></span>Email
            </button>
          </a>
        </div>
      </div>
    </div>
    <div nz-row class="backbbb order-cart-root">
      <div nz-col nzSpan="24" class="mainnam">Order Cart</div>
      <div nz-col nzSpan="24" class="order-cart-scroll">
        <div *ngFor="let cartItem of vieworderdata['detailsData']" class="cardstyle order-cart-card">
          <div nz-row>
            <div nz-col nzSpan="22" class="subname">
              <b>{{ cartItem.CATEGORY_NAME }}</b>
              <b *ngIf="cartItem.SERVICE_PARENT_NAME">
                > {{ cartItem.SERVICE_PARENT_NAME }}
              </b>
              <b>> {{ cartItem.SUB_CATEGORY_NAME }}</b>
            </div>
            <div nz-col nzSpan="2" class="order-cart-image-col">
              <span *ngIf="cartItem.PHOTO_FILE" nz-icon nzType="picture" nzTheme="outline" class="order-cart-image-icon"
                (click)="viewImage(cartItem.PHOTO_FILE)" [nzTooltipTitle]="'View Photo'" nz-tooltip>
              </span>
            </div>
          </div>
          <div nz-row>
            <div nz-col nzSpan="24" class="subname order-service-name" #SERVICE_NAME
              [attr.title]="isTextOverflowing(SERVICE_NAME) ? cartItem.SERVICE_NAME : null">
              {{ cartItem.SERVICE_NAME }}
            </div>
            <div nz-col nzSpan="24" class="order-brand-block" *ngIf="cartItem.BRAND_NAME">
              Brand Name :
              <span class="order-meta-text">{{ cartItem.BRAND_NAME }}</span>
            </div>
            <div nz-col nzSpan="24" *ngIf="cartItem.MODEL_NUMBER">
              Model Number :
              <span class="order-meta-text">{{ cartItem.MODEL_NUMBER }}</span>
            </div>
            <div nz-col nzSpan="24" *ngIf="cartItem.DESCRIPTION">
              Description :
              <span class="truncate-two-lines order-description-text" nz-popover [nzPopoverContent]="descript"
                nzPopoverPlacement="topLeft" [innerHTML]="cartItem['DESCRIPTION']">
              </span>
              <ng-template #descript>
                <span [innerHTML]="cartItem['DESCRIPTION']"></span>
              </ng-template>
            </div>
            <div nz-col nzSpan="11" class="order-time-left">
              Preparation Time :
              {{ formatTime(cartItem.TOTAL_DURARTION_MIN) }}
              <small>Hrs.</small>
            </div>
            <div nz-col nzSpan="13" class="order-time-right">
              Service Time :
              {{ convertDateTiem(cartItem.START_TIME) | date : "HH:mm a" }}
              To
              {{ convertDateTiem(cartItem.END_TIME) | date : "HH:mm a" }}
            </div>
            <div nz-col nzSpan="12">
              <span class="order-price-multiply">
                ₹ {{ cartItem.TAX_EXCLUSIVE_AMOUNT }} x {{ cartItem.QUANTITY }}
              </span>
            </div>
            <div nz-col nzSpan="12" class="order-total-amount">
              ₹ {{ cartItem.TOTAL_TAX_EXCLUSIVE_AMOUNT | number }}
            </div>
            <div nz-col nzSpan="24" class="order-tax-row">
              <small class="order-tax-label">
                <small *ngIf="vieworderdata.orderData[0].IS_SAME_STATE == 1">
                  CGST({{ cartItem.CGST }}%) + SGST({{ cartItem.SGST }}%)
                </small>
                <small *ngIf="vieworderdata.orderData[0].IS_SAME_STATE != 1">
                  IGST ({{ cartItem.IGST }}%)
                </small>
                <small *ngIf="cartItem.CESS">
                  + CESS({{ cartItem.CESS }}%)
                </small>
              </small>
              (+)Tax Amount : ₹ {{ cartItem.TAX_AMOUNT | number }}
            </div>
            <div nz-col nzSpan="12"></div>
            <div nz-col nzSpan="12" class="order-express-col">
              <span class="order-express-badge" *ngIf="cartItem.IS_EXPRESS && vieworderdata.orderData[0].IS_EXPRESS">
                Express
              </span>
            </div>
          </div>
        </div>
      </div>
      <div nz-col nzSpan="24" class="mainnam">Summary</div>
      <div nz-col nzSpan="24">
        <div nz-row class="order-summary-row">
          <div nz-col nzSpan="16" class="order-summary-right">Taxable Amount</div>
          <div nz-col nzSpan="8" class="order-summary-right">
            ₹ {{ vieworderdata.orderData[0].TOTAL_TAXABLE_AMOUNT | number }}
          </div>
          <div nz-col nzSpan="16" class="order-summary-right">(-) Discount</div>
          <div nz-col nzSpan="8" class="order-summary-right">
            ₹ {{ vieworderdata.orderData[0].DISCOUNT_AMOUNT | number }}
          </div>
          <div nz-col nzSpan="16" class="order-summary-right">(+)&nbsp;Express Delivery</div>
          <div nz-col nzSpan="8" class="order-summary-right">
            ₹ {{ vieworderdata.orderData[0].IS_EXPRESS
            ? (vieworderdata.orderData[0].EXPRESS_DELIVERY_CHARGES | number)
            : 0 }}
          </div>
          <div nz-col nzSpan="16" class="order-summary-right">(+)&nbsp;Tax Amount</div>
          <div nz-col nzSpan="8" class="order-summary-right">
            ₹ {{ vieworderdata.orderData[0].TAX_AMOUNT | number }}
          </div>
        </div>
        <div nz-row class="order-summary-total">
          <div nz-col nzSpan="16" class="order-summary-total-label">Order Total</div>
          <div nz-col nzSpan="8" class="order-summary-total-value">
            ₹ {{ vieworderdata.orderData[0].TOTAL_AMOUNT | number }}
          </div>
        </div>
      </div>
      <div nz-col nzSpan="24" class="mainnam">Other Details</div>
      <div nz-col nzSpan="24" class="subnam order-other-text">
        Payment Mode:
        <span class="order-other-strong"
          *ngIf="vieworderdata?.orderData[0]['PAYMENT_MODE'] == 'COD'; else elsepyblocks">
          Cash On Delivery
        </span>
        <ng-template #elsepyblocks>Online</ng-template>
      </div>
      <div nz-col nzSpan="24" class="subnam order-other-text">
        Express Service Taken:
        <span class="order-other-strong">
          {{ vieworderdata.orderData[0]['IS_EXPRESS'] == 1 ? 'Yes' : 'No' }}
        </span>
      </div>
      <div nz-col nzSpan="24" class="subnam order-remark" *ngIf="vieworderdata.orderData[0]['SPECIAL_INSTRUCTIONS']">
        Remark:
        <p class="truncate-two-lines order-remark-text" nz-popover [nzPopoverContent]="descriptspl"
          nzPopoverPlacement="topLeft" [innerHTML]="vieworderdata.orderData[0]['SPECIAL_INSTRUCTIONS']">
        </p>
        <ng-template #descriptspl>
          <span [innerHTML]="vieworderdata.orderData[0]['SPECIAL_INSTRUCTIONS']"></span>
        </ng-template>
      </div>
    </div>
    <div class="footer order-footer-container">
      <nz-tag class="order-status-tag" *ngIf="
          vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' &&
          (vieworderdata.orderData[0]['REFUND_STATUS'] == null ||
            vieworderdata.orderData[0]['REFUND_STATUS'] == 'R')
        " [nzColor]="'#ff9d19'">Order Placed</nz-tag>
      <nz-tag class="order-status-tag" *ngIf="
      vieworderdata.orderData[0]['ORDER_STATUS'] == 'OA' &&
      (vieworderdata.orderData[0]['REFUND_STATUS'] == null ||
        vieworderdata.orderData[0]['REFUND_STATUS'] == 'R')
    " [nzColor]="'#00b778'">
        Order Accepted
      </nz-tag>
      <nz-tag class="order-status-tag" *ngIf="vieworderdata.orderData[0]['ORDER_STATUS'] == 'OR'" [nzColor]="'#e50000'">Order Rejected</nz-tag>
      <nz-tag class="order-status-tag" *ngIf="vieworderdata.orderData[0]['ORDER_STATUS'] == 'OS'" [nzColor]="'#0351ea'">Order Scheduled</nz-tag>
      <nz-tag class="order-status-tag" *ngIf="
          (vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' ||
            vieworderdata.orderData[0]['ORDER_STATUS'] == 'OA') &&
          vieworderdata.orderData[0]['REFUND_STATUS'] == 'P'
        " [nzColor]="'#d10404'">Cancel Requested</nz-tag>
      <nz-tag class="order-status-tag" *ngIf="vieworderdata.orderData[0]['ORDER_STATUS'] == 'ON'" [nzColor]="'#0351ea'">Order Ongoing</nz-tag>
      <nz-tag class="order-status-tag" *ngIf="
          vieworderdata.orderData[0]['ORDER_STATUS'] == 'OC' ||
          vieworderdata.orderData[0]['ORDER_STATUS'] == 'CO'
        " [nzColor]="'#028d00'">Order Completed</nz-tag>
      <nz-tag class="order-status-tag" *ngIf="
      vieworderdata.orderData[0]['ORDER_STATUS'] == 'C' ||
      vieworderdata.orderData[0]['ORDER_STATUS'] == 'CA'
    " [nzColor]="'#f70000'">
        Order Cancelled
      </nz-tag>
      <nz-tag class="order-status-tag" *ngIf="vieworderdata.orderData[0]['ORDER_STATUS'] == 'PC'" [nzColor]="'#f70000'">
        Order Partially Cancelled
      </nz-tag>
    </div>
  </div>
  <div class="gutter-row" nz-col nzSpan="17">
    <div class="backbbb">
      <nz-spin [nzSpinning]="isSpinning">
        <nz-tabset nzCentered (nzSelectedIndexChange)="onSelectedIndexChange($event)">
          <nz-tab [nzTitle]="titleTemplate">
            <ng-template #titleTemplate>
              Verification
              <span *ngIf="vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP'" nz-icon
                class="order-verification-warning-icon" nzType="warning" nzTheme="fill">
              </span>
              <span *ngIf="vieworderdata.orderData[0]['ORDER_STATUS'] != 'OP'" nz-icon
                class="order-verification-success-icon" nzType="check-circle" nzTheme="fill">
              </span>
            </ng-template>
            <ng-template nz-tab>
              <div class="order-tab-scroll">
                <div nz-row *ngIf="
                    vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' &&
                    vieworderdata.orderData[0]['ORDER_STATUS'] != 'C' &&
                    vieworderdata.orderData[0]['ORDER_STATUS'] != 'CA' &&
                    (vieworderdata.orderData[0]['REFUND_STATUS'] == null ||
                      vieworderdata.orderData[0]['REFUND_STATUS'] == 'R') &&
                    decreptedroleId != 2
                  ">
                  <div nz-col nzSpan="24" class="new13">
                    <b>Verify Order</b>
                  </div>
                  <div nz-col nzSpan="24" class="order-radio-wrapper">
                    <nz-radio-group name="checkstatus" [(ngModel)]="STATUS" class="order-radio-group" required>
                      <label nz-radio nzValue="A" class="order-radio-accept">
                        <span class="order-radio-text">Accept</span>
                        <span nz-icon nzType="check-circle" nzTheme="outline" class="order-radio-icon"></span>
                      </label>
                      <label nz-radio nzValue="R" class="order-radio-reject">
                        <span class="order-radio-text">Reject</span>
                        <span nz-icon nzType="close-circle" nzTheme="outline" class="order-radio-icon"></span>
                      </label>
                      <label nz-radio nzValue="Res" class="order-radio-reschedule">
                        <span class="order-radio-text">Reschedule</span>
                        <span nz-icon nzType="schedule" nzTheme="outline" class="order-radio-icon"></span>
                      </label>
                    </nz-radio-group>
                  </div>
                  <div nz-col nzSpan="24" class="order-center-align" *ngIf="STATUS === 'A'">
                    <div nz-row>
                      <div nz-col nzSpan="6"></div>
                      <div nz-col nzSpan="12" class="my-box order-box-padding">
                        <nz-form-item class="nz-form-itemm order-text-left"
                          *ngIf="[2,3,4,5,7,8,20,21,22].includes(+decreptedroleId)">
                          <nz-form-label nzNoColon>
                            Choose a vendor to assign order (optional)
                          </nz-form-label>
                          <nz-form-control nzHasFeedback nzErrorTip="Choose vendor to assign order">
                            <nz-select nzAllowClear nzPlaceHolder="Select vendor to assign order" name="vendors"
                              [(ngModel)]="vendors" nzShowSearch>
                              <nz-option *ngFor="let vendor of vendorsList" [nzValue]="vendor.VENDOR_ID"
                                [nzLabel]="vendor.BUSINESS_NAME">
                              </nz-option>
                            </nz-select>
                          </nz-form-control>
                        </nz-form-item>
                        <nz-form-item class="nz-form-itemm order-text-left">
                          <nz-form-label nzNoColon>Acceptance Remark</nz-form-label>
                          <nz-form-control>
                            <textarea nz-input name="remarks" class="order-textarea-full"
                              [(ngModel)]="orderData.ACCEPTANCE_REMARK" [nzAutosize]="{ minRows: 2, maxRows: 4 }"
                              maxlength="256" placeholder="Please Enter Acceptance Remark" draggable="false" required>
                </textarea>
                            <h6 class="order-remark-count" *ngIf="orderData.ACCEPTANCE_REMARK">
                              {{ orderData.ACCEPTANCE_REMARK.length }}/256
                            </h6>
                          </nz-form-control>
                        </nz-form-item>
                        <button nz-button nzType="primary" class="order-action-btn" (nzOnConfirm)="acceptorder()"
                          [nzOkText]="'Yes'" (nzOnCancel)="deleteCancel()" nz-popconfirm
                          nzPopconfirmTitle="Are you sure, you want to accept order?" nzPopconfirmPlacement="top">
                          <i nz-icon nzType="check"></i>Accept Order
                        </button>
                      </div>
                      <div nz-col nzSpan="6"></div>
                    </div>
                  </div>
                  <div nz-col nzSpan="24" *ngIf="STATUS === 'R' || STATUS === 'Res'">
                    <div nz-row>
                      <div nz-col nzSpan="6"></div>
                      <div nz-col nzSpan="12" class="my-box job-action-box">
                        <div nz-row>
                          <div nz-col nzSpan="24" *ngIf="STATUS === 'R'">
                            <nz-form-item class="nz-form-itemm">
                              <nz-form-label nzRequired nzNoColon>Reject Remark</nz-form-label>
                              <nz-form-control nzHasFeedback nzErrorTip="Please Enter Rejection Remark">
                                <textarea name="remark" nz-input [(ngModel)]="orderData.REMARK"
                                  [nzAutosize]="{ minRows: 2, maxRows: 4 }" maxlength="256"
                                  placeholder="Please Enter Rejection Remark" draggable="false" required
                                  class="job-textarea-full">
          </textarea>
                                <h6 class="job-char-counter-small" *ngIf="
              orderData.REMARK != undefined &&
              orderData.REMARK != null &&
              orderData.REMARK != ''
            ">
                                  {{ orderData.REMARK.length }}/256
                                </h6>
                              </nz-form-control>
                            </nz-form-item>
                          </div>
                          <div nz-col nzSpan="24" *ngIf="STATUS === 'Res'">
                            <div class="job-reschedule-title">
                              Reschedule Order
                            </div>
                            <div nz-row>
                              <div nz-col nzSpan="10">
                                <nz-form-item class="nz-form-itemm">
                                  <nz-form-label nzRequired nzNoColon>Schedule Datetime</nz-form-label>
                                  <nz-form-control>
                                    <nz-date-picker (ngModelChange)="setDate($event)" [(ngModel)]="expectedDate"
                                      nzFormat="dd/MM/yyyy" [nzShowToday]="false" [nzDisabledDate]="disabledPastDates"
                                      name="expectedDate" class="job-input-full">
                                    </nz-date-picker>
                                  </nz-form-control>
                                </nz-form-item>
                              </div>
                              <div nz-col nzSpan="8">
                                <nz-form-item class="nz-form-itemm">
                                  <nz-form-label nzNoColon></nz-form-label>
                                  <nz-form-control class="job-timepicker-wrapper">
                                    <nz-time-picker [(ngModel)]="time" name="time" nzFormat="HH:mm a"
                                      [nzMinuteStep]="10" (ngModelChange)="setTime($event)" [nzAllowEmpty]="false"
                                      [nzDisabledHours]="getDisabledHours" [nzDisabledMinutes]="getDisabledMinutes"
                                      class="job-input-full">
                                    </nz-time-picker>
                                  </nz-form-control>
                                </nz-form-item>
                              </div>
                            </div>
                          </div>
                          <div nz-col nzSpan="24" class="job-action-footer">
                            <button nz-button *ngIf="STATUS === 'R'" nzType="primary" class="job-action-button"
                              (nzOnConfirm)="acceptorder()" [nzOkText]="'Yes'" (nzOnCancel)="deleteCancel()"
                              nz-popconfirm nzPopconfirmTitle="Are you sure, you want to reject order?"
                              nzPopconfirmPlacement="top">
                              Reject Order
                            </button>
                            <button nz-button nzType="primary" class="job-action-button" (nzOnConfirm)="acceptorder()"
                              [nzOkText]="'Yes'" (nzOnCancel)="deleteCancel()" nz-popconfirm
                              nzPopconfirmTitle="Are you sure, you want to reschedule order?"
                              nzPopconfirmPlacement="top" *ngIf="STATUS === 'Res'">
                              <i nz-icon nzType="calendar"></i>
                              Reschedule Order
                            </button>
                          </div>
                        </div>
                      </div>
                      <div nz-col nzSpan="6"></div>
                    </div>
                  </div>
                </div>
                <div *ngIf="
                    vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' &&
                    vieworderdata.orderData[0]['ORDER_STATUS'] != 'C' &&
                    vieworderdata.orderData[0]['ORDER_STATUS'] != 'CA' &&
                    decreptedroleId == 2
                  " class="
                   order-ver-status
                  ">
                  Order Verification Is Pending.
                </div>
                <div *ngIf="
                    (vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' ||
                      vieworderdata.orderData[0]['ORDER_STATUS'] == 'OA') &&
                    vieworderdata.orderData[0]['ORDER_STATUS'] != 'C' &&
                    vieworderdata.orderData[0]['ORDER_STATUS'] != 'CA' &&
                    vieworderdata.orderData[0]['REFUND_STATUS'] == 'P'
                  " class="order-state-warning">
                  The cancellation request is under verification.
                </div>
                <div *ngIf="
                    vieworderdata.orderData[0]['ORDER_STATUS'] != 'OP' &&
                    vieworderdata.orderData[0]['ORDER_STATUS'] != 'OR' &&
                    vieworderdata.orderData[0]['ORDER_STATUS'] != 'C' &&
                    vieworderdata.orderData[0]['ORDER_STATUS'] != 'CA' &&
                    (vieworderdata.orderData[0]['REFUND_STATUS'] == null ||
                      vieworderdata.orderData[0]['REFUND_STATUS'] == 'R')
                  " class="order-state-success">
                  Order Accepted
                </div>
                <div *ngIf="vieworderdata.orderData[0]['ORDER_STATUS'] == 'OR'" class="order-state-error">
                  Order Rejected
                </div>
                <div *ngIf="
        vieworderdata.orderData[0]['ORDER_STATUS'] == 'C' ||
        vieworderdata.orderData[0]['ORDER_STATUS'] == 'CA'
      " class="order-state-error">
                  Order Cancelled
                </div>
              </div>
            </ng-template>
          </nz-tab>
          <nz-tab (nzSelect)="getJobs()" [nzDisabled]="
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OR' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'C' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'CA' ||
              (vieworderdata.orderData[0]['ORDER_STATUS'] == 'OA' &&
                vieworderdata.orderData[0]['REFUND_STATUS'] == 'P')
            " [nzTitle]="'Jobs'">
            <ng-template nz-tab>
              <div class="job-tab-scroll">
                <div nz-row nzGutter="16">
                  <div nz-col nzSpan="12" class="job-card-wrapper" *ngFor="let data of orderDetailsData; let i = index">
                    <div class="cardstyle1 job-card-root" nz-row>
                      <div class="mainnam job-align-start" nz-col nzSpan="10">
                        <span class="job-order-badge" [attr.title]="vieworderdata.orderData[0].ORDER_NUMBER">
                          {{ vieworderdata.orderData[0].ORDER_NUMBER }}</span>
                      </div>
                      <div nz-col nzSpan="4" class="job-align-center">
                        <nz-tag *ngIf="data.JOB_CART_STATUS == 'CN'" [nzColor]="'red'">
                          {{ data.JOB_CARD_STATUS_NAME }}
                        </nz-tag>
                      </div>
                      <div class="mainnam job-align-end" nz-col nzSpan="10">
                        <span *ngIf="data.JOB_CARD_NO" (click)="openjobcarddetails(data)" class="job-jobcard-badge"
                          [attr.title]="data.JOB_CARD_NO">
                          {{ data.JOB_CARD_NO }}
                        </span>
                      </div>
                      <div class="subnam job-customer-row" nz-col nzSpan="16">
                        <span *ngIf="
                            vieworderdata.orderData[0].CUSTOMER_TYPE == 'I'
                          " nz-icon nzType="user" nzTheme="outline"></span>
                        <svg *ngIf="
                            vieworderdata.orderData[0].CUSTOMER_TYPE != 'I'
                          " enable-background="new 0 0 55 55" height="17px" id="Layer_1" version="1.1"
                          viewBox="0 0 55 55" width="17px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg"
                          xmlns:xlink="http://www.w3.org/1999/xlink">
                          <path clip-rule="evenodd"
                            d="M6,47V20c0-2.209,1.791-4,4-4l0,0v-4c0-1.104,0.896-2,2-2h2V2c0-0.552,0.447-1,1-1  s1,0.448,1,1v8h2c1.104,0,2,0.896,2,2v4l0,0l0,0c2.209,0,4,1.791,4,4v8h7v-6h4v-3h6v3h1v25H6z M18,13c0-0.552-0.447-1-1-1h-4  c-0.553,0-1,0.448-1,1v3h6V13z M22,20c0-1.104-0.896-2-2-2H10c-1.104,0-2,0.896-2,2v25h14V20z M31,30h-7v15h7V30z M40,24h-7v21h7V24  z M36,27h1c0.553,0,1,0.447,1,1v1c0,0.553-0.447,1-1,1h-1c-0.553,0-1-0.447-1-1v-1C35,27.447,35.447,27,36,27z M36,33h1  c0.553,0,1,0.447,1,1v1c0,0.553-0.447,1-1,1h-1c-0.553,0-1-0.447-1-1v-1C35,33.447,35.447,33,36,33z M36,39h1c0.553,0,1,0.447,1,1v1  c0,0.553-0.447,1-1,1h-1c-0.553,0-1-0.447-1-1v-1C35,39.447,35.447,39,36,39z M27,33h1c0.553,0,1,0.447,1,1v1c0,0.553-0.447,1-1,1  h-1c-0.553,0-1-0.447-1-1v-1C26,33.447,26.447,33,27,33z M27,39h1c0.553,0,1,0.447,1,1v1c0,0.553-0.447,1-1,1h-1  c-0.553,0-1-0.447-1-1v-1C26,39.447,26.447,39,27,39z M18,42h-1c-0.553,0-1-0.447-1-1v-1c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1  v1C19,41.553,18.553,42,18,42z M18,36h-1c-0.553,0-1-0.447-1-1v-1c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1v1  C19,35.553,18.553,36,18,36z M18,30h-1c-0.553,0-1-0.447-1-1v-1c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1v1  C19,29.553,18.553,30,18,30z M18,24h-1c-0.553,0-1-0.447-1-1v-1c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1v1  C19,23.553,18.553,24,18,24z M13,42h-1c-0.553,0-1-0.447-1-1v-1c0-0.553,0.447-1,1-1h1c0.553,0,1,0.447,1,1v1  C14,41.553,13.553,42,13,42z M13,36h-1c-0.553,0-1-0.447-1-1v-1c0-0.553,0.447-1,1-1h1c0.553,0,1,0.447,1,1v1  C14,35.553,13.553,36,13,36z M13,30h-1c-0.553,0-1-0.447-1-1v-1c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1v1  C14,29.553,13.553,30,13,30z M13,24h-1c-0.553,0-1-0.447-1-1v-1c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1v1  C14,23.553,13.553,24,13,24z"
                            fill-rule="evenodd" />
                        </svg>&nbsp;
                        <span [nzTooltipTitle]="
                            isTextOverflow
                              ? vieworderdata.orderData[0]['COMPANY_NAME']
                              : null
                          " #tooltipRef1="nzTooltip" nz-tooltip *ngIf="
                            vieworderdata.orderData[0].CUSTOMER_TYPE != 'I';
                            else elsenameblockss
                          " #textContainer class="truncate-text" (mouseenter)="
                            checkOverflow(textContainer, tooltipRef1)
                          ">{{ vieworderdata.orderData[0].COMPANY_NAME }}</span>
                        <ng-template #elsenameblockss>
                          <span #textContainer1 class="truncate-text" [nzTooltipTitle]="
                              isTextOverflow
                                ? vieworderdata.orderData[0]['CUSTOMER_NAME']
                                : null
                            " #tooltipRef="nzTooltip" nz-tooltip (mouseenter)="
                              checkOverflow(textContainer1, tooltipRef)
                            ">{{
                            vieworderdata.orderData[0].CUSTOMER_NAME
                            }}</span>
                        </ng-template>
                      </div>
                      <div class="subnam job-amount-text" nz-col nzSpan="8">
                        ₹ {{ data.FINAL_ITEM_AMOUNT | number }}
                      </div>
                      <div nz-col nzSpan="16">
                        <div nz-row>
                          <div class="subnam service-address-container" nz-col nzSpan="23">
                            <span class="subnam service-address-text"
                              *ngIf="vieworderdata.orderData[0]['SERVICE_ADDRESS'] != null">
                              <span nz-icon nzType="environment" nzTheme="fill"></span>
                              <span class="service-address-text" *ngIf="
                                  vieworderdata.orderData[0]['SERVICE_ADDRESS']
                                    .length >= 40
                                " nz-popover [nzPopoverContent]="
                                  vieworderdata.orderData[0]['SERVICE_ADDRESS']
                                " nzPopoverPlacement="topLeft">
                                {{
                                vieworderdata.orderData[0][
                                "SERVICE_ADDRESS"
                                ] == null
                                ? "-"
                                : (vieworderdata.orderData[0][
                                "SERVICE_ADDRESS"
                                ] | slice : 0 : 40)
                                }}{{
                                vieworderdata.orderData[0]["SERVICE_ADDRESS"]
                                .length > 40
                                ? "..."
                                : ""
                                }}
                              </span>
                              <span class="service-address-text" *ngIf="
                                  vieworderdata.orderData[0]['SERVICE_ADDRESS']
                                    .length < 40
                                ">
                                {{
                                vieworderdata.orderData[0][
                                "SERVICE_ADDRESS"
                                ] == null
                                ? "-"
                                : (vieworderdata.orderData[0][
                                "SERVICE_ADDRESS"
                                ] | slice : 0 : 40)
                                }}
                                {{
                                vieworderdata.orderData[0]["SERVICE_ADDRESS"]
                                .length > 40
                                ? "..."
                                : ""
                                }}
                              </span>
                            </span>
                            <span *ngIf="
                                vieworderdata.orderData[0]['SERVICE_ADDRESS'] ==
                                null
                              ">-</span>
                          </div>
                        </div>
                      </div>
                      <div class="subnam job-express-container" nz-col nzSpan="8">
                        <span class="job-express-text" *ngIf="data.IS_EXPRESS == 1">
                          Express | ₹{{ data.EXPRESS_DELIVERY_CHARGES | number }}
                        </span>
                      </div>
                      <div class="subnam job-pincode-container truncate-text" nz-col nzSpan="12"
                        [nzTooltipTitle]="isTextOverflow ? vieworderdata.orderData[0].PINCODE : null"
                        #tooltipRefpin="nzTooltip" nz-tooltip #textContainerpinn
                        (mouseenter)="checkOverflow(textContainerpinn, tooltipRefpin)">
                        Pincode :{{ vieworderdata.orderData[0].PINCODE }}
                      </div>
                      <div class="subnam job-territory-container truncate-text" nz-col nzSpan="12"
                        [nzTooltipTitle]="isTextOverflow ? vieworderdata.orderData[0].TERRITORY_NAME : null"
                        #tooltipRefter="nzTooltip" nz-tooltip #textContainerpinn
                        (mouseenter)="checkOverflow(textContainerpinn, tooltipRefter)">
                        Territory :{{ vieworderdata.orderData[0].TERRITORY_NAME }}
                      </div>
                      <div class="subnam job-service-container truncate-text" nz-col nzSpan="24"
                        [nzTooltipTitle]="
                          isTextOverflow ? data.SERVICE_NAME : null
                        " #tooltipRefser="nzTooltip" nz-tooltip #textContainerpinn (mouseenter)="
                          checkOverflow(textContainerpinn, tooltipRefser)
                        ">
                        Service :{{ data.SERVICE_NAME }}
                      </div>
                      <div class="subnam job-schedule-container" nz-col nzSpan="14">
                        <span class="job-schedule-text" *ngIf="
                            data.SCHEDULED_DATE_TIME != undefined &&
                            data.SCHEDULED_DATE_TIME != null
                          ">
                          Scheduled Date:
                          {{ data.SCHEDULED_DATE_TIME | date : 'dd/MM/yyyy' }}
                          &nbsp;{{ formatTimess(data.START_TIME) }}
                        </span>
                        <button nz-button nzSize="small" nzType="primary" class="job-schedule-btn" *ngIf="
                            decreptedroleId !== 2 &&
                            TYPE_FOR_LOCAL != 'CUSTOMER' &&
                            data.JOB_CARD_ID != undefined &&
                            data.JOB_CARD_ID != null &&
                            data.JOB_CARD_ID != 0 &&
                            (data.SCHEDULED_DATE_TIME == undefined ||
                              data.SCHEDULED_DATE_TIME == null)
                          " (click)="ScheduleJob(data)">
                          Go To Scheduler
                        </button>
                      </div>
                      <div class="subnam job-estimate-container" nz-col nzSpan="10">
                        <span class="job-estimate-text" *ngIf="
                            data.ESTIMATED_TIME_IN_MIN != undefined &&
                            data.ESTIMATED_TIME_IN_MIN != null
                          ">
                          Estimated Time:
                          {{ data.ESTIMATED_TIME_IN_MIN }} min.
                        </span>
                      </div>
                      <div class="subnam job-empty-left" nz-col nzSpan="8">
                      </div>
                      <div nz-col nzSpan="8" class="job-center-action">
                        <button nz-button nzType="primary" *ngIf="
                            decreptedroleId !== 2 &&
                            TYPE_FOR_LOCAL != 'CUSTOMER' &&
                            (data.JOB_CARD_ID == undefined ||
                              data.JOB_CARD_ID == null ||
                              data.JOB_CARD_ID == 0)
                          " (click)="openmodelll(data, i)">
                          Generate Job
                        </button>
                      </div>
                      <div class="subnam job-empty-right" nz-col nzSpan="8">
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </ng-template>
          </nz-tab>
          <nz-tab [nzTitle]="'Parts Request'" (nzSelect)="getParts()" [nzDisabled]="
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OR' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'C' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'CA' ||
              (vieworderdata.orderData[0]['ORDER_STATUS'] == 'OA' &&
                vieworderdata.orderData[0]['REFUND_STATUS'] == 'P')
            ">
            <ng-template nz-tab>
              <div class="parts-tab-scroll">
                <div nz-row nzGutter="16" *ngIf="parts != undefined && parts.length > 0">
                  <div nz-col nzSpan="12" class="parts-card-wrapper" *ngFor="let part of parts; let l = index">
                    <div class="cardstyle1 parts-card-root" nz-row>
                      <div class="mainnam parts-align-start" nz-col nzSpan="12" #patJOB_CARD_NO [attr.title]="
                          isTextOverflowing(patJOB_CARD_NO)
                            ? part.JOB_CARD_NO
                            : null
                        ">
                        <span *ngIf="
                            part.JOB_CARD_NO != undefined &&
                            part.JOB_CARD_NO != null
                          "class="parts-jobcard-badge
                          " [attr.title]="part.JOB_CARD_NO">
                          {{ part.JOB_CARD_NO }}</span>
                      </div>
                      <div class="subnam parts-align-end" nz-col nzSpan="12">
                        <span class="parts-date-text">
                          {{
                          part.REQUESTED_DATE_TIME
                          | date : "dd/MM/yyyy HH:mm a"
                          }}
                        </span>
                      </div>
                      <div *ngIf="part.INVENTORY_ID > 0" class="subnam" nz-col nzSpan="24" #partINVENTORY_CATEGORY_NAME
                        [attr.title]="
                          isTextOverflowing(partINVENTORY_CATEGORY_NAME)
                            ? part.INVENTORY_CATEGORY_NAME +
                              '>' +
                              part.INVENTRY_SUB_CATEGORY_NAME
                            : null
                        ">
                        <span class="parts-meta-text">
                          {{ part.INVENTORY_CATEGORY_NAME }} >
                          {{ part.INVENTRY_SUB_CATEGORY_NAME }}
                        </span>
                      </div>
                      <div class="subnam parts-item-name" nz-col nzSpan="24" #ITEM_NAME [attr.title]="
                          isTextOverflowing(ITEM_NAME) ? part.ITEM_NAME : null
                        ">
                        Part Name :
                        {{
                        part.INVENTORY_ID > 0
                        ? part.ITEM_NAME
                        : part.INVENTORY_NAME
                        }}
                      </div>
                      <div class="subnam parts-meta-row" nz-col nzSpan="24">
                        Requested By : {{ part.TECHNICIAN_NAME }}
                      </div>
                      <div class="subnam parts-meta-row" nz-col nzSpan="8">
                        Price : ₹ {{ part.TOTAL_AMOUNT | number }}
                      </div>
                      <div class="subnam parts-meta-row" nz-col nzSpan="7">
                        Quantity : {{ part.QUANTITY }}
                      </div>
                      <div class="subnam parts-status-col" nz-col nzSpan="9">
                        <nz-tag class="parts-status-tag" *ngIf="part['STATUS'] == 'P'" [nzColor]="'#ff9d19'">Pending</nz-tag>
                        <nz-tag class="parts-status-tag" *ngIf="part['STATUS'] == 'A'" [nzColor]="'green'">Approved</nz-tag>
                        <nz-tag class="parts-status-tag" *ngIf="part['STATUS'] == 'AC'" [nzColor]="'green'">Approved By Customer</nz-tag>
                        <nz-tag class="parts-status-tag" *ngIf="part['STATUS'] == 'AP'" [nzColor]="'green'">Auto Approved</nz-tag>
                        <nz-tag class="parts-status-tag" *ngIf="part['STATUS'] == 'R'" [nzColor]="'red'">Rejected</nz-tag>                       
                      </div>
                    </div>
                  </div>
                </div>
                <div *ngIf="parts == undefined || parts.length == 0">
                  <nz-empty class="parts-empty-state"
                    nzNotFoundImage="https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg"
                    [nzNotFoundContent]="contentTpl">
                    <ng-template #contentTpl>
                      <span> No Parts Request Available. </span>
                    </ng-template>
                  </nz-empty>
                </div>
              </div>
            </ng-template>
          </nz-tab>
          <nz-tab (nzSelect)="setFilter()" [nzTitle]="'Action/Activity Log'">
            <ng-template nz-tab>
              <div class="common-tab-scroll">
                <app-actionlogs [TYPE]="'ORDER'" [FILTER_ID]="orderDetails.ID"
                  [CUSTOMER_ID]="vieworderdata.orderData[0].CUSTOMER_ID"></app-actionlogs>
              </div>
            </ng-template>
          </nz-tab>
          <nz-tab (nzSelect)="setFilter()" [nzDisabled]="
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OR' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'C' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'CA'
            " [nzTitle]="'Customer Ratings for Technicians'">
            <ng-template nz-tab>
              <div class="common-tab-scroll">
                <app-customerratting [TYPE]="'ORDER'" [customer_id]="vieworderdata.orderData[0].CUSTOMER_ID"
                  [FILTER_ID]="orderDetails.ID"></app-customerratting>
              </div>
            </ng-template>
          </nz-tab>
          <nz-tab (nzSelect)="setFilter()" [nzDisabled]="
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OR' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'C' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'CA'
            " [nzTitle]="'Technician Ratings for Customers'">
            <ng-template nz-tab>
              <div class="common-tab-scroll">
                <app-technicianratting [TYPE]="'ORDER'" [FILTER_ID]="orderDetails.ID"
                  [customer_id]="vieworderdata.orderData[0].CUSTOMER_ID"></app-technicianratting>
              </div>
            </ng-template>
          </nz-tab>
          <nz-tab (nzSelect)="setFilter()" [nzDisabled]="
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OR' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'C' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'CA'
            " [nzTitle]="'Chat'">
            <ng-template nz-tab>
              <div class="order-common-tab-scroll">
                <app-chatoverview-comp [TYPE]="'ORDER'" [FILTER_ID]="orderDetails.ID"></app-chatoverview-comp>
              </div>
            </ng-template>
          </nz-tab>
          <nz-tab (nzSelect)="setFilter()" [nzTitle]="'Order Location'">
            <ng-template nz-tab>
              <div class="order-common-tab-scroll">
                <app-location [TYPE]="'ORDER'" [FILTER_ID]="orderDetails.ID"></app-location>
              </div>
            </ng-template>
          </nz-tab>
          <nz-tab (nzSelect)="setFilter()" [nzDisabled]="
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OR' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'C' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'CA'
            " [nzTitle]="'Technician Travel History'">
            <ng-template nz-tab>
              <div class="order-common-tab-scroll">
                <app-technicianlocationsmap [TYPE]="'ORDER'" [FILTER_ID]="orderDetails.ID"></app-technicianlocationsmap>
              </div>
            </ng-template>
          </nz-tab>
          <nz-tab (nzSelect)="setFilter()" [nzDisabled]="
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OR' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'C' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'CA'
            " [nzTitle]="'Technician Locations'">
            <ng-template nz-tab>
              <div class="order-common-tab-scroll">
                <app-multiplelocationpage [TYPE]="'ORDER'" [FILTER_ID]="orderDetails.ID"></app-multiplelocationpage>
              </div>
            </ng-template>
          </nz-tab>
          <nz-tab (nzSelect)="setFilter()" [nzDisabled]="
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OR' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'C' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'CA'
            " [nzTitle]="'Invoices'">
            <ng-template nz-tab>
              <div class="order-common-tab-scroll">
                <app-invoicepage [TYPE]="'ORDER'" [FILTER_ID]="orderDetails.ID"></app-invoicepage>
              </div>
            </ng-template>
          </nz-tab>
        </nz-tabset>
      </nz-spin>
    </div>
  </div>
</div>
<div *ngIf="drawerVisiblepastorder">
  <nz-drawer [nzBodyStyle]="{
      height: 'calc(100% - 55px)',
      overflow: 'auto',
      'padding-bottom': '53px'
    }" [nzClosable]="true" [nzMask]="true" [nzMaskClosable]="false" [nzWidth]="600"
    [nzVisible]="drawerVisiblepastorder" [nzTitle]="drawerTitlepastorder" (nzOnClose)="drawerClosepastorder()"
    (nzKeyboard)="(true)">
    <ng-container *nzDrawerContent>
      <app-view-past-order-drawer [drawerClosepastorder]="closeCallbackpastorder"
        [drawerVisiblepastorder]="drawerVisiblepastorder" [data]="drawerDatapastorder">
      </app-view-past-order-drawer>
    </ng-container>
  </nz-drawer>
</div>
<nz-modal [nzWidth]="900" [(nzVisible)]="ImageModalVisible" nzMaskClosable="false" nzClosable="false"
  [nzContent]="content" [nzTitle]="'Image View'" (nzOnCancel)="ImageModalCancel()" [nzFooter]="ImageModalFooter">
  <ng-template #content>
    <nz-spin [nzSpinning]="isSpinning">
      <div *ngIf="imageshow != undefined && imageshow != null && imageshow != ''" class="ss image-preview-container">
        <div class="controls">
          <button nz-button nzType="primary" nzShape="circle" (click)="zoomIn()">
            <i nz-icon nzType="zoom-in"></i>
          </button>
          <button nz-button nzType="primary" nzShape="circle" (click)="zoomOut()">
            <i nz-icon nzType="zoom-out"></i>
          </button>
          <button nz-button nzType="primary" nzShape="circle" (click)="rotateLeft()">
            <i nz-icon nzType="rotate-left"></i>
          </button>
          <button nz-button nzType="primary" nzShape="circle" (click)="rotateRight()">
            <i nz-icon nzType="rotate-right"></i>
          </button>
          <button nz-button nzType="default" nzShape="circle" (click)="reset()">
            <i nz-icon nzType="reload"></i>
          </button>
        </div>
        <div class="image-container">
          <img [src]="imageshow" [style.transform]="'scale(' + zoomLevel + ') rotate(' + rotation + 'deg)'"
            alt="Zoomable Image" />
        </div>
      </div>
    </nz-spin>
  </ng-template>
  <ng-template #ImageModalFooter>
    <button nz-button nzType="default" (click)="ImageModalCancel()">
      Close
    </button>
  </ng-template>
</nz-modal>
<nz-modal [(nzVisible)]="openModal" nzCentered="true" [nzBodyStyle]="{ padding: '16px' }" nzWidth="570px"
  nzClosable="false" [nzFooter]="contextofrules" nzMaskClosable="false">
  <ng-container *nzModalContent>
    <h5 class="job-modal-title">Generate Job</h5>
    <hr class="job-modal-divider" />
    <p class="job-modal-description"></p>
    <div nz-row>
      <div nz-col nzSpan="24">
        <nz-form-item class="nz-form-itemm">
          <nz-form-label nzNoColon>Additional Remark</nz-form-label>
          <nz-form-control nzHasFeedback>
            <textarea nz-input [(ngModel)]="jobdetails" name="jobdetails" rows="3" maxlength="512"
              (focus)="checkLength()" (blur)="checkLength()" placeholder="Enter Additional Remark"
              class="job-textarea-full"></textarea>
          </nz-form-control>
          <span class="job-char-counter" *ngIf="jobdetails && showerror">{{ jobdetails.length }}/512</span>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="24" *ngIf="
          selectService['SERVICE_SKILLS'] == undefined ||
          selectService['SERVICE_SKILLS'] == null ||
          selectService['SERVICE_SKILLS'] == ''
        ">
        <nz-form-item class="nz-form-itemm">
          <nz-form-label nzRequired nzNoColon>Skills</nz-form-label>
          <nz-form-control nzHasFeedback nzErrorTip="Select Skills">
            <nz-select nzAllowClear="true" nzPlaceHolder="Select Skills" name="skills" [(ngModel)]="skills" nzShowSearch
              required nzMode="multiple">
              <nz-option *ngFor="let skill of skillsList" [nzValue]="skill.NAME" [nzLabel]="skill.NAME"></nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="12">
        <nz-form-item class="nz-form-itemm">
          <nz-form-label nzNoColon nzRequired>Estimation Time</nz-form-label>
          <nz-form-control nzErrorTip="Enter Estimation Time">
            <nz-input-group [nzAddOnAfter]="'mins'" class="job-inputgroup-full">
              <input nz-input name="DURATION" placeholder="Enter Estimation Time" required autocomplete="off"
                [(ngModel)]="estimatetime" #nameField="ngModel" (keypress)="commonFunction.onlynum($event)"
                class="job-input-full" />
            </nz-input-group>
          </nz-form-control>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="12">
        <nz-form-item class="nz-form-itemm">
          <nz-form-label nzNoColon nzRequired>Is It Remote Job?</nz-form-label>
          <nz-form-control>
            <nz-switch name="RemoteJob" nzCheckedChildren="Yes" nzUnCheckedChildren="No" [(ngModel)]="remoteJob">
            </nz-switch>
          </nz-form-control>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="24">
        <small class="job-validation-note">
          *only numbers multiples of 10 (e.g. 10, 20, 30,...) are
          allowed.</small>
      </div>
    </div>
  </ng-container>
  <ng-template #contextofrules>
    <button nz-button [nzLoading]="isSpinning" nzType="primary" class="btn btn-primary" (nzOnConfirm)="createJob()"
      [nzOkText]="'Yes'" (nzOnCancel)="deleteCancel()" nz-popconfirm
      nzPopconfirmTitle="Are you sure, you want to generate job?" nzPopconfirmPlacement="top">
      Save & Close
    </button>
    <button nz-button [nzLoading]="isSpinning" nzType="default" class="btn btn-primary" (click)="closemodelll()">
      Cancel
    </button>
  </ng-template>
</nz-modal>
<div *ngIf="jobdetailsshow">
  <nz-drawer [nzBodyStyle]="{
      height: 'calc(100% - 55px)',
      overflow: 'auto',
      padding: '10px',
    }" [nzClosable]="true" [nzMask]="true" [nzMaskClosable]="false" [nzWidth]="drawersize" [nzVisible]="jobdetailsshow"
    [nzTitle]="jobdetaildrawerTitle" (nzOnClose)="jobdetailsdrawerClose()" (nzKeyboard)="(true)">
    <ng-container *nzDrawerContent>
      <app-detailsjob [drawerClose]="jobdetailscloseCallback" [jobdetailsdata]="jobdetailsdata"
        [invoicefilter]="invoicefilter">
      </app-detailsjob>
    </ng-container>
  </nz-drawer>
</div>
<div *ngIf="drawerVisibleCustomers">
  <nz-drawer [nzBodyStyle]="{
      height: 'calc(100% - 55px)',
      overflow: 'auto',
      'padding-bottom': '53px'
    }" [nzClosable]="true" [nzMask]="true" [nzMaskClosable]="true" [nzWidth]="widths"
    [nzVisible]="drawerVisibleCustomers" [nzTitle]="drawerTitleCustomers" (nzOnClose)="drawerCloseCustomers()"
    (nzKeyboard)="(true)">
    <ng-container *nzDrawerContent>
      <app-customer-overview-list [drawerClose]="closeCallbackCustomers" [drawerVisible]="drawerVisibleCustomers"
        [data]="drawerDataCustomers" [custid]="custid">
      </app-customer-overview-list>
    </ng-container>
  </nz-drawer>
</div>
<div *ngIf="ordercreateVisible">
  <nz-drawer [nzBodyStyle]="{
      height: 'calc(100% - 55px)',
      overflow: 'auto',
      padding: '10px'
    }" [nzClosable]="true" [nzMask]="true" [nzMaskClosable]="false" [nzWidth]="'100%'" [nzVisible]="ordercreateVisible"
    [nzTitle]="'Create Order'" (nzOnClose)="drawerCloseorder()" (nzKeyboard)="(true)">
    <ng-container *nzDrawerContent>
      <app-ordercreatedrawer [drawerCloseorder]="closeCallbackorder" [data]="vieworderdata.orderData[0]" [type]="type"
        [tableData]="vieworderdata['detailsData']" [addresses]="addresses" [terriotrystarttime1]="terriotrystarttime1"
        [terriotryendtime1]="terriotryendtime1" [expectedDate]="expectedDate" [time]="time"
        [TERRITORY_IDS]="TERRITORY_IDS" [decreptedroleId]="decreptedroleId" [isTerritoryExpress]="isTerritoryExpress"
        [expandedKeys]="expandedKeys" [selectedKeys]="selectedKeys" [nodes]="nodes"
        [servicescatalogue]="servicescatalogue" [serviceSubCatName]="serviceSubCatName"
        [serviceCatName]="serviceCatName" [storeserviceaddress]="storeserviceaddress"
        [storeBillingaddress]="storeBillingaddress" [showExpress]="showExpress"
        [specialInstruction]="specialInstruction" [MIN_T_END_TIME]="MIN_T_END_TIME2"
        [MAX_T_START_TIME]="MAX_T_START_TIME2" [currentDate]="currentDate5">
      </app-ordercreatedrawer>
    </ng-container>
  </nz-drawer>
</div>