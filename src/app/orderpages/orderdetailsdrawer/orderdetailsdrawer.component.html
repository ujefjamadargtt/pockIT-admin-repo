<div nz-row nzGutter="16">
  <div class="gutter-row" nz-col nzSpan="7" style="min-height: 88vh; max-height: 88vh; overflow: auto">
    <div nz-row class="backbbb">
      <div class="mainnam" nz-col nzSpan="12" style="text-align: start">
        <span style="
            color: #1d39c4 !important;
            background: #f0f5ff !important;
            border-color: #adc6ff !important;
            padding: 5px;
            font-size: 11px !important;
          " [attr.title]="vieworderdata.orderData[0]['ORDER_NUMBER']">
          {{ vieworderdata.orderData[0]["ORDER_NUMBER"] }}
        </span>
      </div>
      <div class="mainnam" nz-col nzSpan="12" style="text-align: end">
        <!-- {{ date }} -->
        <span style="
            color: #1d39c4 !important;
            background: #f0f5ff !important;
            border-color: #adc6ff !important;
            padding: 5px;
            font-size: 10px !important;
          " [attr.title]="
            vieworderdata.orderData[0]['ORDER_DATE_TIME']
              | date : 'dd/MM/yyyy HH:mm a'
          ">
          {{
          vieworderdata.orderData[0]["ORDER_DATE_TIME"]
          | date : "dd/MM/yyyy HH:mm a"
          }}
        </span>

        <span *ngIf="
            vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' &&
            (vieworderdata.orderData[0]['REFUND_STATUS'] == null ||
              vieworderdata.orderData[0]['REFUND_STATUS'] == 'R')
          " (click)="editOrder(vieworderdata.orderData[0])" nz-icon
          style="margin-left: 5px; font-size: 11px !important; cursor: pointer" nzType="edit" nzTheme="outline">
        </span>
        <span *ngIf="
            vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' &&
            (vieworderdata.orderData[0]['REFUND_STATUS'] == null ||
              vieworderdata.orderData[0]['REFUND_STATUS'] == 'R')
          " (click)="editOrder(vieworderdata.orderData[0])" style="
            margin-left: 2px;
            font-size: 11px !important;
            font-weight: 500;
            cursor: pointer;
          ">Edit</span>
      </div>

      <div class="subnam" nz-col nzSpan="24" style="
          font-size: 12px !important;
          margin-top: 4px;
          overflow: hidden;
          white-space: nowrap;
          display: flex;
          justify-content: flex-start;
        ">
        <!-- <span nz-icon nzType="user" nzTheme="outline" style="margin-right: 3px"></span> -->
        <span *ngIf="vieworderdata.orderData[0].CUSTOMER_TYPE == 'I'" nz-icon nzType="user" nzTheme="outline"
          style="margin-right: 3px"></span>
        <svg *ngIf="vieworderdata.orderData[0].CUSTOMER_TYPE == 'B'" enable-background="new 0 0 48 48" height="17px"
          id="Layer_1" version="1.1" viewBox="0 0 48 48" width="17px" xml:space="preserve"
          xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <path clip-rule="evenodd"
            d="M6,47V20c0-2.209,1.791-4,4-4l0,0v-4c0-1.104,0.896-2,2-2h2V2c0-0.552,0.447-1,1-1  s1,0.448,1,1v8h2c1.104,0,2,0.896,2,2v4l0,0l0,0c2.209,0,4,1.791,4,4v8h7v-6h4v-3h6v3h1v25H6z M18,13c0-0.552-0.447-1-1-1h-4  c-0.553,0-1,0.448-1,1v3h6V13z M22,20c0-1.104-0.896-2-2-2H10c-1.104,0-2,0.896-2,2v25h14V20z M31,30h-7v15h7V30z M40,24h-7v21h7V24  z M36,27h1c0.553,0,1,0.447,1,1v1c0,0.553-0.447,1-1,1h-1c-0.553,0-1-0.447-1-1v-1C35,27.447,35.447,27,36,27z M36,33h1  c0.553,0,1,0.447,1,1v1c0,0.553-0.447,1-1,1h-1c-0.553,0-1-0.447-1-1v-1C35,33.447,35.447,33,36,33z M36,39h1c0.553,0,1,0.447,1,1v1  c0,0.553-0.447,1-1,1h-1c-0.553,0-1-0.447-1-1v-1C35,39.447,35.447,39,36,39z M27,33h1c0.553,0,1,0.447,1,1v1c0,0.553-0.447,1-1,1  h-1c-0.553,0-1-0.447-1-1v-1C26,33.447,26.447,33,27,33z M27,39h1c0.553,0,1,0.447,1,1v1c0,0.553-0.447,1-1,1h-1  c-0.553,0-1-0.447-1-1v-1C26,39.447,26.447,39,27,39z M18,42h-1c-0.553,0-1-0.447-1-1v-1c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1  v1C19,41.553,18.553,42,18,42z M18,36h-1c-0.553,0-1-0.447-1-1v-1c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1v1  C19,35.553,18.553,36,18,36z M18,30h-1c-0.553,0-1-0.447-1-1v-1c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1v1  C19,29.553,18.553,30,18,30z M18,24h-1c-0.553,0-1-0.447-1-1v-1c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1v1  C19,23.553,18.553,24,18,24z M13,42h-1c-0.553,0-1-0.447-1-1v-1c0-0.553,0.447-1,1-1h1c0.553,0,1,0.447,1,1v1  C14,41.553,13.553,42,13,42z M13,36h-1c-0.553,0-1-0.447-1-1v-1c0-0.553,0.447-1,1-1h1c0.553,0,1,0.447,1,1v1  C14,35.553,13.553,36,13,36z M13,30h-1c-0.553,0-1-0.447-1-1v-1c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1v1  C14,29.553,13.553,30,13,30z M13,24h-1c-0.553,0-1-0.447-1-1v-1c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1v1  C14,23.553,13.553,24,13,24z"
            fill-rule="evenodd" />
        </svg>
        <span (click)="view(vieworderdata.orderData[0])" [nzTooltipTitle]="
            isTextOverflow ? vieworderdata.orderData[0]['COMPANY_NAME'] : null
          " #tooltipRef11="nzTooltip" nz-tooltip *ngIf="
            vieworderdata.orderData[0].CUSTOMER_TYPE != 'I';
            else elsenameblockss
          " #textContainer11 class="truncate-text" (mouseenter)="checkOverflow(textContainer11, tooltipRef11)">{{
          vieworderdata.orderData[0].COMPANY_NAME }}</span>
        <ng-template #elsenameblockss>
          <span (click)="view(vieworderdata.orderData[0])" #textContainer12 class="truncate-text" [nzTooltipTitle]="
              isTextOverflow
                ? vieworderdata.orderData[0]['CUSTOMER_NAME']
                : null
            " #tooltipRef2="nzTooltip" nz-tooltip (mouseenter)="checkOverflow(textContainer12, tooltipRef2)">{{
            vieworderdata.orderData[0].CUSTOMER_NAME }}</span>
        </ng-template>
      </div>
      <div nz-col nzSpan="24">
        <div nz-row>
          <div nz-col nzSpan="1">
            <span nz-icon nzType="environment" nzTheme="fill"></span>
          </div>
          <div class="subnam subnamhover" nz-col nzSpan="23" style="font-size: 12px !important; text-align: start"
            [attr.title]="
              vieworderdata.orderData[0]['ADDRESS_LINE_1'] +
              ', ' +
              vieworderdata.orderData[0]['ADDRESS_LINE_2'] +
              ' ' +
              vieworderdata.orderData[0]['COUNTRY_NAME'] +
              ', ' +
              vieworderdata.orderData[0]['STATE_NAME'] +
              ', ' +
              vieworderdata.orderData[0]['PINCODE']
            ">
            {{ vieworderdata.orderData[0]["ADDRESS_LINE_1"] }},
            {{ vieworderdata.orderData[0]["ADDRESS_LINE_2"] }}
            {{ vieworderdata.orderData[0]["COUNTRY_NAME"] }},
            {{ vieworderdata.orderData[0]["STATE_NAME"] }},
            {{ vieworderdata.orderData[0]["PINCODE"] }}
          </div>
        </div>
      </div>
      <div class="subnam" nz-col nzSpan="8" style="font-size: 11px !important; text-align: start">
        <a nzTooltipTitle="Call To Customer" nz-tooltip style="margin-right: 3px; color: #262626; cursor: pointer"
          href="tel:+{{ vieworderdata.orderData[0]['MOBILE_NO'] }}" target="_blank">
          <span nz-icon nzType="phone" nzTheme="fill" style="color: #262626 !important"></span>
        </a>
        {{ vieworderdata.orderData[0]["MOBILE_NO"] }}
      </div>
      <div class="subnam" nz-col nzSpan="16" style="font-size: 11px !important; text-align: end">
        <a style="
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            color: #262626 !important;
            cursor: pointer;
            font-size: 11px !important;
          " href="mailto:{{ vieworderdata.orderData[0]['EMAIL'] }}" target="_blank">
          <span nz-icon nzType="mail" nzTheme="fill" style="color: #262626 !important" nzTooltipTitle="Mail To Customer"
            nz-tooltip></span>
          {{ vieworderdata.orderData[0]["EMAIL"] }}
        </a>
      </div>
      <div class="subnam" nz-col nzSpan="12" style="font-size: 11px !important; text-align: start">
        <span nzTooltipTitle="Slot time" nz-tooltip style="margin-right: 3px; color: #262626; cursor: pointer">
          <span nz-icon nzType="clock-circle" nzTheme="fill" style="color: #262626 !important"></span>
        </span>

        <ng-container *ngIf="vieworderdata.orderData[0]['SLOTS'] as slot">
          <ng-container *ngIf="slot.includes('Slot 1')">Morning ({{ slot.split('(')[1] }}</ng-container>
          <ng-container *ngIf="slot.includes('Slot 2')">Afternoon ({{ slot.split('(')[1] }}</ng-container>
          <ng-container *ngIf="slot.includes('Slot 3')">Evening ({{ slot.split('(')[1] }}</ng-container>
        </ng-container>
      </div>

      <div class="subnam" nz-col nzSpan="12" style="font-size: 11px !important; text-align: end">
        <span style="
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            color: #262626 !important;
            cursor: pointer;
            font-size: 11px !important;
            margin-left: 47px;
          ">
          <span nz-icon nzType="calendar" nzTheme="fill" style="color: #262626 !important" nzTooltipTitle="Service Date"
            nz-tooltip></span>
          {{
          vieworderdata.detailsData[0]['EXPECTED_DATE_TIME']
          | date : 'dd/MMM/yyyy hh:mm a'
          }} </span>
      </div>
    </div>
    <div nz-row class="backbbb" style="margin-top: 10px">
      <div style="
          display: flex;
          justify-content: space-between !important;
          width: 100%;
        ">
        <div>
          <a nzTooltipTitle="Call To Customer" nzTooltipPlacement="top" nz-tooltip
            href="tel:+{{ vieworderdata.orderData[0]['MOBILE_NO'] }}" target="_blank">
            <button nz-button nzType="primary">
              <span nz-icon nzType="phone" nzTheme="fill"></span>Call
            </button>
          </a>
        </div>
        <div>
          <a nzTooltipTitle="Connect To Customer On WhatsApp" nz-tooltip nzTooltipPlacement="top"
            href="https://wa.me/{{ vieworderdata.orderData[0]['MOBILE_NO'] }}" target="_blank">
            <button nz-button nzType="primary">
              <span nz-icon nzType="whats-app" nzTheme="outline"></span>WhatsApp
            </button>
          </a>
        </div>
        <div>
          <a nzTooltipTitle="Mail To Customer" nzTooltipPlacement="top"
            href="mailto:{{ vieworderdata.orderData[0]['EMAIL'] }}" target="_blank" nz-tooltip>
            <button nz-button nzType="primary">
              <span nz-icon nzType="mail" nzTheme="fill"></span>Email
            </button>
          </a>
        </div>
      </div>
    </div>

    <div nz-row class="backbbb" style="margin-top: 10px; display: block; overflow: auto">
      <div nz-col nzSpan="24" class="mainnam">Order Cart</div>
      <div nz-col nzSpan="24" style="max-height: 30vh; overflow: auto">
        <div *ngFor="let cartItem of vieworderdata['detailsData']" class="cardstyle" style="
            font-size: 11px;
            box-shadow: rgba(0, 0, 0, 0.05) 0px 0px 0px 1px,
              rgb(209, 213, 219) 0px 0px 0px 1px inset;
            padding: 10px;
            margin-bottom: 4px;
          ">
          <div nz-row>
            <div nz-col nzSpan="22" class="subname">
              <b>{{ cartItem.CATEGORY_NAME }}</b>
              <b *ngIf="
                  cartItem.SERVICE_PARENT_NAME != undefined &&
                  cartItem.SERVICE_PARENT_NAME != null &&
                  cartItem.SERVICE_PARENT_NAME != ''
                ">
                > {{ cartItem.SERVICE_PARENT_NAME }}</b>
              <b>> {{ cartItem.SUB_CATEGORY_NAME }}</b>
            </div>
            <div nz-col nzSpan="2" style="text-align: right">
              <span *ngIf="cartItem.PHOTO_FILE != null && cartItem.PHOTO_FILE != ''" nz-icon
                (click)="viewImage(cartItem.PHOTO_FILE)" nzType="picture" nzTheme="outline"
                [nzTooltipTitle]="'View Photo'" nz-tooltip style="
                  cursor: pointer;
                  border: 1px solid grey;
                  padding: 3px 4px;
                  border-radius: 50px;
                  background: white;
                  margin-top: -5px;
                  font-size: 12px !important;
                "></span>
            </div>
          </div>
          <div nz-row>
            <div nz-col nzSpan="24" style="border-bottom: 1px solid #ebebeb" class="subname" #SERVICE_NAME [attr.title]="
                isTextOverflowing(SERVICE_NAME) ? cartItem.SERVICE_NAME : null
              ">
              {{ cartItem.SERVICE_NAME }}
            </div>
            <div nz-col nzSpan="24" style="margin-top: 7px"
              *ngIf="cartItem.BRAND_NAME != null && cartItem.BRAND_NAME != ''">
              Brand Name :
              <span style="
                  font-size: 10px !important;
                  font-weight: 400;
                  margin-bottom: 2px;
                  color: grey;
                  white-space: pre-line;
                ">{{ cartItem.BRAND_NAME }}</span>
            </div>
            <div nz-col nzSpan="24" *ngIf="
                cartItem.MODEL_NUMBER != null && cartItem.MODEL_NUMBER != ''
              ">
              Model Number :
              <span style="
                  font-size: 10px !important;
                  font-weight: 400;
                  margin-bottom: 2px;
                  color: grey;
                  white-space: pre-line;
                ">
                {{ cartItem.MODEL_NUMBER }}</span>
            </div>
            <div nz-col nzSpan="24" *ngIf="cartItem.DESCRIPTION != null && cartItem.DESCRIPTION != ''">
              Description :
              <span class="truncate-two-lines" nz-popover style="
                  font-size: 10px !important;
                  font-weight: 400;
                  color: grey;
                " [nzPopoverContent]="descript" nzPopoverPlacement="topLeft" [innerHTML]="cartItem['DESCRIPTION']">
              </span>
              <ng-template #descript>
                <span [innerHTML]="cartItem['DESCRIPTION']"></span>
              </ng-template>
            </div>
            <div nz-col nzSpan="11" style="
                font-size: 10px;
                font-weight: 400;
                color: grey;
                margin-top: 8px;
              ">
              Preparation Time :
              {{ formatTime(cartItem.TOTAL_DURARTION_MIN) }}
              <small>Hrs.</small>
            </div>
            <div nz-col nzSpan="13" style="
                font-size: 10px;
                font-weight: 400;
                color: grey;
                text-align: right;
                margin-top: 8px;
              ">
              Service Time :
              {{ convertDateTiem(cartItem.START_TIME) | date : "HH:mm a" }}
              To
              {{ convertDateTiem(cartItem.END_TIME) | date : "HH:mm a" }}
            </div>

            <div nz-col nzSpan="12">
              <span style="font-weight: 500; font-size: 11px !important">₹ {{ cartItem.TAX_EXCLUSIVE_AMOUNT }} x
                {{ cartItem.QUANTITY }}</span>
            </div>
            <div nz-col nzSpan="12" style="
                text-align: right;
                font-weight: 500;
                font-size: 12px !important;
              ">
              ₹ {{ cartItem.TOTAL_TAX_EXCLUSIVE_AMOUNT | number }}
            </div>
            <div nz-col nzSpan="24" style="
                display: flex;
                justify-content: space-between;
                align-items: end;
                font-size: 10px;
                font-weight: 400;
                color: grey;
                text-align: right;
              ">
              <small style="font-size: 10px; font-weight: 500">
                <small *ngIf="vieworderdata.orderData[0].IS_SAME_STATE == 1">CGST({{ cartItem.CGST }}%) + SGST({{
                  cartItem.SGST }}%)
                </small>
                <small *ngIf="vieworderdata.orderData[0].IS_SAME_STATE != 1">
                  IGST ({{ cartItem.IGST }}%)</small>
                <small *ngIf="cartItem.CESS != null && cartItem.CESS != 0">
                  + CESS({{ cartItem.CESS }}%)</small>
              </small>

              (+)Tax Amount : ₹ {{ cartItem.TAX_AMOUNT | number }}
            </div>
            <div nz-col nzSpan="12"></div>
            <div nz-col nzSpan="12" style="text-align: right">
              <span style="
                  background-color: rgb(245 45 162);
                  font-size: 10px !important;
                  font-weight: 500;
                  padding: 0px 5px;
                  color: white;
                  border-radius: 15px;
                " *ngIf="
                  cartItem.IS_EXPRESS && vieworderdata.orderData[0].IS_EXPRESS
                ">Express</span>
            </div>
          </div>
        </div>
      </div>
      <div nz-col nzSpan="24" class="mainnam">Summary</div>
      <div nz-col nzSpan="24">
        <div nz-row style="font-size: 12px">
          <div nz-col nzSpan="16" style="text-align: right">Taxable Amount</div>

          <div nz-col nzSpan="8" style="text-align: right">
            ₹ {{ vieworderdata.orderData[0].TOTAL_TAXABLE_AMOUNT | number }}
          </div>

          <div nz-col nzSpan="16" style="text-align: right">
            (-) Discount
            <span style="font-size: 9px !important"> </span>
          </div>

          <div nz-col nzSpan="8" style="text-align: right">
            ₹ {{ vieworderdata.orderData[0].DISCOUNT_AMOUNT | number }}
          </div>

          <div nz-col nzSpan="16" style="text-align: right">
            (+) Express Delivery
            <span style="font-size: 9px !important"> </span>
          </div>

          <div nz-col nzSpan="8" style="text-align: right">
            ₹
            {{
            vieworderdata.orderData[0].IS_EXPRESS
            ? (vieworderdata.orderData[0].EXPRESS_DELIVERY_CHARGES | number)
            : 0
            }}
          </div>

          <div nz-col nzSpan="16" style="text-align: right">
            (+) Tax Amount

            <span style="font-size: 9px !important"> </span>
          </div>

          <div nz-col nzSpan="8" style="text-align: right">
            ₹ {{ vieworderdata.orderData[0].TAX_AMOUNT | number }}
          </div>
        </div>
        <div nz-row style="
            border-top: 1px dashed #7e7272;
            padding: 1px 0;
            font-size: 12px;
          ">
          <div nz-col nzSpan="16" style="font-weight: 600; text-align: right">
            Order Total
          </div>

          <div nz-col nzSpan="8" style="font-weight: bold; text-align: right">
            ₹ {{ vieworderdata.orderData[0].TOTAL_AMOUNT | number }}
          </div>
        </div>
      </div>

      <div nz-col nzSpan="24" class="mainnam">Other Details</div>
      <div nz-col nzSpan="24" class="subnam" style="font-size: 12px">
        Payment Mode:
        <span style="font-weight: 500" *ngIf="
            vieworderdata != undefined &&
              vieworderdata.orderData[0]['PAYMENT_MODE'] == 'COD';
            else elsepyblocks
          ">
          Cash On Delivery</span>
        <ng-template #elsepyblocks>Online</ng-template>
      </div>
      <div nz-col nzSpan="24" class="subnam" style="font-size: 12px">
        Express Service Taken:
        <span style="font-weight: 500">{{
          vieworderdata.orderData[0]["IS_EXPRESS"] == 1 ? "Yes" : "No"
          }}</span>
      </div>
      <div nz-col nzSpan="24" class="subnam" style="font-size: 12px; margin-bottom: 10px"
        *ngIf="vieworderdata.orderData[0]['SPECIAL_INSTRUCTIONS']">
        Remark:
        <p class="truncate-two-lines" nz-popover style="font-size: 10px !important; font-weight: 400; color: grey"
          *ngIf="
            vieworderdata.orderData[0]['SPECIAL_INSTRUCTIONS'] != null &&
            vieworderdata.orderData[0]['SPECIAL_INSTRUCTIONS'] != ''
          " [nzPopoverContent]="descriptspl" nzPopoverPlacement="topLeft"
          [innerHTML]="vieworderdata.orderData[0]['SPECIAL_INSTRUCTIONS']"></p>
        <ng-template #descriptspl>
          <span [innerHTML]="vieworderdata.orderData[0]['SPECIAL_INSTRUCTIONS']"></span>
        </ng-template>
      </div>
    </div>

    <div class="footer" style="position: sticky !important; width: 100% !important">
      <!-- <nz-tag
        style="width: 100% !important; text-align: center"
        [nzColor]="'orange'"
        >Order Scheduled</nz-tag
      > -->

      <nz-tag style="
          width: 100% !important;
          text-align: center;
          font-size: 14px !important;
        " *ngIf="
          vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' &&
          (vieworderdata.orderData[0]['REFUND_STATUS'] == null ||
            vieworderdata.orderData[0]['REFUND_STATUS'] == 'R')
        " [nzColor]="'#ff9d19'">Order Placed</nz-tag>
      <nz-tag style="
          width: 100% !important;
          text-align: center;
          font-size: 14px !important;
        " *ngIf="
          vieworderdata.orderData[0]['ORDER_STATUS'] == 'OA' &&
          (vieworderdata.orderData[0]['REFUND_STATUS'] == null ||
            vieworderdata.orderData[0]['REFUND_STATUS'] == 'R')
        " [nzColor]="'#00b778'">Order Accepted</nz-tag>
      <nz-tag style="
          width: 100% !important;
          text-align: center;
          font-size: 14px !important;
        " *ngIf="vieworderdata.orderData[0]['ORDER_STATUS'] == 'OR'" [nzColor]="'#e50000'">Order Rejected</nz-tag>
      <nz-tag style="
          width: 100% !important;
          text-align: center;
          font-size: 14px !important;
        " *ngIf="vieworderdata.orderData[0]['ORDER_STATUS'] == 'OS'" [nzColor]="'#0351ea'">Order Scheduled</nz-tag>
      <nz-tag style="
          width: 100% !important;
          text-align: center;
          font-size: 14px !important;
        " *ngIf="
          (vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' ||
            vieworderdata.orderData[0]['ORDER_STATUS'] == 'OA') &&
          vieworderdata.orderData[0]['REFUND_STATUS'] == 'P'
        " [nzColor]="'#d10404'">Cancel Requested</nz-tag>
      <nz-tag style="
          width: 100% !important;
          text-align: center;
          font-size: 14px !important;
        " *ngIf="vieworderdata.orderData[0]['ORDER_STATUS'] == 'ON'" [nzColor]="'#0351ea'">Order Ongoing</nz-tag>
      <nz-tag style="
          width: 100% !important;
          text-align: center;
          font-size: 14px !important;
        " *ngIf="
          vieworderdata.orderData[0]['ORDER_STATUS'] == 'OC' ||
          vieworderdata.orderData[0]['ORDER_STATUS'] == 'CO'
        " [nzColor]="'#028d00'">Order Completed</nz-tag>
      <nz-tag style="
          width: 100% !important;
          text-align: center;
          font-size: 14px !important;
        " *ngIf="
          vieworderdata.orderData[0]['ORDER_STATUS'] == 'C' ||
          vieworderdata.orderData[0]['ORDER_STATUS'] == 'CA'
        " [nzColor]="'#f70000'">Order Cancelled</nz-tag>
    </div>
  </div>
  <div class="gutter-row" nz-col nzSpan="17">
    <!-- <nz-affix nzOffsetTop="10"> -->
    <div class="backbbb">
      <!-- <div style="min-height: 87vh;overflow-y: auto;"> -->
      <!-- <div
        nz-col
        nzSpan="24"
        style="text-align: center; margin-bottom: 5px"
        class="cardstyle1"
      >
        <h6>
          The order was accepted on {{ date | date : "dd-MM-yyyy HH:mm a" }} by
          Harsh
        </h6>
      </div> -->
      <nz-spin [nzSpinning]="isSpinning">
        <nz-tabset nzCentered (nzSelectedIndexChange)="onSelectedIndexChange($event)">
          <nz-tab [nzTitle]="titleTemplate">
            <ng-template #titleTemplate>
              Verification
              <span *ngIf="vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP'" nz-icon style="color: orange"
                nzType="warning" nzTheme="fill"></span>

              <span *ngIf="vieworderdata.orderData[0]['ORDER_STATUS'] != 'OP'" nz-icon style="color: green"
                nzType="check-circle" nzTheme="fill"></span>
            </ng-template>
            <ng-template nz-tab>
              <div style="
                  max-height: 78vh;
                  min-height: 76vh;
                  overflow-y: auto;
                  overflow-x: hidden;
                  padding-right: 10px;
                ">
                <div nz-row *ngIf="
                    vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' &&
                    vieworderdata.orderData[0]['ORDER_STATUS'] != 'C' &&
                    vieworderdata.orderData[0]['ORDER_STATUS'] != 'CA' &&
                    (vieworderdata.orderData[0]['REFUND_STATUS'] == null ||
                      vieworderdata.orderData[0]['REFUND_STATUS'] == 'R') &&
                    decreptedroleId != 2
                  ">
                  <div nz-col nzSpan="24" style="text-align: center; padding: 10px; font-size: 20px">
                    <b>Verify Order</b>
                  </div>

                  <div nz-col nzSpan="24" style="text-align: center; margin-bottom: 10px">
                    <nz-radio-group name="checkstatus" [(ngModel)]="STATUS" style="display: inline-block" required>
                      <label nz-radio nzValue="A" style="
                          color: green;
                          margin-right: 20px;
                          font-weight: 600;
                        ">
                        <span style="font-size: 16px !important; margin-right: 4px">Accept</span>
                        <span style="font-size: 18px !important" nz-icon nzType="check-circle"
                          nzTheme="outline"></span></label>
                      <label nz-radio nzValue="R" style="color: red; margin-right: 20px; font-weight: 600">
                        <span style="font-size: 16px !important; margin-right: 4px">Reject</span>
                        <span style="font-size: 18px !important" nz-icon nzType="close-circle"
                          nzTheme="outline"></span></label>
                      <label nz-radio nzValue="Res" style="color: #0c21af; font-weight: 600">
                        <span style="font-size: 16px !important; margin-right: 4px">Reschedule</span>
                        <span style="font-size: 18px !important" nz-icon nzType="schedule" nzTheme="outline"></span>
                      </label>
                    </nz-radio-group>
                  </div>
                  <div nz-col nzSpan="24" style="text-align: center" *ngIf="STATUS === 'A'">
                    <div nz-row>
                      <div nz-col nzSpan="6">

                      </div>
                      <div nz-col nzSpan="12" class="my-box" style="padding: 10px">

                        <nz-form-item class="nz-form-itemm" style="text-align: left"
                          *ngIf="[2, 3, 4, 5, 7, 8, 20, 21, 22].includes(+decreptedroleId)">
                          <nz-form-label nzNoColon>Choose a vendor to assign order (optional)</nz-form-label>
                          <nz-form-control nzHasFeedback nzErrorTip="Choose vendor to assign order">
                            <nz-select nzAllowClear="true" nzPlaceHolder="Select vendor to assign order" name="vendors"
                              [(ngModel)]="vendors" nzShowSearch>
                              <nz-option *ngFor="let vendor of vendorsList" [nzValue]="vendor.VENDOR_ID"
                                [nzLabel]="vendor.BUSINESS_NAME"></nz-option>
                            </nz-select>
                          </nz-form-control>
                        </nz-form-item>

                        <nz-form-item class="nz-form-itemm" style="text-align: left">
                          <nz-form-label nzNoColon>Acceptance Remark</nz-form-label>
                          <nz-form-control>
                            <textarea name="remarks" style="width: 100%" nz-input
                              [(ngModel)]="orderData.ACCEPTANCE_REMARK" [nzAutosize]="{ minRows: 2, maxRows: 4 }"
                              maxlength="256" placeholder="Please Enter Acceptance Remark" draggable="false"
                              required></textarea>
                            <h6 style="
                                color: red;
                                font-size: 10px;
                                text-align: left;
                              " *ngIf="
                                orderData.ACCEPTANCE_REMARK != undefined &&
                                orderData.ACCEPTANCE_REMARK != null &&
                                orderData.ACCEPTANCE_REMARK != ''
                              ">
                              {{ orderData.ACCEPTANCE_REMARK.length }}/256
                            </h6>
                          </nz-form-control>
                        </nz-form-item>
                        <button nz-button nzType="primary" style="margin-top: 5px" (nzOnConfirm)="acceptorder()"
                          [nzOkText]="'Yes'" (nzOnCancel)="deleteCancel()" nz-popconfirm
                          nzPopconfirmTitle="Are you sure, you want to accept order?" nzPopconfirmPlacement="top">
                          <i nz-icon nzType="check"></i>Accept Order
                        </button>
                      </div>
                      <div nz-col nzSpan="6"></div>
                    </div>
                  </div>
                  <div nz-col nzSpan="24" *ngIf="STATUS === 'R' || STATUS === 'Res'">
                    <div nz-row>
                      <div nz-col nzSpan="6"></div>
                      <div nz-col nzSpan="12" class="my-box" style="padding: 10px">
                        <div nz-row>
                          <div nz-col nzSpan="24" *ngIf="STATUS === 'R'">
                            <nz-form-item class="nz-form-itemm">
                              <nz-form-label nzRequired nzNoColon>Reject Remark</nz-form-label>
                              <nz-form-control nzHasFeedback nzErrorTip="Please Enter Rejection Remark">
                                <textarea name="remark" style="width: 100%" nz-input [(ngModel)]="orderData.REMARK"
                                  [nzAutosize]="{ minRows: 2, maxRows: 4 }" maxlength="256"
                                  placeholder="Please Enter Rejection Remark" draggable="false" required></textarea>
                                <h6 style="color: red; font-size: 10px" *ngIf="
                                    orderData.REMARK != undefined &&
                                    orderData.REMARK != null &&
                                    orderData.REMARK != ''
                                  ">
                                  {{ orderData.REMARK.length }}/256
                                </h6>
                              </nz-form-control>
                            </nz-form-item>
                          </div>
                          <div nz-col nzSpan="24" *ngIf="STATUS === 'Res'">
                            <div style="
                                font-size: 14px;
                                font-weight: 500;
                                text-align: center;
                                margin-top: 10px;
                              ">
                              Reschedule Order
                            </div>
                            <div nz-row>
                              <div nz-col nzSpan="10">
                                <nz-form-item class="nz-form-itemm">
                                  <nz-form-label nzRequired nzNoColon>Schedule Datetime</nz-form-label>
                                  <nz-form-control>
                                    <nz-date-picker style="width: 100%" (ngModelChange)="setDate($event)"
                                      [(ngModel)]="expectedDate" nzFormat="dd/MM/yyyy" [nzShowToday]="false"
                                      [nzDisabledDate]="disabledPastDates" name="expectedDate"></nz-date-picker>
                                  </nz-form-control>
                                </nz-form-item>
                              </div>
                              <div nz-col nzSpan="8">
                                <nz-form-item class="nz-form-itemm">
                                  <nz-form-label nzNoColon></nz-form-label>
                                  <nz-form-control style="margin-top: 3px">
                                    <nz-time-picker [(ngModel)]="time" name="time" style="width: 100%"
                                      nzFormat="HH:mm a" [nzMinuteStep]="10" (ngModelChange)="setTime($event)"
                                      [nzAllowEmpty]="false" [nzDisabledHours]="getDisabledHours"
                                      [nzDisabledMinutes]="getDisabledMinutes"></nz-time-picker>
                                  </nz-form-control>
                                </nz-form-item>
                              </div>
                            </div>
                          </div>
                          <div nz-col nzSpan="24" style="text-align: center; padding-bottom: 20px">
                            <button nz-button *ngIf="STATUS === 'R'" nzType="primary" style="margin-top: 10px"
                              (nzOnConfirm)="acceptorder()" [nzOkText]="'Yes'" (nzOnCancel)="deleteCancel()"
                              nz-popconfirm nzPopconfirmTitle="Are you sure, you want to reject order?"
                              nzPopconfirmPlacement="top">
                              Reject Order
                            </button>

                            <button nz-button nzType="primary" style="margin-top: 10px" (nzOnConfirm)="acceptorder()"
                              [nzOkText]="'Yes'" (nzOnCancel)="deleteCancel()" nz-popconfirm
                              nzPopconfirmTitle="Are you sure, you want to reschedule order?"
                              nzPopconfirmPlacement="top" *ngIf="STATUS === 'Res'">
                              <i nz-icon nzType="calendar"></i>Reschedule Order
                            </button>
                          </div>
                        </div>
                      </div>
                      <div nz-col nzSpan="6"></div>
                    </div>
                  </div>
                </div>
                <div *ngIf="
                    vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' &&
                    vieworderdata.orderData[0]['ORDER_STATUS'] != 'C' &&
                    vieworderdata.orderData[0]['ORDER_STATUS'] != 'CA' &&
                    decreptedroleId == 2
                  " style="
                    text-align: center;
                    padding-top: 30vh;
                    font-size: 20px;
                    font-weight: 500;
                    color: orangered;
                  ">
                  Order Verification Is Pending.
                </div>
                <div *ngIf="
                    (vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' ||
                      vieworderdata.orderData[0]['ORDER_STATUS'] == 'OA') &&
                    vieworderdata.orderData[0]['ORDER_STATUS'] != 'C' &&
                    vieworderdata.orderData[0]['ORDER_STATUS'] != 'CA' &&
                    vieworderdata.orderData[0]['REFUND_STATUS'] == 'P'
                  " style="
                    text-align: center;
                    padding-top: 30vh;
                    font-size: 20px;
                    font-weight: 500;
                    color: orangered;
                  ">
                  The cancellation request is under verification.
                </div>
                <div *ngIf="
                    vieworderdata.orderData[0]['ORDER_STATUS'] != 'OP' &&
                    vieworderdata.orderData[0]['ORDER_STATUS'] != 'OR' &&
                    vieworderdata.orderData[0]['ORDER_STATUS'] != 'C' &&
                    vieworderdata.orderData[0]['ORDER_STATUS'] != 'CA' &&
                    (vieworderdata.orderData[0]['REFUND_STATUS'] == null ||
                      vieworderdata.orderData[0]['REFUND_STATUS'] == 'R')
                  " style="
                    text-align: center;
                    padding-top: 30vh;
                    font-size: 20px;
                    font-weight: 500;
                    color: green;
                  ">
                  Order Accepted
                </div>
                <div *ngIf="vieworderdata.orderData[0]['ORDER_STATUS'] == 'OR'" style="
                    text-align: center;
                    padding-top: 30vh;
                    font-size: 20px;
                    font-weight: 500;
                    color: red;
                  ">
                  Order Rejected
                </div>
                <div *ngIf="
                    vieworderdata.orderData[0]['ORDER_STATUS'] == 'C' ||
                    vieworderdata.orderData[0]['ORDER_STATUS'] == 'CA'
                  " style="
                    text-align: center;
                    padding-top: 30vh;
                    font-size: 20px;
                    font-weight: 500;
                    color: red;
                  ">
                  Order Cancelled
                </div>
              </div>
            </ng-template>
          </nz-tab>
          <nz-tab (nzSelect)="getJobs()" [nzDisabled]="
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OR' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'C' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'CA' ||
              (vieworderdata.orderData[0]['ORDER_STATUS'] == 'OA' &&
                vieworderdata.orderData[0]['REFUND_STATUS'] == 'P')
            " [nzTitle]="'Jobs'">
            <ng-template nz-tab>
              <div style="
                  max-height: 78vh;
                  min-height: 76vh;
                  overflow-y: auto;
                  overflow-x: hidden;
                  padding-right: 10px;
                ">
                <div nz-row nzGutter="16">
                  <div nz-col nzSpan="12" style="padding: 10px" *ngFor="let data of orderDetailsData; let i = index">
                    <div class="cardstyle1" nz-row style="height: 100%">
                      <div class="mainnam" nz-col nzSpan="12" style="text-align: start">
                        <span style="
                            color: #1d39c4 !important;
                            background: #f0f5ff !important;
                            border-color: #adc6ff !important;
                            padding: 5px;
                            font-size: 12px !important;
                          " [attr.title]="vieworderdata.orderData[0].ORDER_NUMBER">
                          {{ vieworderdata.orderData[0].ORDER_NUMBER }}</span>
                      </div>
                      <div class="mainnam" nz-col nzSpan="12" style="text-align: end">
                        <span (click)="openjobcarddetails(data)" *ngIf="
                            data.JOB_CARD_NO != undefined &&
                            data.JOB_CARD_NO != null
                          " style="
                            color: #1d39c4 !important;
                            background: #f0f5ff !important;
                            border-color: #adc6ff !important;
                            padding: 5px;
                            font-size: 12px !important;
                            cursor: pointer;
                          " [attr.title]="data.JOB_CARD_NO">
                          {{ data.JOB_CARD_NO }}</span>
                      </div>

                      <div class="subnam" nz-col nzSpan="16" style="
                          font-size: 11px !important;
                          margin-top: 4px;
                          display: flex;
                          justify-content: flex-start;
                        ">
                        <span *ngIf="
                            vieworderdata.orderData[0].CUSTOMER_TYPE == 'I'
                          " nz-icon nzType="user" nzTheme="outline"></span>

                        <svg *ngIf="
                            vieworderdata.orderData[0].CUSTOMER_TYPE != 'I'
                          " enable-background="new 0 0 55 55" height="17px" id="Layer_1" version="1.1"
                          viewBox="0 0 55 55" width="17px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg"
                          xmlns:xlink="http://www.w3.org/1999/xlink">
                          <path clip-rule="evenodd"
                            d="M6,47V20c0-2.209,1.791-4,4-4l0,0v-4c0-1.104,0.896-2,2-2h2V2c0-0.552,0.447-1,1-1  s1,0.448,1,1v8h2c1.104,0,2,0.896,2,2v4l0,0l0,0c2.209,0,4,1.791,4,4v8h7v-6h4v-3h6v3h1v25H6z M18,13c0-0.552-0.447-1-1-1h-4  c-0.553,0-1,0.448-1,1v3h6V13z M22,20c0-1.104-0.896-2-2-2H10c-1.104,0-2,0.896-2,2v25h14V20z M31,30h-7v15h7V30z M40,24h-7v21h7V24  z M36,27h1c0.553,0,1,0.447,1,1v1c0,0.553-0.447,1-1,1h-1c-0.553,0-1-0.447-1-1v-1C35,27.447,35.447,27,36,27z M36,33h1  c0.553,0,1,0.447,1,1v1c0,0.553-0.447,1-1,1h-1c-0.553,0-1-0.447-1-1v-1C35,33.447,35.447,33,36,33z M36,39h1c0.553,0,1,0.447,1,1v1  c0,0.553-0.447,1-1,1h-1c-0.553,0-1-0.447-1-1v-1C35,39.447,35.447,39,36,39z M27,33h1c0.553,0,1,0.447,1,1v1c0,0.553-0.447,1-1,1  h-1c-0.553,0-1-0.447-1-1v-1C26,33.447,26.447,33,27,33z M27,39h1c0.553,0,1,0.447,1,1v1c0,0.553-0.447,1-1,1h-1  c-0.553,0-1-0.447-1-1v-1C26,39.447,26.447,39,27,39z M18,42h-1c-0.553,0-1-0.447-1-1v-1c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1  v1C19,41.553,18.553,42,18,42z M18,36h-1c-0.553,0-1-0.447-1-1v-1c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1v1  C19,35.553,18.553,36,18,36z M18,30h-1c-0.553,0-1-0.447-1-1v-1c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1v1  C19,29.553,18.553,30,18,30z M18,24h-1c-0.553,0-1-0.447-1-1v-1c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1v1  C19,23.553,18.553,24,18,24z M13,42h-1c-0.553,0-1-0.447-1-1v-1c0-0.553,0.447-1,1-1h1c0.553,0,1,0.447,1,1v1  C14,41.553,13.553,42,13,42z M13,36h-1c-0.553,0-1-0.447-1-1v-1c0-0.553,0.447-1,1-1h1c0.553,0,1,0.447,1,1v1  C14,35.553,13.553,36,13,36z M13,30h-1c-0.553,0-1-0.447-1-1v-1c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1v1  C14,29.553,13.553,30,13,30z M13,24h-1c-0.553,0-1-0.447-1-1v-1c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1v1  C14,23.553,13.553,24,13,24z"
                            fill-rule="evenodd" />
                        </svg>&nbsp;
                        <span [nzTooltipTitle]="
                            isTextOverflow
                              ? vieworderdata.orderData[0]['COMPANY_NAME']
                              : null
                          " #tooltipRef1="nzTooltip" nz-tooltip *ngIf="
                            vieworderdata.orderData[0].CUSTOMER_TYPE != 'I';
                            else elsenameblockss
                          " #textContainer class="truncate-text" (mouseenter)="
                            checkOverflow(textContainer, tooltipRef1)
                          ">{{ vieworderdata.orderData[0].COMPANY_NAME }}</span>
                        <ng-template #elsenameblockss>
                          <span #textContainer1 class="truncate-text" [nzTooltipTitle]="
                              isTextOverflow
                                ? vieworderdata.orderData[0]['CUSTOMER_NAME']
                                : null
                            " #tooltipRef="nzTooltip" nz-tooltip (mouseenter)="
                              checkOverflow(textContainer1, tooltipRef)
                            ">{{
                            vieworderdata.orderData[0].CUSTOMER_NAME
                            }}</span>
                        </ng-template>
                        <!-- {{ vieworderdata.orderData[0].CUSTOMER_NAME }} -->
                      </div>
                      <div class="subnam" nz-col nzSpan="8" style="
                          font-size: 11px !important;
                          margin-top: 4px;
                          text-align: end;
                          font-weight: 600;
                        ">
                        ₹ {{ data.FINAL_ITEM_AMOUNT | number }}
                      </div>
                      <div nz-col nzSpan="16">
                        <div nz-row>
                          <div class="subnam" nz-col nzSpan="23" style="font-size: 11px !important">
                            <span class="subnam" style="font-size: 11px !important" *ngIf="
                                vieworderdata.orderData[0]['SERVICE_ADDRESS'] !=
                                null
                              ">
                              <span nz-icon nzType="environment" nzTheme="fill"></span>
                              <span style="font-size: 11px !important" *ngIf="
                                  vieworderdata.orderData[0]['SERVICE_ADDRESS']
                                    .length >= 40
                                " nz-popover [nzPopoverContent]="
                                  vieworderdata.orderData[0]['SERVICE_ADDRESS']
                                " nzPopoverPlacement="topLeft">
                                {{
                                vieworderdata.orderData[0][
                                "SERVICE_ADDRESS"
                                ] == null
                                ? "-"
                                : (vieworderdata.orderData[0][
                                "SERVICE_ADDRESS"
                                ] | slice : 0 : 40)
                                }}{{
                                vieworderdata.orderData[0]["SERVICE_ADDRESS"]
                                .length > 40
                                ? "..."
                                : ""
                                }}
                              </span>
                              <span style="font-size: 11px !important" *ngIf="
                                  vieworderdata.orderData[0]['SERVICE_ADDRESS']
                                    .length < 40
                                ">
                                {{
                                vieworderdata.orderData[0][
                                "SERVICE_ADDRESS"
                                ] == null
                                ? "-"
                                : (vieworderdata.orderData[0][
                                "SERVICE_ADDRESS"
                                ] | slice : 0 : 40)
                                }}
                                {{
                                vieworderdata.orderData[0]["SERVICE_ADDRESS"]
                                .length > 40
                                ? "..."
                                : ""
                                }}
                              </span>
                            </span>
                            <span *ngIf="
                                vieworderdata.orderData[0]['SERVICE_ADDRESS'] ==
                                null
                              ">-</span>
                          </div>
                        </div>
                      </div>
                      <div class="subnam" nz-col nzSpan="8" style="text-align: end; font-weight: 600">
                        <span style="font-size: 10px !important" *ngIf="data.IS_EXPRESS == 1">Express | ₹{{
                          data.EXPRESS_DELIVERY_CHARGES | number
                          }}</span>
                      </div>
                      <div class="subnam" nz-col nzSpan="12" style="font-size: 11px !important" [nzTooltipTitle]="
                          isTextOverflow
                            ? vieworderdata.orderData[0].PINCODE
                            : null
                        " #tooltipRefpin="nzTooltip" nz-tooltip #textContainerpinn class="truncate-text" (mouseenter)="
                          checkOverflow(textContainerpinn, tooltipRefpin)
                        ">
                        Pincode :{{ vieworderdata.orderData[0].PINCODE }}
                      </div>
                      <div class="subnam" nz-col nzSpan="12" style="font-size: 11px !important; text-align: end"
                        [nzTooltipTitle]="
                          isTextOverflow
                            ? vieworderdata.orderData[0].TERRITORY_NAME
                            : null
                        " #tooltipRefter="nzTooltip" nz-tooltip #textContainerpinn class="truncate-text" (mouseenter)="
                          checkOverflow(textContainerpinn, tooltipRefter)
                        ">
                        Territory :{{
                        vieworderdata.orderData[0].TERRITORY_NAME
                        }}
                      </div>
                      <div class="subnam" nz-col nzSpan="24" style="font-size: 11px !important; text-align: start"
                        [nzTooltipTitle]="
                          isTextOverflow ? data.SERVICE_NAME : null
                        " #tooltipRefser="nzTooltip" nz-tooltip #textContainerpinn class="truncate-text" (mouseenter)="
                          checkOverflow(textContainerpinn, tooltipRefser)
                        ">
                        Service :{{ data.SERVICE_NAME }}
                      </div>
                      <div class="subnam" nz-col nzSpan="14" style="text-align: start">
                        <span style="font-size: 11px !important" *ngIf="
                            data.SCHEDULED_DATE_TIME != undefined &&
                            data.SCHEDULED_DATE_TIME != null
                          ">
                          Scheduled Date:
                          {{
                          data.SCHEDULED_DATE_TIME | date : "dd/MM/yyyy"
                          }}&nbsp;{{ formatTimess(data.START_TIME) }}
                        </span>
                        <button nz-button style="margin-top: 5px" nzSize="small" nzType="primary" *ngIf="
                            decreptedroleId !== 2 &&
                            TYPE_FOR_LOCAL != 'CUSTOMER' &&
                            data.JOB_CARD_ID != undefined &&
                            data.JOB_CARD_ID != null &&
                            data.JOB_CARD_ID != 0 &&
                            (data.SCHEDULED_DATE_TIME == undefined ||
                              data.SCHEDULED_DATE_TIME == null)
                          " (click)="ScheduleJob(data)">
                          Go To Scheduler
                        </button>
                      </div>
                      <div class="subnam" nz-col nzSpan="10" style="text-align: end">
                        <span style="font-size: 11px !important" *ngIf="
                            data.ESTIMATED_TIME_IN_MIN != undefined &&
                            data.ESTIMATED_TIME_IN_MIN != null
                          ">
                          Estimated Time:
                          {{ data.ESTIMATED_TIME_IN_MIN }} min.
                        </span>
                      </div>

                      <div class="subnam" nz-col nzSpan="8" style="
                          font-size: 11px !important;
                          text-align: start;
                          margin-top: 5px;
                        "></div>
                      <div nz-col nzSpan="8" style="text-align: center; cursor: pointer">
                        <button nz-button nzType="primary" *ngIf="
                            decreptedroleId !== 2 &&
                            TYPE_FOR_LOCAL != 'CUSTOMER' &&
                            (data.JOB_CARD_ID == undefined ||
                              data.JOB_CARD_ID == null ||
                              data.JOB_CARD_ID == 0)
                          " (click)="openmodelll(data, i)">
                          Generate Job
                        </button>
                      </div>

                      <div class="subnam" nz-col nzSpan="8" style="
                          font-size: 12px !important;
                          text-align: end;
                          margin-top: 5px;
                        "></div>
                    </div>
                  </div>
                </div>
              </div>
            </ng-template>
          </nz-tab>
          <nz-tab [nzTitle]="'Parts Request'" (nzSelect)="getParts()" [nzDisabled]="
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OR' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'C' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'CA' ||
              (vieworderdata.orderData[0]['ORDER_STATUS'] == 'OA' &&
                vieworderdata.orderData[0]['REFUND_STATUS'] == 'P')
            ">
            <ng-template nz-tab>
              <div style="
                  max-height: 78vh;
                  min-height: 76vh;
                  overflow-y: auto;
                  overflow-x: hidden;
                  padding-right: 10px;
                ">
                <div nz-row nzGutter="16" *ngIf="parts != undefined && parts.length > 0">
                  <div nz-col nzSpan="12" style="padding: 10px" *ngFor="let part of parts; let l = index">
                    <div class="cardstyle1" nz-row style="height: 130px">
                      <div class="mainnam" nz-col nzSpan="12" style="text-align: start" #patJOB_CARD_NO [attr.title]="
                          isTextOverflowing(patJOB_CARD_NO)
                            ? part.JOB_CARD_NO
                            : null
                        ">
                        <span *ngIf="
                            part.JOB_CARD_NO != undefined &&
                            part.JOB_CARD_NO != null
                          " style="
                            color: #1d39c4 !important;
                            background: #f0f5ff !important;
                            border-color: #adc6ff !important;
                            padding: 5px;
                            font-size: 12px !important;
                            cursor: pointer;
                          " [attr.title]="part.JOB_CARD_NO">
                          {{ part.JOB_CARD_NO }}</span>
                      </div>
                      <div class="subnam" nz-col nzSpan="12" style="text-align: end">
                        <span style="font-size: 11px !important">
                          {{
                          part.REQUESTED_DATE_TIME
                          | date : "dd/MM/yyyy HH:mm a"
                          }}
                        </span>
                      </div>
                      <div *ngIf="part.INVENTORY_ID > 0" class="subnam" nz-col nzSpan="24" #partINVENTORY_CATEGORY_NAME
                        [attr.title]="
                          isTextOverflowing(partINVENTORY_CATEGORY_NAME)
                            ? part.INVENTORY_CATEGORY_NAME +
                              '>' +
                              part.INVENTRY_SUB_CATEGORY_NAME
                            : null
                        ">
                        <span style="font-size: 11px !important">
                          {{ part.INVENTORY_CATEGORY_NAME }} >
                          {{ part.INVENTRY_SUB_CATEGORY_NAME }}
                        </span>
                      </div>
                      <div class="subnam" nz-col nzSpan="24" style="font-size: 12px !important" #ITEM_NAME [attr.title]="
                          isTextOverflowing(ITEM_NAME) ? part.ITEM_NAME : null
                        ">
                        Part Name :
                        {{
                        part.INVENTORY_ID > 0
                        ? part.ITEM_NAME
                        : part.INVENTORY_NAME
                        }}
                      </div>
                      <div class="subnam" nz-col nzSpan="24" style="font-size: 11px !important">
                        Requested By : {{ part.TECHNICIAN_NAME }}
                      </div>
                      <div class="subnam" nz-col nzSpan="8" style="font-size: 11px !important">
                        Price : ₹ {{ part.TOTAL_AMOUNT | number }}
                      </div>
                      <div class="subnam" nz-col nzSpan="7" style="font-size: 11px !important">
                        Quantity : {{ part.QUANTITY }}
                      </div>

                      <div class="subnam" nz-col nzSpan="9" style="font-size: 11px !important">
                        <nz-tag style="
                            width: 100% !important;
                            text-align: center;
                            font-size: 11px !important;
                          " *ngIf="part['STATUS'] == 'P'" [nzColor]="'#ff9d19'">Pending</nz-tag>
                        <nz-tag style="
                            width: 100% !important;
                            text-align: center;
                            font-size: 11px !important;
                          " *ngIf="part['STATUS'] == 'A'" [nzColor]="'green'">Approved</nz-tag>
                        <nz-tag style="
                            width: 100% !important;
                            text-align: center;
                            font-size: 11px !important;
                          " *ngIf="part['STATUS'] == 'AC'" [nzColor]="'green'">Approved By Customer</nz-tag>
                        <nz-tag style="
                            width: 100% !important;
                            text-align: center;
                            font-size: 11px !important;
                          " *ngIf="part['STATUS'] == 'AP'" [nzColor]="'green'">Auto Approved</nz-tag>
                        <nz-tag style="
                            width: 100% !important;
                            text-align: center;
                            font-size: 11px !important;
                          " *ngIf="part['STATUS'] == 'R'" [nzColor]="'red'">Rejected</nz-tag>
                      </div>
                    </div>
                  </div>
                </div>
                <div *ngIf="parts == undefined || parts.length == 0">
                  <nz-empty style="margin-top: 50px"
                    nzNotFoundImage="https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg"
                    [nzNotFoundContent]="contentTpl">
                    <ng-template #contentTpl>
                      <span> No Parts Request Available. </span>
                    </ng-template>
                  </nz-empty>
                  <!-- <p class="emptyDataTex" style="
                      margin-top: 100px;
                      white-space: pre-line;
                      text-align: center;
                      font-size: 13px;
                    ">
                    No Parts Request Available.
                  </p> -->
                </div>
              </div>
            </ng-template>
          </nz-tab>

          <nz-tab (nzSelect)="setFilter()" [nzTitle]="'Action/Activity Log'">
            <ng-template nz-tab>
              <div style="
                  max-height: 78vh;
                  min-height: 76vh;
                  overflow-y: auto;
                  overflow-x: hidden;
                  padding-right: 10px;
                ">
                <app-actionlogs [TYPE]="'ORDER'" [FILTER_ID]="orderDetails.ID"
                  [CUSTOMER_ID]="vieworderdata.orderData[0].CUSTOMER_ID"></app-actionlogs>
              </div>
            </ng-template>
          </nz-tab>

          <nz-tab (nzSelect)="setFilter()" [nzDisabled]="
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OR' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'C' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'CA'
            " [nzTitle]="'Customer Ratings for Technicians'">
            <ng-template nz-tab>
              <div style="
                  max-height: 78vh;
                  min-height: 76vh;
                  overflow-y: auto;
                  overflow-x: hidden;
                  padding-right: 10px;
                ">
                <app-customerratting [TYPE]="'ORDER'" [customer_id]="vieworderdata.orderData[0].CUSTOMER_ID"
                  [FILTER_ID]="orderDetails.ID"></app-customerratting>
              </div>
            </ng-template>
          </nz-tab>
          <nz-tab (nzSelect)="setFilter()" [nzDisabled]="
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OR' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'C' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'CA'
            " [nzTitle]="'Technician Ratings for Customers'">
            <ng-template nz-tab>
              <div style="
                  max-height: 78vh;
                  min-height: 76vh;
                  overflow-y: auto;
                  overflow-x: hidden;
                  padding-right: 10px;
                ">
                <app-technicianratting [TYPE]="'ORDER'" [FILTER_ID]="orderDetails.ID"
                  [customer_id]="vieworderdata.orderData[0].CUSTOMER_ID"></app-technicianratting>
              </div>
            </ng-template>
          </nz-tab>

          <nz-tab (nzSelect)="setFilter()" [nzDisabled]="
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OR' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'C' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'CA'
            " [nzTitle]="'Chat'">
            <ng-template nz-tab>
              <div style="
                  max-height: 78vh;
                  min-height: 76vh;
                  overflow-y: auto;
                  overflow-x: hidden;
                  padding-right: 10px;
                ">
                <app-chatoverview-comp [TYPE]="'ORDER'" [FILTER_ID]="orderDetails.ID"></app-chatoverview-comp>
              </div>
            </ng-template>
          </nz-tab>
          <nz-tab (nzSelect)="setFilter()" [nzTitle]="'Order Location'">
            <ng-template nz-tab>
              <div style="
                  max-height: 78vh;
                  min-height: 76vh;
                  overflow-y: auto;
                  overflow-x: hidden;
                  padding-right: 10px;
                ">
                <app-location [TYPE]="'ORDER'" [FILTER_ID]="orderDetails.ID"></app-location>
              </div>
            </ng-template>
          </nz-tab>

          <!-- <nz-tab [nzTitle]="'Technician Travel Log'"> </nz-tab> -->
          <nz-tab (nzSelect)="setFilter()" [nzDisabled]="
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OR' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'C' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'CA'
            " [nzTitle]="'Technician Travel History'">
            <ng-template nz-tab>
              <div style="
                  max-height: 78vh;
                  min-height: 76vh;
                  overflow-y: auto;
                  overflow-x: hidden;
                  padding-right: 10px;
                ">
                <app-technicianlocationsmap [TYPE]="'ORDER'" [FILTER_ID]="orderDetails.ID"></app-technicianlocationsmap>
              </div>
            </ng-template>
          </nz-tab>
          <nz-tab (nzSelect)="setFilter()" [nzDisabled]="
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OR' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'C' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'CA'
            " [nzTitle]="'Technician Locations'">
            <ng-template nz-tab>
              <div style="
                  max-height: 78vh;
                  min-height: 76vh;
                  overflow-y: auto;
                  overflow-x: hidden;
                  padding-right: 10px;
                ">
                <app-multiplelocationpage [TYPE]="'ORDER'" [FILTER_ID]="orderDetails.ID"></app-multiplelocationpage>
              </div>
            </ng-template>
          </nz-tab>

          <nz-tab (nzSelect)="setFilter()" [nzDisabled]="
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OR' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'C' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'CA'
            " [nzTitle]="'Invoices'">
            <ng-template nz-tab>
              <div style="
                  max-height: 78vh;
                  min-height: 76vh;
                  overflow-y: auto;
                  overflow-x: hidden;
                  padding-right: 10px;
                ">
                <app-invoicepage [TYPE]="'ORDER'" [FILTER_ID]="orderDetails.ID"></app-invoicepage>
              </div>
            </ng-template>
          </nz-tab>
          <!-- <nz-tab (nzSelect)="setFilter()"
            [nzDisabled]="
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OP' ||
              vieworderdata.orderData[0]['ORDER_STATUS'] == 'OR'
            "
            [nzTitle]="'Payment Details'"
          >
          </nz-tab> -->
        </nz-tabset>
      </nz-spin>
    </div>
  </div>
</div>

<!-- sanjana -->
<!--Drawer For view Past Order-->
<div *ngIf="drawerVisiblepastorder">
  <nz-drawer [nzBodyStyle]="{
      height: 'calc(100% - 55px)',
      overflow: 'auto',
      'padding-bottom': '53px'
    }" [nzClosable]="true" [nzMask]="true" [nzMaskClosable]="false" [nzWidth]="600"
    [nzVisible]="drawerVisiblepastorder" [nzTitle]="drawerTitlepastorder" (nzOnClose)="drawerClosepastorder()"
    (nzKeyboard)="(true)">
    <ng-container *nzDrawerContent>
      <app-view-past-order-drawer [drawerClosepastorder]="closeCallbackpastorder"
        [drawerVisiblepastorder]="drawerVisiblepastorder" [data]="drawerDatapastorder">
      </app-view-past-order-drawer>
    </ng-container>
  </nz-drawer>
</div>
<nz-modal [nzWidth]="900" [(nzVisible)]="ImageModalVisible" nzMaskClosable="false" nzClosable="false"
  [nzContent]="content" [nzTitle]="'Image View'" (nzOnCancel)="ImageModalCancel()" [nzFooter]="ImageModalFooter">
  <ng-template #content>
    <nz-spin [nzSpinning]="isSpinning">
      <div *ngIf="imageshow != undefined && imageshow != null && imageshow != ''" class="ss" style="height: 400px">
        <div class="controls">
          <button nz-button nzType="primary" nzShape="circle" (click)="zoomIn()">
            <i nz-icon nzType="zoom-in"></i>
          </button>
          <button nz-button nzType="primary" nzShape="circle" (click)="zoomOut()">
            <i nz-icon nzType="zoom-out"></i>
          </button>
          <button nz-button nzType="primary" nzShape="circle" (click)="rotateLeft()">
            <i nz-icon nzType="rotate-left"></i>
          </button>
          <button nz-button nzType="primary" nzShape="circle" (click)="rotateRight()">
            <i nz-icon nzType="rotate-right"></i>
          </button>
          <button nz-button nzType="default" nzShape="circle" (click)="reset()">
            <i nz-icon nzType="reload"></i>
          </button>
        </div>
        <div class="image-container">
          <img [src]="imageshow" [style.transform]="
              'scale(' + zoomLevel + ') rotate(' + rotation + 'deg)'
            " alt="Zoomable Image" />
        </div>
      </div>
    </nz-spin>
  </ng-template>
  <ng-template #ImageModalFooter>
    <button nz-button nzType="default" (click)="ImageModalCancel()">
      Close
    </button>
  </ng-template>
</nz-modal>
<nz-modal [(nzVisible)]="openModal" nzCentered="true" [nzBodyStyle]="{ padding: '16px' }" nzWidth="570px"
  nzClosable="false" [nzFooter]="contextofrules" nzMaskClosable="false">
  <ng-container *nzModalContent>
    <h5 style="font-size: 15px">Generate Job</h5>
    <hr style="margin: 8px 0" />
    <p style="font-size: 13px; margin-bottom: 10px"></p>
    <div nz-row>
      <div nz-col nzSpan="24">
        <nz-form-item class="nz-form-itemm">
          <nz-form-label nzNoColon>Additional Remark</nz-form-label>
          <nz-form-control nzHasFeedback>
            <textarea nz-input [(ngModel)]="jobdetails" name="jobdetails" rows="3" maxlength="512"
              (focus)="checkLength()" (blur)="checkLength()" placeholder="Enter Additional Remark"
              style="width: 100%"></textarea>
          </nz-form-control>
          <span style="color: red; font-size: 10px" *ngIf="jobdetails && showerror">{{ jobdetails.length }}/512</span>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="24" *ngIf="
          selectService['SERVICE_SKILLS'] == undefined ||
          selectService['SERVICE_SKILLS'] == null ||
          selectService['SERVICE_SKILLS'] == ''
        ">
        <nz-form-item class="nz-form-itemm">
          <nz-form-label nzRequired nzNoColon>Skills</nz-form-label>
          <nz-form-control nzHasFeedback nzErrorTip="Select Skills">
            <nz-select nzAllowClear="true" nzPlaceHolder="Select Skills" name="skills" [(ngModel)]="skills" nzShowSearch
              required nzMode="multiple">
              <nz-option *ngFor="let skill of skillsList" [nzValue]="skill.NAME" [nzLabel]="skill.NAME"></nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="12">
        <nz-form-item class="nz-form-itemm">
          <nz-form-label nzNoColon nzRequired>Estimation Time</nz-form-label>
          <nz-form-control nzErrorTip="Enter Estimation Time">
            <nz-input-group [nzAddOnAfter]="'mins'" style="width: 100%">
              <input nz-input name="DURATION" placeholder="Enter Estimation Time" required autocomplete="off"
                [(ngModel)]="estimatetime" #nameField="ngModel" (keypress)="commonFunction.onlynum($event)"
                style="width: 100%" />
            </nz-input-group>
          </nz-form-control>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="12">
        <nz-form-item class="nz-form-itemm">
          <nz-form-label nzNoColon nzRequired>Is It Remote Job?</nz-form-label>
          <nz-form-control>
            <nz-switch name="RemoteJob" nzCheckedChildren="Yes" nzUnCheckedChildren="No" [(ngModel)]="remoteJob">
            </nz-switch>
          </nz-form-control>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="24">
        <small style="color: red; font-size: 11px; margin-left: 10px">
          *only numbers multiples of 10 (e.g. 10, 20, 30,...) are
          allowed.</small>
      </div>
    </div>
  </ng-container>

  <ng-template #contextofrules>
    <button nz-button [nzLoading]="isSpinning" nzType="primary" class="btn btn-primary" (nzOnConfirm)="createJob()"
      [nzOkText]="'Yes'" (nzOnCancel)="deleteCancel()" nz-popconfirm
      nzPopconfirmTitle="Are you sure, you want to generate job?" nzPopconfirmPlacement="top">
      Save & Close
    </button>
    <button nz-button [nzLoading]="isSpinning" nzType="default" class="btn btn-primary" (click)="closemodelll()">
      Cancel
    </button>
  </ng-template>
</nz-modal>

<div *ngIf="jobdetailsshow">
  <nz-drawer [nzBodyStyle]="{
      height: 'calc(100% - 55px)',
      overflow: 'auto',
      padding: '10px',
    }" [nzClosable]="true" [nzMask]="true" [nzMaskClosable]="false" [nzWidth]="drawersize" [nzVisible]="jobdetailsshow"
    [nzTitle]="jobdetaildrawerTitle" (nzOnClose)="jobdetailsdrawerClose()" (nzKeyboard)="(true)">
    <ng-container *nzDrawerContent>
      <app-detailsjob [drawerClose]="jobdetailscloseCallback" [jobdetailsdata]="jobdetailsdata"
        [invoicefilter]="invoicefilter">
      </app-detailsjob>
    </ng-container>
  </nz-drawer>
</div>

<!-- shreya -->
<div *ngIf="drawerVisibleCustomers">
  <nz-drawer [nzBodyStyle]="{
      height: 'calc(100% - 55px)',
      overflow: 'auto',
      'padding-bottom': '53px'
    }" [nzClosable]="true" [nzMask]="true" [nzMaskClosable]="true" [nzWidth]="widths"
    [nzVisible]="drawerVisibleCustomers" [nzTitle]="drawerTitleCustomers" (nzOnClose)="drawerCloseCustomers()"
    (nzKeyboard)="(true)">
    <ng-container *nzDrawerContent>
      <app-customer-overview-list [drawerClose]="closeCallbackCustomers" [drawerVisible]="drawerVisibleCustomers"
        [data]="drawerDataCustomers" [custid]="custid">
      </app-customer-overview-list>
    </ng-container>
  </nz-drawer>
</div>
<div *ngIf="ordercreateVisible">
  <nz-drawer [nzBodyStyle]="{
      height: 'calc(100% - 55px)',
      overflow: 'auto',
      padding: '10px'
    }" [nzClosable]="true" [nzMask]="true" [nzMaskClosable]="false" [nzWidth]="'100%'" [nzVisible]="ordercreateVisible"
    [nzTitle]="'Create Order'" (nzOnClose)="drawerCloseorder()" (nzKeyboard)="(true)">
    <ng-container *nzDrawerContent>
      <app-ordercreatedrawer [drawerCloseorder]="closeCallbackorder" [data]="vieworderdata.orderData[0]" [type]="type"
        [tableData]="vieworderdata['detailsData']" [addresses]="addresses" [terriotrystarttime1]="terriotrystarttime1"
        [terriotryendtime1]="terriotryendtime1" [expectedDate]="expectedDate" [time]="time"
        [TERRITORY_IDS]="TERRITORY_IDS" [decreptedroleId]="decreptedroleId" [isTerritoryExpress]="isTerritoryExpress"
        [expandedKeys]="expandedKeys" [selectedKeys]="selectedKeys" [nodes]="nodes"
        [servicescatalogue]="servicescatalogue" [serviceSubCatName]="serviceSubCatName"
        [serviceCatName]="serviceCatName" [storeserviceaddress]="storeserviceaddress"
        [storeBillingaddress]="storeBillingaddress" [showExpress]="showExpress"
        [specialInstruction]="specialInstruction" [MIN_T_END_TIME]="MIN_T_END_TIME2"
        [MAX_T_START_TIME]="MAX_T_START_TIME2" [currentDate]="currentDate5">
      </app-ordercreatedrawer>
    </ng-container>
  </nz-drawer>
</div>